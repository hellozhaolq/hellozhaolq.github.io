<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.zhaolq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"androidstudio","dark":"androidstudio"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":true,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="推荐链接：  分类:字符编码 - 维基百科   分类:字符集 - 维基百科   字符编码 - 维基百科   字符集和字符编码 - 菜鸟   字符编码笔记：ASCII，Unicode 和 UTF-8 - 阮一峰">
<meta property="og:type" content="article">
<meta property="og:title" content="字符编码">
<meta property="og:url" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/index.html">
<meta property="og:site_name" content="洋蔥">
<meta property="og:description" content="推荐链接：  分类:字符编码 - 维基百科   分类:字符集 - 维基百科   字符编码 - 维基百科   字符集和字符编码 - 菜鸟   字符编码笔记：ASCII，Unicode 和 UTF-8 - 阮一峰">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619115350495.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619112811548.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619113822061.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619200315961.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619200055693.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619200402309.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619201350055.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620130247186.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620130309071.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620130743667.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620130946982.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620131029816.png">
<meta property="article:published_time" content="2021-01-01T01:39:35.000Z">
<meta property="article:modified_time" content="2021-01-01T01:39:35.000Z">
<meta property="article:author" content="zhaolq">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619115350495.png">


<link rel="canonical" href="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/","path":"article/2021/01/字符编码/","title":"字符编码"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>字符编码 | 洋蔥</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>



  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">洋蔥</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">耳不闻人是非，目不视人之短，口不言人之过。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8E%86%E5%8F%B2-Unicode%E8%AF%9E%E7%94%9F"><span class="nav-number">1.</span> <span class="nav-text">历史 (Unicode诞生)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ASCII"><span class="nav-number">2.</span> <span class="nav-text">ASCII</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ANSI"><span class="nav-number">3.</span> <span class="nav-text">ANSI</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B9%B1%E7%A0%81"><span class="nav-number">3.1.</span> <span class="nav-text">乱码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Windows%E6%9F%A5%E7%9C%8BANSI"><span class="nav-number">3.2.</span> <span class="nav-text">Windows查看ANSI</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux%E6%9F%A5%E7%9C%8BANSI"><span class="nav-number">3.3.</span> <span class="nav-text">Linux查看ANSI</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E9%9B%86-%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81"><span class="nav-number">4.</span> <span class="nav-text">字符集+字符编码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GB2312"><span class="nav-number">4.1.</span> <span class="nav-text">GB2312</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GBK"><span class="nav-number">4.2.</span> <span class="nav-text">GBK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UNICODE"><span class="nav-number">4.3.</span> <span class="nav-text">UNICODE</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%AF%E5%8F%98%E9%95%BF%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81"><span class="nav-number">5.</span> <span class="nav-text">可变长字符编码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#UTF-8-%E7%BC%96%E7%A0%81"><span class="nav-number">5.1.</span> <span class="nav-text">UTF-8 编码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UTF-16-%E7%BC%96%E7%A0%81"><span class="nav-number">5.2.</span> <span class="nav-text">UTF-16 编码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UTF-32-%E7%BC%96%E7%A0%81"><span class="nav-number">5.3.</span> <span class="nav-text">UTF-32 编码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UTF-8%E3%80%81UTF-16%E3%80%81UTF-32-%E4%B9%8B%E9%97%B4%E5%A6%82%E4%BD%95%E8%BD%AC%E6%8D%A2"><span class="nav-number">5.4.</span> <span class="nav-text">UTF-8、UTF-16、UTF-32 之间如何转换</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UTF-%E5%AD%97%E8%8A%82%E9%A1%BA%E5%BA%8F"><span class="nav-number">6.</span> <span class="nav-text">UTF 字节顺序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#BOM-%E5%AD%97%E8%8A%82%E9%A1%BA%E5%BA%8F%E6%A0%87%E8%AE%B0"><span class="nav-number">7.</span> <span class="nav-text">BOM (字节顺序标记)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">8.</span> <span class="nav-text">常见的字符编码的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis-%E4%B8%AD%E6%96%87key%E7%9A%84%E6%98%BE%E7%A4%BA"><span class="nav-number">8.1.</span> <span class="nav-text">Redis 中文key的显示</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-%E4%B8%AD%E7%9A%84-utf8-%E5%92%8C-utf8mb4"><span class="nav-number">8.2.</span> <span class="nav-text">MySQL 中的 utf8 和 utf8mb4</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhaolq"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">zhaolq</p>
  <div class="site-description" itemprop="description">有用、有趣、有情义！</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">555</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hellozhaolq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hellozhaolq" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hello.zhaolq@qq.com" title="E-Mail → mailto:hello.zhaolq@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaolq.com/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zhaolq">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洋蔥">
      <meta itemprop="description" content="有用、有趣、有情义！">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="字符编码 | 洋蔥">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          字符编码
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-01 09:39:35" itemprop="dateCreated datePublished" datetime="2021-01-01T09:39:35+08:00">2021-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><strong>推荐链接：</strong></p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Category:%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81">分类:字符编码 - 维基百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Category:%E5%AD%97%E7%AC%A6%E9%9B%86">分类:字符集 - 维基百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81">字符编码 - 维基百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/charset-encoding.html">字符集和字符编码 - 菜鸟</a> </p>
<p> <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html">字符编码笔记：ASCII，Unicode 和 UTF-8 - 阮一峰</a> </p>
<span id="more"></span>

<h1 id="历史-Unicode诞生"><a href="#历史-Unicode诞生" class="headerlink" title="历史 (Unicode诞生)"></a>历史 (Unicode诞生)</h1><p>计算机起源于美国，上个世纪，他们对英语字符与二进制位之间的关系做了统一规定，并制定了一套字符编码规则，这套编码规则被称为 ASCII 编码。</p>
<p><strong>ASCII 编码</strong>一共定义了128个字符的编码规则，用七位二进制表示 ( 0x00 - 0x7F )，这些字符组成的集合就叫做 <strong>ASCII 字符集</strong>。</p>
<p>随着计算机的普及，在不同的地区和国家又出现了很多字符编码，比如: 大陆的 GB2312、港台的 BIG5，日本的 Shift JIS等等。</p>
<p>由于字符编码不同，计算机在不同国家之间的交流变得很困难，经常会出现乱码的问题，比如：对于同一个二进制数据，不同的编码会解析出不同的字符。</p>
<p>当互联网迅猛发展，地域限制打破之后，人们迫切的希望有一种统一的规则，对所有国家和地区的字符进行编码，于是 Unicode 就出现了。 </p>
<h1 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h1><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/ASCII">ASCII - 维基百科</a> </p>
<p>ASCII 码是<strong>大多数常用编码的基础</strong>（也许存在不以 ASCII 为基础的编码方式吧），它是一个7位的编码标准，包括26个小写字母、26个大写字母、10个数字、32个符号、33个控制代码和一个空格，<strong>共128个代码</strong>。</p>
<p>ASCII 码的扩充：<strong>ANSI</strong>、<strong>UNICODE</strong>、<strong>GB2312</strong> 等字符集。</p>
<h1 id="ANSI"><a href="#ANSI" class="headerlink" title="ANSI"></a>ANSI</h1><p> <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/ANSI/10401940">ANSI - 百度百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/malecrab/p/5300486.html">ANSI是什么编码？</a> </p>
<p>ANSI 是一种<strong>字符代码</strong>，并不是字符编码，<strong>在不同区域设置的系统中，ANSI表示不同的编码。</strong> </p>
<p>在简体中文Windows操作系统中，ANSI 编码代表 GB2312编码；在繁体中文Windows操作系统中，ANSI编码代表Big5；在日文Windows操作系统中，ANSI 编码代表 JIS 编码。</p>
<h2 id="乱码"><a href="#乱码" class="headerlink" title="乱码"></a>乱码</h2><p>在中文系统中创建一个文本文件，使用默认的 ANSI 编码，输入一段中文</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619115350495.png" alt="image-20210619115350495"></p>
<p>在英文系统中（或修改区域设置）打开这个文本文件，这时就会乱码，因为操作系统区域设置不同，编码方式不同。</p>
<h2 id="Windows查看ANSI"><a href="#Windows查看ANSI" class="headerlink" title="Windows查看ANSI"></a>Windows查看ANSI</h2><p> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Code_page">Code page - 维基百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BB%A3%E7%A0%81%E9%A1%B5">代码页 - 维基百科</a> </p>
<p>微软用一个叫 <code>Code page</code> 表示系统默认编码。</p>
<p>对于Windows操作系统中的命令行窗口（Command Prompt），chcp命令在没有参数时，显示当前代码页；chcp命令带一个整数参数，则改变命令行窗口的当前代码页为参数所指定。</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619112811548.png" alt="image-20210619112811548"></p>
<p>Windows 下 <code>Code page</code> 由系统的 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8C%BA%E5%9F%9F%E8%AE%BE%E7%BD%AE">区域设置（locale） - 维基百科</a> 决定，win10修改区域设置：</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619113822061.png" alt="image-20210619113822061"></p>
<h2 id="Linux查看ANSI"><a href="#Linux查看ANSI" class="headerlink" title="Linux查看ANSI"></a>Linux查看ANSI</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">locale <span class="comment"># 查看locale</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> LC_ALL=zh_CN.GBK <span class="comment"># 更改locale</span></span></span><br></pre></td></tr></table></figure>

<h1 id="字符集-字符编码"><a href="#字符集-字符编码" class="headerlink" title="字符集+字符编码"></a>字符集+字符编码</h1><p>字符集是很多个字符的集合。比如：GB2312、GBK 是 字符集 又是 字符编码，UNICODE 只是字符集。</p>
<p>字符编码是字符集的一种实现方式，把字符集中的字符映射为特定的字节或字节序列，它是一种规则。比如：UTF-8、UTF-16、UTF-32 等 <strong>可变长字符编码</strong> 规则。</p>
<h2 id="GB2312"><a href="#GB2312" class="headerlink" title="GB2312"></a>GB2312</h2><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/GB_2312">GB2312 - 维基百科</a> </p>
<p>字符集 + 字符编码（自成体系）。</p>
<h2 id="GBK"><a href="#GBK" class="headerlink" title="GBK"></a>GBK</h2><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%B1%89%E5%AD%97%E5%86%85%E7%A0%81%E6%89%A9%E5%B1%95%E8%A7%84%E8%8C%83">GBK - 维基百科</a> </p>
<p>字符集 + 字符编码（自成体系），是对 <strong>GB2312</strong> 的扩展。</p>
<h2 id="UNICODE"><a href="#UNICODE" class="headerlink" title="UNICODE"></a>UNICODE</h2><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Unicode">Unicode - 维基百科</a> </p>
<p><font color="red"><strong>是字符集，不是编码方，但它确实定义了“编码方案框架”。</strong></font> </p>
<p>官方中文名称为<strong>统一码</strong>，又译作<strong>万国码</strong>、统一字符码、统一字符编码，是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%9B%BB%E8%85%A6%E7%A7%91%E5%AD%B8">计算机科学</a>领域的业界标准。它将世界各种语言的每个字符定义一个唯一的编码，以满足跨语言、跨平台的文本信息转换。</p>
<p>Unicode 字符集的码点范围是 <font color="red">0x0000 - 0x10FFFF</font>，共可容纳超过一百万个字符。<strong>每个字符在 Unicode 中都有一个唯一的编码值</strong>，这个编码值就是一个二进制数，被称为 <font color="red">码点</font>（Code Point）。例如，汉字 <font color="red">“中”</font> 的码点是 <font color="red">0x4E2D</font>，大写字母 <font color="red">A</font> 的码点是 <font color="red">0x41</font>。</p>
<p>码点可以在 Unicode 标准中查询，每个字符都有唯一的码点进行标识。一般来说，每个码点对应一个字符，每个字符也对应一个码点。但在某些情况下，比如 <a target="_blank" rel="noopener" href="https://unicode.org/emoji/charts/full-emoji-list.html">Emoji 字符</a>、组合字符、变体字符或控制符，一个“字符”可能由多个码点组成，或者有些码点不对应可见字符。</p>
<h1 id="可变长字符编码"><a href="#可变长字符编码" class="headerlink" title="可变长字符编码"></a>可变长字符编码</h1><p>Unicode 的码点范围是从 <code>0x0000</code> 到 <code>0x10FFFF</code>，最多只需要 <strong>21 位二进制</strong>就能表示所有字符。理论上，3 个字节（24 位）就足够容纳这些码点。</p>
<p>但如果所有字符都统一用 3 个字节存储，会浪费大量空间，尤其是对于码点较小的字符，比如 ASCII，只需 1 个字节即可表示。</p>
<p>这就带来一个问题：<strong>如果字符长度不固定，计算机如何知道每次读取几个字节？</strong></p>
<p>为了解决这个问题，Unicode 设计了多种<strong>可变长度编码方案</strong>，根据字符的码点范围动态分配字节数，以兼顾空间效率和表示能力。常见的编码方式有：</p>
<ul>
<li><strong>UTF-8</strong>：用 1 到 4 个字节表示字符，小码点用少字节，高码点用多字节，兼容 ASCII，且易于解码。</li>
<li><strong>UTF-16</strong>：用 2 或 4 个字节表示字符。</li>
<li><strong>UTF-32</strong>：每个字符固定使用 4 个字节，简单但占空间。</li>
</ul>
<p>通过这种方式，既节省了空间，又能确保字符编码和解码的正确性。</p>
<table>
<thead>
<tr>
<th>Unicode 码点范围</th>
<th>UTF-8 字节数</th>
<th>UTF-16 字节数</th>
<th>UTF-32 字节数</th>
</tr>
</thead>
<tbody><tr>
<td>U+0000 ~ U+007F</td>
<td>1 字节</td>
<td>2 字节</td>
<td>4 字节</td>
</tr>
<tr>
<td>U+0080 ~ U+07FF</td>
<td>2 字节</td>
<td>2 字节</td>
<td>4 字节</td>
</tr>
<tr>
<td>U+0800 ~ U+FFFF</td>
<td>3 字节</td>
<td>2 字节</td>
<td>4 字节</td>
</tr>
<tr>
<td>U+10000 ~ U+10FFFF</td>
<td>4 字节</td>
<td>4 字节（代理对）</td>
<td>4 字节</td>
</tr>
</tbody></table>
<h2 id="UTF-8-编码"><a href="#UTF-8-编码" class="headerlink" title="UTF-8 编码"></a>UTF-8 编码</h2><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/UTF-8">UTF-8 - 维基百科</a> </p>
<p>UTF-8: 是一种<font color="red"><strong>变长字符编码</strong></font>，被定义为将码点编码为 1 至 4 个字节，具体取决于码点数值中有效二进制位的数量。</p>
<p>UTF-8 的编码规则:</p>
<ol start="0">
<li><p>对于单字节的符号，字节的第一位设为 <font color="red">0，后面 7 位为这个符号的 Unicode 码。因此对于英语字母，UTF-8 编码和 ASCII 码是相同的，所以 UTF-8 能兼容 ASCII 编码，这也是互联网普遍采用 UTF-8 的原因之一。</font></p>
</li>
<li><p>对于 <font color="red">n</font> 字节的符号（ <font color="red">n &gt; 1</font>），第一个字节的前 <font color="red">n</font> 位都设为 <font color="red">1</font>，第 <font color="red">n + 1</font> 位设为 <font color="red">0</font>，后面字节的前两位一律设为 <font color="red">10</font> 。剩下的没有提及的二进制位，全部为这个符号的 Unicode 码。</p>
</li>
</ol>
<p>下表是Unicode编码对应UTF-8需要的字节数量以及编码格式：</p>
<table>
<thead>
<tr>
<th align="left">Unicode编码范围(16进制)</th>
<th align="left">UTF-8编码方式(二进制)</th>
</tr>
</thead>
<tbody><tr>
<td align="left">000000 - 00007F</td>
<td align="left"><font color="red">0</font>xxxxxxx <font color="red">ASCII码</font></td>
</tr>
<tr>
<td align="left">000080 - 0007FF</td>
<td align="left"><font color="red">110</font>xxxxx <font color="red">10</font>xxxxxx</td>
</tr>
<tr>
<td align="left">000800 - 00FFFF</td>
<td align="left"><font color="red">1110</font>xxxx <font color="red">10</font>xxxxxx <font color="red">10</font>xxxxxx</td>
</tr>
<tr>
<td align="left">01 0000 - 10 FFFF</td>
<td align="left"><font color="red">11110</font>xxx <font color="red">10</font>xxxxxx <font color="red">10</font>xxxxxx <font color="red">10</font>xxxxxx</td>
</tr>
</tbody></table>
<p>表格中第一列是Unicode编码的范围，第二列是对应UTF-8编码方式，其中红色的二进制 <font color="red">“1”</font> 和 <font color="red">“0”</font> 是固定的前缀，字母 <font color="red">x</font> 表示可用编码的二进制位。</p>
<p>根据上面表格，要解析 UTF-8 编码就很简单了，如果一个字节第一位是 <font color="red">0</font> ，则这个字节就是一个单独的字符，如果第一位是 <font color="red">1</font> ，则连续有多少个 <font color="red">1</font> ，就表示当前字符占用多少个字节。</p>
<p>下面以 <font color="red">“中”</font> 字 为例来说明 UTF-8 的编码，具体的步骤如下图， 为了便于说明，图中左边加了 <code>1，2，3，4</code> 的步骤编号。</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619200315961.png" alt="image-20210619200315961"></p>
<p>首先查询 <font color="red">“中”</font> 字的 Unicode 码 <font color="red">0x4E2D</font>，转成二进制，总共有 16 个二进制位， 具体如上图 步骤1 所示。</p>
<p>通过前面的 Unicode 编码和 UTF-8 编码的表格知道，Unicode 码 <font color="red">0x4E2D</font> 对应 <font color="red">000800 - 00FFFF</font> 的范围，所以，<font color="red">“中”</font> 字的 UTF-8 编码 需要 <font color="red">3</font> 个字节，即格式是 <font color="red">1110</font>xxxx <font color="red">10</font>xxxxxx <font color="red">10</font>xxxxxx 。</p>
<p>然后从 <font color="red">“中”</font> 字的最后一个二进制位开始，按照从后向前的顺序依次填入格式中的 <font color="red">x</font> 字符，多出的二进制补为 <font color="red">0</font>， 具体如上图 步骤2、步骤3 所示。</p>
<p>于是，就得到了 <font color="red">“中”</font> 的 UTF-8 编码是 <font color="red">1110</font><font color="blue">0100</font> <font color="red">10</font><font color="blue">111000</font> <font color="red">10</font><font color="blue">101101</font>，转换成十六进制就是 <font color="red">0xE4B8AD</font>， 具体如上图 步骤4 所示。</p>
<h2 id="UTF-16-编码"><a href="#UTF-16-编码" class="headerlink" title="UTF-16 编码"></a>UTF-16 编码</h2><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/UTF-16">UTF-16 - 维基百科</a> </p>
<p>UTF-16 也是一种<font color="red"><strong>变长字符编码</strong></font>，这种编码方式比较特殊，它将字符编码成 2 字节 或者 4 字节。</p>
<p>具体的编码规则如下:</p>
<ol start="0">
<li><p>对于 Unicode 码小于 <font color="red">0x10000</font> 的字符， 使用 <font color="red">2</font> 个字节存储，并且是直接存储 Unicode 码，不用进行编码转换。</p>
</li>
<li><p>对于 Unicode 码在 <font color="red">0x10000</font> 和 <font color="red">0x10FFFF</font> 之间的字符，使用 <font color="red">4</font> 个字节存储，这 <font color="red">4</font> 个字节分成前后两部分，每个部分各两个字节，其中，前面两个字节的前 <font color="red">6</font> 位二进制固定为 <font color="red">110110</font>，后面两个字节的前 6 位二进制固定为 <font color="red">110111</font>，前后部分各剩余 10 位二进制表示符号的 Unicode 码减去 <font color="red">0x10000</font> 的结果。</p>
</li>
<li><p>大于 <font color="red">0x10FFFF</font> 的 Unicode 码无法用 UTF-16 编码。</p>
</li>
</ol>
<p>下表是Unicode编码对应UTF-16编码格式：</p>
<table>
<thead>
<tr>
<th align="left">Unicode编码范围(16进制)</th>
<th align="left">具体Unicode码(二进制)</th>
<th align="left">UTF-16编码方式(二进制)</th>
<th align="left">字节</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0000 0000 - 0000 FFFF</td>
<td align="left">xxxxxxxx xxxxxxxx</td>
<td align="left">xxxxxxxx xxxxxxxx</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">0001 0000 - 0010 FFFF</td>
<td align="left">yy yyyyyyyy xx xxxxxxxx</td>
<td align="left"><font color="red">110110</font>yy yyyyyyyy <font color="red">110111</font>xx xxxxxxxx</td>
<td align="left">4</td>
</tr>
</tbody></table>
<p>表格中第一列是Unicode编码的范围，第二列是具体Unicode码的二进制 ( 第二行的第二列表示的是 Unicode 码减去 <font color="red">0x10000</font> 后的二进制 ) ，第三列是对应UTF-16编码方式，其中红色的二进制 <font color="red">“1”</font> 和 <font color="red">“0”</font> 是固定的前缀，字母 <font color="red">x</font> 和 <font color="red">y</font> 表示可用编码的二进制位， 第四列表示 编码占用的字节数。</p>
<p>前面提到过，<font color="red">“中”</font> 字的 Unicode 码是 <font color="red">4E2D</font>，它小于 <font color="red">0x10000</font>，根据表格可知，它的 UTF-16 编码占两个字节，并且和 Unicode 码相同，所以 <font color="red">“中”</font> 字的 UTF-16 编码为 <font color="red">4E2D</font>。</p>
<p>我从 Unicode字符表网站 找了一个老的南阿拉伯字母，它的 Unicode 码是: <font color="red">0x10A6F</font> ，可以访问 <a target="_blank" rel="noopener" href="https://unicode-table.com/cn/10A6F/">https://unicode-table.com/cn/10A6F/</a> 查看字符的说明，Unicode 码对应的字符如下图所示：</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619200055693.png" alt="image-20210619200055693"></p>
<p>下面以这个 老南阿拉伯字母 的 Unicode 码 <font color="red">0x10A6F</font> 为例来说明 UTF-16 <font color="red">4</font> 字节的编码，具体步骤如下，为了便于说明，图中左边加了 <code>1，2，3，4 、5</code>的步骤编号：</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619200402309.png" alt="image-20210619200402309"></p>
<p>首先把 Unicode 码 <font color="red">0x10A6F</font> 转成二进制，对应上图的 步骤 1。</p>
<p>然后把 Unicode 码 <font color="red">0x10A6F</font> 减去 <font color="red">0x10000</font>，结果为 <font color="red">0xA6F</font> 并把这个值转成二进制 <font color="blue">00</font> <font color="blue">00000010</font> <font color="orange">10</font> <font color="orange">01101111</font>，对应上图的 步骤 2。</p>
<p>然后 从二进制 <font color="blue">00</font> <font color="blue">00000010</font> <font color="orange">10</font> <font color="orange">01101111</font> 的最后一个二进制为开始，按照从后向前的顺序依次填入格式中的 <font color="red">x</font> 和 <font color="red">y</font> 字符，多出的二进制补为 <font color="red">0</font>， 对应上图的 步骤 3、 步骤 4。</p>
<p>于是，就计算出了 Unicode 码 <font color="red">0x10A6F</font> 的 UTF-16 编码是 <font color="red">110110</font><font color="blue">00</font> <font color="blue">00000010</font> <font color="red">110111</font><font color="blue">10</font> <font color="blue">01101111</font> ，转换成十六进制就是 <font color="red">0xD802DE6F</font>， 对应上图的 步骤 5。</p>
<h2 id="UTF-32-编码"><a href="#UTF-32-编码" class="headerlink" title="UTF-32 编码"></a>UTF-32 编码</h2><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/UTF-32">UTF-32 - 维基百科</a> </p>
<p>UTF-32 是<font color="red"><strong>固定长度的编码</strong></font>，始终占用 4 个字节，足以容纳所有的 Unicode 字符，所以直接存储 Unicode 码即可，不需要任何编码转换。虽然浪费了空间，但提高了效率。</p>
<h2 id="UTF-8、UTF-16、UTF-32-之间如何转换"><a href="#UTF-8、UTF-16、UTF-32-之间如何转换" class="headerlink" title="UTF-8、UTF-16、UTF-32 之间如何转换"></a>UTF-8、UTF-16、UTF-32 之间如何转换</h2><p>前面介绍过，UTF-8、UTF-16、UTF-32 是 Unicode 码表示成不同的二进制格式的编码规则，同样，通过这三种编码的二进制表示，也能获得对应的 Unicode 码，有了字符的 Unicode 码，按照上面介绍的 UTF-8、UTF-16、UTF-32 的编码方法，就能转换成任一种编码了。</p>
<h1 id="UTF-字节顺序"><a href="#UTF-字节顺序" class="headerlink" title="UTF 字节顺序"></a>UTF 字节顺序</h1><p>最小编码单元是多字节才会有字节序的问题存在，UTF-8 最小编码单元是一字节，所以它是没有字节序的问题，UTF-16 最小编码单元是 2 个字节，在解析一个 UTF-16 字符之前，需要知道每个编码单元的字节序。</p>
<p>比如：前面提到过，<font color="red">“中”</font> 字的 Unicode 码是 <font color="red">4E2D</font>，<font color="red">“ⵎ”</font> 字符的 Unicode 码是 <font color="red">2D4E</font>， 当我们收到一个 UTF-16 字节流 <font color="red">4E2D</font> 时，计算机如何识别它表示的是字符 <font color="red">“中”</font> 还是 字符 <font color="red">“ⵎ”</font> 呢 ?</p>
<p>所以，对于多字节的编码单元，需要有一个标记显式的告诉计算机，按照什么样的顺序解析字符，也就是字节序，字节序分为 大端字节序 和 小端字节序。</p>
<p>小端字节序简写为 LE( Little-Endian )，表示 低位字节在前，高位字节在后，高位字节保存在内存的高地址端，而低位字节保存在内存的低地址端。</p>
<p>大端字节序简写为 BE( Big-Endian )，表示 高位字节在前，低位字节在后，高位字节保存在内存的低地址端，低位字节保存在在内存的高地址端。</p>
<p>下面以 <font color="red">0x4E2D</font> 为例来说明大端和小端，具体参见下图：</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210619201350055.png" alt="image-20210619201350055"></p>
<p>数据是从高位字节到低位字节显示的，这也更符合人们阅读数据的习惯，而内存地址是从低地址向高地址增加。</p>
<p>所以，字符 <font color="red">0x4E2D</font> 数据的高位字节是 <font color="red">4E</font>，低位字节是 <font color="red">2D</font>。</p>
<p>按照大端字节序的高位字节保存内存低地址端的规则，<font color="red">4E</font> 保存到低内存地址 <font color="orange">0x10001</font> 上，<font color="red">2D</font> 则保存到高内存地址 <font color="orange">0x10002</font> 上。</p>
<p>对于小端字节序，则正好相反，数据的高位字节保存到内存的高地址端，低位字节保存到内存低地址端的，所以 <font color="red">4E</font> 保存到高内存地址 <font color="orange">0x10002</font> 上，<font color="red">2D</font> 则保存到低内存地址 <font color="orange">0x10001</font> 上。</p>
<h1 id="BOM-字节顺序标记"><a href="#BOM-字节顺序标记" class="headerlink" title="BOM (字节顺序标记)"></a>BOM (字节顺序标记)</h1><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BD%8D%E5%85%83%E7%B5%84%E9%A0%86%E5%BA%8F%E8%A8%98%E8%99%9F">字节顺序标记 - 维基百科</a> </p>
<p>BOM 是 byte-order mark 的缩写，是 “字节顺序标记” 的意思，它常被用来当做标识文件是以 UTF-8、UTF-16 或 UTF-32 编码的标记。</p>
<p>在 Unicode 编码中有一个叫做 <font color="red">“零宽度非换行空格”</font> 的字符 ( ZERO WIDTH NO-BREAK SPACE )，用字符 <font color="red">FEFF</font> 来表示。</p>
<p>对于 UTF-16 ，如果接收到以 <font color="red">FE</font><font color="orange">FF</font> 开头的字节流， 就表明是大端字节序，如果接收到 <font color="orange">FF</font><font color="red">FE</font>， 就表明字节流 是小端字节序。</p>
<p>UTF-8 没有字节序问题，上述字符只是用来标识它是 UTF-8 文件，而不是用来说明字节顺序的。<font color="red">“零宽度非换行空格”</font> 字符 的 UTF-8 编码是 <font color="red">EF BB BF</font>，所以如果接收到以 <font color="red">EF BB BF</font> 开头的字节流，就知道这是UTF-8 文件。</p>
<p>下面的表格列出了不同 UTF 格式的固定文件头：</p>
<table>
<thead>
<tr>
<th align="left">UTF编码</th>
<th align="left">固定文件头</th>
</tr>
</thead>
<tbody><tr>
<td align="left">UTF-8</td>
<td align="left">EF BB BF</td>
</tr>
<tr>
<td align="left">UTF-16LE</td>
<td align="left">FF FE</td>
</tr>
<tr>
<td align="left">UTF-16BE</td>
<td align="left">FE FF</td>
</tr>
<tr>
<td align="left">UTF-32LE</td>
<td align="left">FF FE 00 00</td>
</tr>
<tr>
<td align="left">UTF-32BE</td>
<td align="left">00 00 FE FF</td>
</tr>
</tbody></table>
<p>根据上面的 固定文件头，下面列出了 <font color="red">“中”</font> 字在文件中的存储 ( 包含文件头 )：</p>
<table>
<thead>
<tr>
<th align="left">编码</th>
<th align="left">固定文件头</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Unicode 编码</td>
<td align="left">0X004E2D</td>
</tr>
<tr>
<td align="left">UTF-8</td>
<td align="left"><font color="red">EF BB BF</font> 4E 2D</td>
</tr>
<tr>
<td align="left">UTF-16BE</td>
<td align="left"><font color="red">FE FF</font> 4E 2D</td>
</tr>
<tr>
<td align="left">UTF-16LE</td>
<td align="left"><font color="red">FF FE</font> 2D 4E</td>
</tr>
<tr>
<td align="left">UTF-32BE</td>
<td align="left"><font color="red">00 00 FE FF</font> 00 00 4E 2D</td>
</tr>
<tr>
<td align="left">UTF-32LE</td>
<td align="left"><font color="red">FF FE 00 00</font> 2D 4E 00 00</td>
</tr>
</tbody></table>
<h1 id="常见的字符编码的问题"><a href="#常见的字符编码的问题" class="headerlink" title="常见的字符编码的问题"></a>常见的字符编码的问题</h1><h2 id="Redis-中文key的显示"><a href="#Redis-中文key的显示" class="headerlink" title="Redis 中文key的显示"></a>Redis 中文key的显示</h2><p>有时候我们需要向redis中写入含有中文的数据，然后在查看数据，但是会看到一些其他的字符，而不是我们写入的中文</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620130247186.png" alt="image-20210620130247186"></p>
<p>上图中，我们向redis 写入了一个 “中” 字，通过 get 命令查看的时候无法显示我们写入的 “中” 字。</p>
<p>这时候加一个 –raw 参数，重新启动 redis-cli 即可，也即 执行 redis-cli –raw 命令启动redis客户端，具体的如下图所示</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620130309071.png" alt="image-20210620130309071"></p>
<h2 id="MySQL-中的-utf8-和-utf8mb4"><a href="#MySQL-中的-utf8-和-utf8mb4" class="headerlink" title="MySQL 中的 utf8 和 utf8mb4"></a>MySQL 中的 utf8 和 utf8mb4</h2><p>MySQL 中的 “utf8” 实际上不是真正的 UTF-8，它只支持每个字符最多 3 个字节，对于超过 3 个字节的字符就会出错。而真正的 UTF-8 支持 4 个字节。</p>
<p>MySQL 中的 “utf8mb4” 才是真正的 UTF-8。</p>
<p>下面以 test 表为例来说明，表结构如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show create table test\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">       Table: test</span><br><span class="line">Create Table: CREATE TABLE `test` (</span><br><span class="line">  `name` char(32) NOT NULL</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>向 <code>test</code> 表分别插入 <font color="red">“中”</font> 字 和 Unicode 码为 <font color="red">0x10A6F</font> 的字符，这个字符需要从 <a target="_blank" rel="noopener" href="https://unicode-table.com/cn/10A6F/">https://unicode-table.com/cn/10A6F/</a> 直接复制到 MySQL 控制台上，手工输入会无效，具体的执行结果如下图：</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620130743667.png" alt="image-20210620130743667"></p>
<p>从上图可以看出，插入 <font color="red">“中”</font> 字 成功，插入 <font color="red">0x10A6F</font> 字符失败，错误提示无效的字符串，<font color="red">\xF0\X90\XA9\xAF</font> 正是 <font color="red">0x10A6F</font> 字符的 UTF-8 编码，占用 <font color="red">4</font> 个字节，因为 MySQL 的 utf8 编码最多只支持 3 个字节，所以插入会失败。</p>
<p>把 <code>test</code> 表的字符集改成 <code>utf8mb4</code> ，排序规则 改成 <code>utf8bm4_unicode_ci</code>，具体如下图所示：</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620130946982.png" alt="image-20210620130946982"></p>
<p>字符集和排序方式修改之后，再次插入 <font color="red">0x10A6F</font> 字符， 结果是成功的，具体执行结果如下图所示：</p>
<p><img src="/article/2021/01/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/image-20210620131029816.png" alt="image-20210620131029816"></p>
<p>上图中，<code>set names utf8mb4</code> 是为了测试方便，临时修改当前会话的字符集，以便保持和服务器一致，实际解决这个问题需要修改 <code>my.cnf</code> 配置中 服务器和客户端的字符集。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="zhaolq 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="zhaolq 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/article/2020/12/%E4%BD%BF%E7%94%A8OpenSSL%E6%9E%84%E5%BB%BA%E7%A7%81%E6%9C%89CA/" rel="prev" title="使用OpenSSL构建私有CA">
                  <i class="fa fa-angle-left"></i> 使用OpenSSL构建私有CA
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/article/2021/01/%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95/" rel="next" title="限流算法">
                  限流算法 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">zhaolq</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
