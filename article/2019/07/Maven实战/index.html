<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.zhaolq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"androidstudio","dark":"androidstudio"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":true,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="Maven简介何为Maven​	Maven 是 Apache 组织下的一个跨平台的项目管理工具，它包含了： ​		a.一个项目对象模型 (Project Object Model)， ​		b.一组标准集合， ​		c.一个项目生命周期(ProjectLifecycle)， ​		d.一个依赖管理系统(Dependency Management System)， ​		e.用来运行定义在生命周期阶">
<meta property="og:type" content="article">
<meta property="og:title" content="Maven实战">
<meta property="og:url" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/index.html">
<meta property="og:site_name" content="洋蔥">
<meta property="og:description" content="Maven简介何为Maven​	Maven 是 Apache 组织下的一个跨平台的项目管理工具，它包含了： ​		a.一个项目对象模型 (Project Object Model)， ​		b.一组标准集合， ​		c.一个项目生命周期(ProjectLifecycle)， ​		d.一个依赖管理系统(Dependency Management System)， ​		e.用来运行定义在生命周期阶">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566462907328.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566463035122.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566463150612.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566464091426.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566464290627.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/9517529-03fa55b799191921.webp">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566464935944.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466333641.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466382778.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466606365.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466639189.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466653666.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466872041.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466948585.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466956556.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566467157705.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566467164774.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566467171055.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566467179224.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113161012000.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113163709112.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113163823551.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/clip_image001.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/clip_image001.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113164245040.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113165951828.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113171532464.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191122171508378.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191122172423340.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191122173657306.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191122173745609.png">
<meta property="article:published_time" content="2019-07-22T06:23:01.000Z">
<meta property="article:modified_time" content="2019-07-22T06:23:01.000Z">
<meta property="article:author" content="zhaolq">
<meta property="article:tag" content="Maven">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566462907328.png">


<link rel="canonical" href="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/","path":"article/2019/07/Maven实战/","title":"Maven实战"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Maven实战 | 洋蔥</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>



  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">洋蔥</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">贪婪，找不到比这更好的词了，是件好事。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Maven%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">Maven简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%95%E4%B8%BAMaven"><span class="nav-number">1.1.</span> <span class="nav-text">何为Maven</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%95%E4%B8%BA%E6%9E%84%E5%BB%BA"><span class="nav-number">1.1.1.</span> <span class="nav-text">何为构建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven%E6%98%AF%E4%BC%98%E7%A7%80%E7%9A%84%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="nav-number">1.1.2.</span> <span class="nav-text">Maven是优秀的构建工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="nav-number">1.1.3.</span> <span class="nav-text">Maven不仅仅是构建工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81Maven"><span class="nav-number">1.2.</span> <span class="nav-text">为什么需要Maven</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9C%81%E6%97%B6%E7%9C%81%E5%8A%9B"><span class="nav-number">1.2.1.</span> <span class="nav-text">省时省力</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IDE%E4%B8%8D%E6%98%AF%E4%B8%87%E8%83%BD%E7%9A%84"><span class="nav-number">1.2.2.</span> <span class="nav-text">IDE不是万能的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E9%87%8D%E5%A4%8D%E5%8F%91%E6%98%8E%E8%BD%AE%E5%AD%90"><span class="nav-number">1.2.3.</span> <span class="nav-text">不重复发明轮子</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="nav-number">1.3.</span> <span class="nav-text">总结：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Maven%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE"><span class="nav-number">2.</span> <span class="nav-text">Maven的安装和配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9C%A8Windows%E4%B8%8A%E5%AE%89%E8%A3%85Maven"><span class="nav-number">2.1.</span> <span class="nav-text">在Windows上安装Maven</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5JDK%E5%AE%89%E8%A3%85"><span class="nav-number">2.1.1.</span> <span class="nav-text">检查JDK安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BDMaven"><span class="nav-number">2.1.2.</span> <span class="nav-text">下载Maven</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85"><span class="nav-number">2.1.3.</span> <span class="nav-text">本地安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%87%E7%BA%A7Maven"><span class="nav-number">2.1.4.</span> <span class="nav-text">升级Maven</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95%E5%88%86%E6%9E%90"><span class="nav-number">2.2.</span> <span class="nav-text">安装目录分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MAVEN-HOME"><span class="nav-number">2.2.1.</span> <span class="nav-text">MAVEN_HOME</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEHTTP%E4%BB%A3%E7%90%86"><span class="nav-number">2.3.</span> <span class="nav-text">设置HTTP代理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85m2eclipse"><span class="nav-number">2.4.</span> <span class="nav-text">安装m2eclipse</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Maven%E5%AE%89%E8%A3%85%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">2.5.</span> <span class="nav-text">Maven安装最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEMAVEN-OPTS%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">2.5.1.</span> <span class="nav-text">设置MAVEN_OPTS环境变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%94%A8%E6%88%B7%E8%8C%83%E5%9B%B4settings-xml"><span class="nav-number">2.5.2.</span> <span class="nav-text">配置用户范围settings.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8IDE%E5%86%85%E5%B5%8C%E7%9A%84Maven"><span class="nav-number">2.5.3.</span> <span class="nav-text">不要使用IDE内嵌的Maven</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Maven%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8"><span class="nav-number">3.</span> <span class="nav-text">Maven使用入门</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E5%86%99POM"><span class="nav-number">3.1.</span> <span class="nav-text">编写POM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E4%B8%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">3.2.</span> <span class="nav-text">编写主代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81"><span class="nav-number">3.3.</span> <span class="nav-text">编写测试代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E5%92%8C%E8%BF%90%E8%A1%8C"><span class="nav-number">3.4.</span> <span class="nav-text">打包和运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8Archetype%EF%BC%88%E5%8E%9F%E5%9E%8B%EF%BC%89%E7%94%9F%E6%88%90%E9%A1%B9%E7%9B%AE%E9%AA%A8%E6%9E%B6"><span class="nav-number">3.5.</span> <span class="nav-text">使用Archetype（原型）生成项目骨架</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-m2eclipse%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="nav-number">3.6.</span> <span class="nav-text">6.m2eclipse简单使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.6.1.</span> <span class="nav-text">6.1导入项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2%E5%88%9B%E5%BB%BAMaven%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.6.2.</span> <span class="nav-text">6.2创建Maven项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3%E8%BF%90%E8%A1%8CMaven%E5%91%BD%E4%BB%A4"><span class="nav-number">3.6.3.</span> <span class="nav-text">6.3运行Maven命令</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9D%90%E6%A0%87%E5%92%8C%E4%BE%9D%E8%B5%96"><span class="nav-number">4.</span> <span class="nav-text">坐标和依赖</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%95%E4%B8%BAMaven%E5%9D%90%E6%A0%87"><span class="nav-number">4.1.</span> <span class="nav-text">何为Maven坐标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9D%90%E6%A0%87%E8%AF%A6%E8%A7%A3"><span class="nav-number">4.2.</span> <span class="nav-text">坐标详解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">4.3.</span> <span class="nav-text">依赖的配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96%E8%8C%83%E5%9B%B4"><span class="nav-number">4.4.</span> <span class="nav-text">依赖范围</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%A0%E9%80%92%E6%80%A7%E4%BE%9D%E8%B5%96"><span class="nav-number">4.5.</span> <span class="nav-text">传递性依赖</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%95%E4%B8%BA%E4%BC%A0%E9%80%92%E6%80%A7%E4%BE%9D%E8%B5%96"><span class="nav-number">4.5.1.</span> <span class="nav-text">何为传递性依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%A0%E9%80%92%E6%80%A7%E4%BE%9D%E8%B5%96%E5%92%8C%E4%BE%9D%E8%B5%96%E8%8C%83%E5%9B%B4"><span class="nav-number">4.5.2.</span> <span class="nav-text">传递性依赖和依赖范围</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mave%E4%BE%9D%E8%B5%96%E8%B0%83%E8%A7%A3"><span class="nav-number">4.6.</span> <span class="nav-text">Mave依赖调解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%AF%E9%80%89%E4%BE%9D%E8%B5%96"><span class="nav-number">4.7.</span> <span class="nav-text">可选依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%92%E9%99%A4%E4%BE%9D%E8%B5%96"><span class="nav-number">4.8.</span> <span class="nav-text">排除依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%92%E7%B1%BB%E4%BE%9D%E8%B5%96"><span class="nav-number">4.9.</span> <span class="nav-text">归类依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E4%BE%9D%E8%B5%96"><span class="nav-number">4.10.</span> <span class="nav-text">优化依赖</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%B2%E8%A7%A3%E6%9E%90%E4%BE%9D%E8%B5%96"><span class="nav-number">4.10.1.</span> <span class="nav-text">已解析依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96%E6%A0%91"><span class="nav-number">4.10.2.</span> <span class="nav-text">依赖树</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%93%E5%BA%93"><span class="nav-number">5.</span> <span class="nav-text">仓库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%95%E4%B8%BAMaven%E4%BB%93%E5%BA%93"><span class="nav-number">5.1.</span> <span class="nav-text">何为Maven仓库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%93%E5%BA%93%E7%9A%84%E5%B8%83%E5%B1%80"><span class="nav-number">5.2.</span> <span class="nav-text">仓库的布局</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%93%E5%BA%93%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">5.3.</span> <span class="nav-text">仓库的分类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E5%A4%AE%E4%BB%93%E5%BA%93"><span class="nav-number">5.3.1.</span> <span class="nav-text">中央仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A7%81%E6%9C%8D"><span class="nav-number">5.3.2.</span> <span class="nav-text">私服</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%82%B9"><span class="nav-number">5.3.2.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A7%81%E6%9C%8D%E8%BD%AF%E4%BB%B6"><span class="nav-number">5.3.2.2.</span> <span class="nav-text">私服软件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">5.4.</span> <span class="nav-text">远程仓库的配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%9A%84%E8%AE%A4%E8%AF%81"><span class="nav-number">5.4.1.</span> <span class="nav-text">远程仓库的认证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2%E6%9E%84%E4%BB%B6%E8%87%B3%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93"><span class="nav-number">5.4.2.</span> <span class="nav-text">部署构件至远程仓库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BF%AB%E7%85%A7%E7%89%88%E6%9C%AC"><span class="nav-number">5.5.</span> <span class="nav-text">快照版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8E%E4%BB%93%E5%BA%93%E8%A7%A3%E6%9E%90%E4%BE%9D%E8%B5%96%E7%9A%84%E6%9C%BA%E5%88%B6"><span class="nav-number">5.6.</span> <span class="nav-text">从仓库解析依赖的机制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%9C%E5%83%8F"><span class="nav-number">5.7.</span> <span class="nav-text">镜像</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%93%E5%BA%93%E6%90%9C%E7%B4%A2%E6%9C%8D%E5%8A%A1"><span class="nav-number">5.8.</span> <span class="nav-text">仓库搜索服务</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E6%8F%92%E4%BB%B6"><span class="nav-number">6.</span> <span class="nav-text">生命周期和插件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%95%E4%B8%BA%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">6.1.</span> <span class="nav-text">何为生命周期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3"><span class="nav-number">6.2.</span> <span class="nav-text">生命周期详解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E5%A5%97%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">6.2.1.</span> <span class="nav-text">三套生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#clean-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">6.2.2.</span> <span class="nav-text">clean 生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#default-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">6.2.3.</span> <span class="nav-text">default 生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#site-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">6.2.4.</span> <span class="nav-text">site 生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8E%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">6.2.5.</span> <span class="nav-text">命令行与生命周期</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%92%E4%BB%B6%E7%9B%AE%E6%A0%87"><span class="nav-number">6.3.</span> <span class="nav-text">插件目标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%92%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="nav-number">6.4.</span> <span class="nav-text">插件绑定</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E7%BB%91%E5%AE%9A"><span class="nav-number">6.4.1.</span> <span class="nav-text">内置绑定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%91%E5%AE%9A%EF%BC%88%E5%88%9B%E5%BB%BA%E6%BA%90%E7%A0%81jar%EF%BC%89"><span class="nav-number">6.4.2.</span> <span class="nav-text">自定义绑定（创建源码jar）</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhaolq"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">zhaolq</p>
  <div class="site-description" itemprop="description">有用、有趣、有情义！</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">554</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hellozhaolq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hellozhaolq" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hello.zhaolq@qq.com" title="E-Mail → mailto:hello.zhaolq@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaolq.com/article/2019/07/Maven%E5%AE%9E%E6%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zhaolq">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洋蔥">
      <meta itemprop="description" content="有用、有趣、有情义！">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Maven实战 | 洋蔥">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Maven实战
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-22 14:23:01" itemprop="dateCreated datePublished" datetime="2019-07-22T14:23:01+08:00">2019-07-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Build-Automation/" itemprop="url" rel="index"><span itemprop="name">Build Automation</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="Maven简介"><a href="#Maven简介" class="headerlink" title="Maven简介"></a>Maven简介</h1><h2 id="何为Maven"><a href="#何为Maven" class="headerlink" title="何为Maven"></a>何为Maven</h2><p>​	Maven 是 Apache 组织下的一个跨平台的项目管理工具，它包含了：</p>
<p>​		a.一个项目对象模型 (Project Object Model)，</p>
<p>​		b.一组标准集合，</p>
<p>​		c.一个项目生命周期(ProjectLifecycle)，</p>
<p>​		d.一个依赖管理系统(Dependency Management System)，</p>
<p>​		e.用来运行定义在生命周期阶段(phase)中插件(plugin)目标(goal)的逻辑。</p>
<p>​	Maven主要服务于基于Java平台的<strong>项目构建</strong>、<strong>依赖管理</strong>和<strong>项目信息管理</strong>。无论是小型的开源类库项目，还是大型的企业级应用；无论是传统的瀑布式开发，还是流行的敏捷模式，Maven都能大显身手。</p>
<span id="more"></span>

<h3 id="何为构建"><a href="#何为构建" class="headerlink" title="何为构建"></a>何为构建</h3><p>​	构建是每一位程序员每天都在做的事情。</p>
<p>​	编译、单元测试、生成文档、打包和部署等繁琐的步骤，就是构建。</p>
<h3 id="Maven是优秀的构建工具"><a href="#Maven是优秀的构建工具" class="headerlink" title="Maven是优秀的构建工具"></a>Maven是优秀的构建工具</h3><p>​	Maven能帮我们自动化构建过程，从清理、编译、测试到生成报告，再到打包和部署。</p>
<p>​	Maven是跨平台的，这意味着无论是在Windows上，还是Linux或者Mac上，都可以使用同样的命令。</p>
<p>​	Maven抽象了一个<strong>完整的构建生命周期模型</strong>。</p>
<p>​	Maven帮助我们<strong>标准化构建过程</strong>。在Maven之前，十个项目可能有十种构建方式；有了Maven之后，所有项目的构建命令都是简单一致的，降低了学习成本，促进项目团队的标准化。</p>
<h3 id="Maven不仅仅是构建工具"><a href="#Maven不仅仅是构建工具" class="headerlink" title="Maven不仅仅是构建工具"></a>Maven不仅仅是构建工具</h3><p>一个依赖管理工具和项目信息管理工具：</p>
<p>​	1.Maven通过一组坐标准确定位每一个Java类库（又叫构件artifact），有序管理并解决依赖问题。</p>
<p>​	2.Maven帮助我们管理原本分散在项目中各个角落的项目信息，包括项目描述、开发者列表、版本控制系统地址、许可证、缺陷管理系统地址等；通过Maven自动生成的站点，以及一些已有的插件，还能获得项目文档、测试报告、静态分析报告、源码版本日志报告等项目信息。</p>
<p>Maven提供了一个免费的中央仓库，中央仓库地址： <a target="_blank" rel="noopener" href="http://repo1.maven.org/maven2">http://repo1.maven.org/maven2</a> 。</p>
<p>Maven对于项目目录结构、测试用例命名方式等内容都有既定的规定，可以说约定优于配置，</p>
<h2 id="为什么需要Maven"><a href="#为什么需要Maven" class="headerlink" title="为什么需要Maven"></a>为什么需要Maven</h2><h3 id="省时省力"><a href="#省时省力" class="headerlink" title="省时省力"></a>省时省力</h3><p>​	使用脚本建立高度自定义的构建系统就像购买组装PC，在此之前，你需要了解各类配件的优劣，CPU、内存、主板、显卡，甚至声卡，跑了很多商家，终于组装好，然后自己装操作系统和驱动程序……结果，花了大量时间，机器稳定性又不好，耗时耗力，实际项目中无法给你那么多时间。使用Maven就像购买品牌PC，不同的是Maven是开源免费的，你可以去了解Maven是如何工作的，而我们无法知道那些PC巨头的商业秘密。</p>
<h3 id="IDE不是万能的"><a href="#IDE不是万能的" class="headerlink" title="IDE不是万能的"></a>IDE不是万能的</h3><p>​	IDE依赖大量的手工操作。编译、测试、代码生成等工作都是相互独立的，很难一键完成所有工作。</p>
<p>​	很难在项目中统一所有的IDE配置，一个在机器A上可以成功运行的任务，到了机器B的IDE中可能就会失败。</p>
<p>​	应合理利用IDE，而不是过度依赖。在IDE中一次次的点击鼠标是愚蠢的行为。主流IDE都集成了Maven，在IDE中可以方便地运行Maven执行构建。</p>
<h3 id="不重复发明轮子"><a href="#不重复发明轮子" class="headerlink" title="不重复发明轮子"></a>不重复发明轮子</h3><p>Maven管理：</p>
<p>搭建Web项目时需要很多jar包，很少人能一个不少地找出来，即使找出来也耗时耗力，项目还没开始，WEB-INF&#x2F;lib下已经有几百个jar包了，带版本号的、不带版本号的、有用的、没用的、冲突的，怎一个乱字了得。想要删除没用的jar包，很困难。</p>
<p>Maven轻松管理这些jar包。</p>
<p>Maven规范了目录结构。</p>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>​	Maven构建：</p>
<p>​		1.Maven是跨平台的</p>
<p>​		2. 自动化构建过程，从清理、编译、测试到生成报告，再到打包和部署。</p>
<p>​	Maven管理：</p>
<p>​		1. 管理并解决依赖问题。</p>
<p>​		2. 管理项目信息，包括项目描述、开发者列表、版本控制系统地址、许可证、缺陷管理系统地址等；通过Maven自动生成的站点，以及一些已有的插件，还能获得项目文档、测试报告、静态分析报告、源码版本日志报告等项目信息。</p>
<h1 id="Maven的安装和配置"><a href="#Maven的安装和配置" class="headerlink" title="Maven的安装和配置"></a>Maven的安装和配置</h1><h2 id="在Windows上安装Maven"><a href="#在Windows上安装Maven" class="headerlink" title="在Windows上安装Maven"></a>在Windows上安装Maven</h2><h3 id="检查JDK安装"><a href="#检查JDK安装" class="headerlink" title="检查JDK安装"></a>检查JDK安装</h3><p>​	检查Java安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> %JAVA_HOME%  <span class="comment"># 输出JDK安装路径</span></span><br><span class="line">java –version  <span class="comment"># 版本查看</span></span><br></pre></td></tr></table></figure>

<h3 id="下载Maven"><a href="#下载Maven" class="headerlink" title="下载Maven"></a>下载Maven</h3><p>​	历史版本： <a target="_blank" rel="noopener" href="https://archive.apache.org/dist/maven/maven-3/">https://archive.apache.org/dist/maven/maven-3/</a> </p>
<p>​	在Apache官网 <a target="_blank" rel="noopener" href="http://maven.apache.org/download.cgi">http://maven.apache.org/download.cgi</a> 下载最新版本：</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566462907328.png" alt="1566462907328"></p>
<h3 id="本地安装"><a href="#本地安装" class="headerlink" title="本地安装"></a>本地安装</h3><p>​	<strong>a.解压到本地</strong></p>
<p>​	<strong>b.配置环境变量</strong></p>
<p>​		1).添加环境变量MAVEN_HOME（或M2_HOME，maven版本不同，变量名可能不同，具体要看bin目录下配置java命令的脚本中使用的是什么），值为maven包的路径；</p>
<p>​		例： MAVEN_HOME &#x3D; D:\apache-maven-3.5.4</p>
<p>​		2).在环境变量PATH里面添加maven的bin的路径；</p>
<p>​			%MAVEN_HOME%\bin;  mvn执行脚本的位置</p>
<p>​	<strong>c.检查安装情况</strong></p>
<p>​		echo %MAVEN_HOME%   检查环境变量是否指向正确的安装目录</p>
<p>​		mvn –v    检查能否找到正确的执行脚本</p>
<p><strong>帮助：</strong></p>
<p>​	在cmd中输入命令时，Windows首先会在当前目录中寻找可执行文件或脚本，如果没找到，Windows会遍历环境变量Path中定义的路径。</p>
<p>​	打开新的cmd窗口检查安装情况，新的环境变量配置需要新的cmd窗口才能生效。</p>
<h3 id="升级Maven"><a href="#升级Maven" class="headerlink" title="升级Maven"></a>升级Maven</h3><p>​	下载新的Maven，解压到本地，更新MAVEN_HOME环境变量即可。</p>
<h2 id="安装目录分析"><a href="#安装目录分析" class="headerlink" title="安装目录分析"></a>安装目录分析</h2><h3 id="MAVEN-HOME"><a href="#MAVEN-HOME" class="headerlink" title="MAVEN_HOME"></a>MAVEN_HOME</h3><p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566463035122.png" alt="1566463035122"></p>
<p>bin：  包含mvn运行的脚本，用来配置Java命令，不带后缀的是UNIX平台脚本，带后缀的是Windows平台。</p>
<p>boot： 只包含一个文件plexus-classworlds-2.5.2.jar，plexus-classworlds是一个类加载器框架，提供了更丰富的语法以方便配置，Maven使用该框架加载自己的类库。对一般的Maven用户来说，不必关心该文件。</p>
<p>conf： settings.xml，全局定制Maven行为。</p>
<p>​			 toolchains.xml，设置工具链安装路径的配置文件；例如希望使用不同的JDK版本构建项目，首先在pom.xml中通过插件配置要使用的版本，</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566463150612.png" alt="1566463150612"></p>
<p>​		当工具链插件执行时，它将在toolchains.xml中查找符合要求的工具链，把找到的JDK工具链设置到MavenSession中，从而使用该工具链（即安装在 <strong>&#x2F;path&#x2F;to&#x2F;jdk&#x2F;1.5</strong> 下的JDK）编译源代码。</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566464091426.png" alt="1566464091426"></p>
<p>lib：  包含所有Maven运行时需要的Java类库，Maven是分模块开发的，因此用户能看到诸如maven-core-3.5.4.jar、maven-model-3.5.4.jar之类的文件。</p>
<p>还包含Maven用到的第三方依赖，如commons-io-2.5.jar、commons-lang3-3.5.jar等。</p>
<p>lib目录就是真正的Maven。</p>
<p>用户可以在这个目录中找到Maven内置的超级POM，后面详细讲解。</p>
<p>LICENSE.txt：     记录了Maven使用的软件许可证</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566464290627.png" alt="1566464290627"></p>
<p>NOTICE.txt：      记录了Maven包含的第三方软件</p>
<p>README.txt：  Maven的简要介绍，包括安装需求及如何安装的简要指令等。</p>
<h2 id="设置HTTP代理"><a href="#设置HTTP代理" class="headerlink" title="设置HTTP代理"></a>设置HTTP代理</h2><p>有时公司基于安全考虑，要求使用通过安全认证的代理访问因特网。这时就要为Maven配置HTTP代理，才能让它正常访问外部仓库。</p>
<p>1、确认无法直接访问中央仓库：ping repol.maven.org 检查网络 </p>
<p>2、检查代理服务器是否畅通：telnet 本机IP 代理端口</p>
<p>​		如果telnet连接正确，则输入ctrl+]，然后q，回车，退出即可。</p>
<p>3、编辑settings.xml文件，添加代理配置如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">proxies</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 可以有多个proxy元素，默认第一个被激活的proxy会生效。 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">proxy</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>my-proxy<span class="tag">&lt;/<span class="name">id</span>&gt;</span> <span class="comment">&lt;!-- 声明一个id为my-proxy的代理 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">active</span>&gt;</span>true<span class="tag">&lt;/<span class="name">active</span>&gt;</span> <span class="comment">&lt;!-- 激活该代理 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">protocol</span>&gt;</span>http<span class="tag">&lt;/<span class="name">protocol</span>&gt;</span> <span class="comment">&lt;!-- 代理协议 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 当服务器需要认证时，需配置username和password --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">username</span>&gt;</span>proxyuser<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">password</span>&gt;</span>proxypass<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">host</span>&gt;</span>proxy.host.net<span class="tag">&lt;/<span class="name">host</span>&gt;</span> <span class="comment">&lt;!-- 主机名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">port</span>&gt;</span>80<span class="tag">&lt;/<span class="name">port</span>&gt;</span> <span class="comment">&lt;!-- 端口 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定哪些主机名不需要代理，&quot;|&quot;符号分隔主机名，下面通配符&quot;*&quot;表示以google.com结尾的域名访问不要通过代理 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">nonProxyHosts</span>&gt;</span>local.net|some.host.com|*.google.com<span class="tag">&lt;/<span class="name">nonProxyHosts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">proxy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">proxies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>帮助：</p>
<p>​	代理<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8">服务器</a>（Proxy Server）是一种重要的服务器安全功能，它的工作主要在<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%BC%80%E6%94%BE%E7%B3%BB%E7%BB%9F%E4%BA%92%E8%81%94">开放系统互联</a>(OSI)模型的会话层，从而起到<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%98%B2%E7%81%AB%E5%A2%99">防火墙</a>的作用。代理服务器大多被用来连接<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/INTERNET">INTERNET</a>（国际互联网）和Local Area Network（<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B1%80%E5%9F%9F%E7%BD%91">局域网</a>）。</p>
<p>​	<strong>代理</strong>（英语：<strong>Proxy</strong>），也称<strong>网络代理</strong>，是一种特殊的网络服务，允许一个网络终端（一般为客户端）通过这个服务与另一个网络终端（一般为服务器）进行非直接的连接。一些网关、路由器等网络设备具备网络代理功能。一般认为代理服务有利于保障网络终端的隐私或安全，防止攻击。[1] </p>
<p>​	具体详情请网上搜索“代理服务器”、“HTTP代理”。</p>
<h2 id="安装m2eclipse"><a href="#安装m2eclipse" class="headerlink" title="安装m2eclipse"></a>安装m2eclipse</h2><p>​		<a target="_blank" rel="noopener" href="http://www.eclipse.org/m2e/">http://www.eclipse.org/m2e/</a></p>
<p>​	下载地址：<a target="_blank" rel="noopener" href="http://www.eclipse.org/m2e/m2e-downloads.html">http://www.eclipse.org/m2e/m2e-downloads.html</a></p>
<p>​	m2eclipse就是集成Maven的eclipse。</p>
<p>​	新版本的eclipse集成了Maven，不需要安装。</p>
<h2 id="Maven安装最佳实践"><a href="#Maven安装最佳实践" class="headerlink" title="Maven安装最佳实践"></a>Maven安装最佳实践</h2><p>本节介绍一些在安装Maven过程中不是必须的，但十分有用的实践。</p>
<h3 id="设置MAVEN-OPTS环境变量"><a href="#设置MAVEN-OPTS环境变量" class="headerlink" title="设置MAVEN_OPTS环境变量"></a>设置MAVEN_OPTS环境变量</h3><p>当项目比较大时，使用Maven生成项目需要占用大量内存，如果超过Java默认的最大可用内存，则会报 java.lang.OutOfMemeoryError。</p>
<p>解决此问题有两种方法：</p>
<p>​		一种为修改Maven的修改脚本文件，此方法比较麻烦，且容易忘记，不推荐；</p>
<p>​		另一种方法为设置 MAVEN_OPTS 环境变量，此方法一次设定，一劳永逸，推荐。</p>
<p>MAVEN_OPTS 环境变量设置方法：</p>
<p>​		在环境变量中添加一个新变量名为 MAVEN_OPTS，值为 <code>-Xms128m -Xmx512m</code> （数值可以自定义，Xms为初始内存，即最小内存，Xmx为最大内存）</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/9517529-03fa55b799191921.webp" alt="img"></p>
<h3 id="配置用户范围settings-xml"><a href="#配置用户范围settings-xml" class="headerlink" title="配置用户范围settings.xml"></a>配置用户范围settings.xml</h3><p>Maven用户可以选择配置</p>
<p>​	%MAVEN_HOME%&#x2F;conf&#x2F;settings.xml    全局范围，整台机器上的所有用户都会受该配置影响</p>
<p>​	~&#x2F;.m2&#x2F;settings.xml    用户范围，只有当前用户才会受该配置影响</p>
<p>​	配置用户范围的settings.xml文件便于Maven升级，而且升级时无需修改conf下的settings.xml。</p>
<h3 id="不要使用IDE内嵌的Maven"><a href="#不要使用IDE内嵌的Maven" class="headerlink" title="不要使用IDE内嵌的Maven"></a>不要使用IDE内嵌的Maven</h3><p>无论Eclipse还是NetBeans，当集成Maven时，都会安装上一个<strong>内嵌的Maven</strong>：</p>
<p>潜在问题：</p>
<p>​	a.较新版本的Maven存在很多不稳定因素，容易造成一些难以理解的问题</p>
<p>​	b.除了IDE，也经常使用命令行的Maven，如果版本不一致，容易造成构建行为的不一致</p>
<p>在eclipse中使用使用外部Maven：</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566464935944.png" alt="1566464935944"></p>
<h1 id="Maven使用入门"><a href="#Maven使用入门" class="headerlink" title="Maven使用入门"></a>Maven使用入门</h1><h2 id="编写POM"><a href="#编写POM" class="headerlink" title="编写POM"></a>编写POM</h2><p>首先创建一个名为hello-mavenpom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 第一行XML头，指定该xml文档的版本和编码方式 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- project是所有pom.xml的根元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span> <span class="comment">&lt;!-- 当前POM模型的版本，对于Maven2和Maven3来说，它只能是4.0.0 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 下面三个元素定义了一个项目基本的坐标，任何的jar、pom、war都是以这些基本的坐标区分的。 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jonsnows<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span> <span class="comment">&lt;!-- 群组，往往和项目存在的组织和公司存在关联 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hello-maven<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> <span class="comment">&lt;!-- 当前Maven项目在组中唯一的ID --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 当前版本号，用于描述开发过程的阶段性标识 --&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Maven hello maven project<span class="tag">&lt;/<span class="name">name</span>&gt;</span> <span class="comment">&lt;!-- 项目名称，不是必须的，但推荐使用，方便信息交流。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 没有任何实际的Java代码就能定义一个Maven项目的POM，体现了Maven的优点：</span></span><br><span class="line"><span class="comment">		让项目对象模型最大程度地与实际代码相独立，称之为解耦，或正交性。</span></span><br><span class="line"><span class="comment">	  很大程度上避免了Java代码和POM的相互影响。升级版本时，只需要修改POM就可以；而在POM稳定后，日常开发工作不涉及POM的修改。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="编写主代码"><a href="#编写主代码" class="headerlink" title="编写主代码"></a>编写主代码</h2><p>​	项目主代码和测试代码不同，主代码会被打包到最终构件中（如jar），而测试代码只在测试时用到，不会被打包。遵循Maven的约定，创建目录com&#x2F;main&#x2F;java，Maven会自动搜索该目录找到项目主代码。然后在该目录下创建文件com&#x2F;jonsnows&#x2F;hellomaven&#x2F;HelloMaven.java，内容如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jonsnows.hellomaven;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloMaven</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		System.out.println(<span class="keyword">new</span> <span class="title class_">HelloMaven</span>().sayMaven());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">sayMaven</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Hello Maven&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	Java类的包名是com.jonsnows.hellomaven，与之前在POM中定义的groupId和artifactId相吻合。一般来说，项目中Java类的包都应基于项目的groupId和artifactId，这样更加清晰，更加符合逻辑，也方便搜索构建或者Java类。</p>
<p>代码编写完毕后，使用Maven进行编译，在项目根目录（POM文件所在目录）下运行命令mvn clean compile会得到如下输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[INFO] Scanning <span class="keyword">for</span> projects...</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Building hello-maven 0.0.1</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ hello-maven ---</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ hello-maven ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\main\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ hello-maven</span><br><span class="line">---</span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\classes</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="keyword">time</span>: 0.795 s</span><br><span class="line">[INFO] Finished at: 2018-03-23T09:09:38+08:00</span><br><span class="line">[INFO] Final Memory: 11M/27M</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<p>clean：clean插件的clean目标。删除target&#x2F;目录。Maven构建默认输出在target&#x2F;目录中。</p>
<p>compile：compiler插件的compile目标。编译项目主代码至target&#x2F;calsses目录。编译好的类为com&#x2F;jonsnows&#x2F;hellomaven&#x2F;HelloMaven.class。</p>
<p>后文详细介绍Maven插件及其编写方法。</p>
<h2 id="编写测试代码"><a href="#编写测试代码" class="headerlink" title="编写测试代码"></a>编写测试代码</h2><p>为了使项目结构清晰，主代码与测试代码应该分别位于独立的目录中。</p>
<p>默认主代码目录：src&#x2F;main&#x2F;java，默认测试代码目录：src&#x2F;test&#x2F;java。</p>
<p>Junit是单元测试标准，要使用Junit，需为hello-maven项目添加Junit依赖，</p>
<p>在project元素下添加：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">    	&lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">    	&lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">    	&lt;version&gt;4.12&lt;/version&gt;</span><br><span class="line">    	&lt;scope&gt;test&lt;/scope&gt; &lt;!-- 依赖范围，若为test，表示该依赖只对测试有效。换言之，测试代码中的import Junit代码是没问题的，但在主代码中用import Junit代码，就会造成编译错误。如果不声明依赖范围，默认是compile，表示该依赖对主代码和测试代码都有效。 --&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">  &lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>

<p>编写测试类，在src&#x2F;test&#x2F;java目录下创建文件:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package com.jonsnows.hellomaven;</span><br><span class="line">import static org.junit.Assert.assertEquals;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">public class HelloMavenTest &#123;</span><br><span class="line">	@Test // Junit约定所有需要执行测试的方法都以test开头</span><br><span class="line">	public void testSayMaven()&#123;</span><br><span class="line">		HelloMaven helloMaven = new HelloMaven(); // 第一步</span><br><span class="line">		String result = helloMaven.sayMaven(); // 第二步</span><br><span class="line">		assertEquals(&quot;Hello Maven&quot;, result); // 第三步</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一个典型的单元测试包含三步：</p>
<p>​	1.准备测试类及数据；</p>
<p>​	2.执行要测试的行为；</p>
<p>​	3.检查结果。</p>
<p>调用Maven执行测试。运行mvn clean test，而Maven实际执行的不止这两个任务，包括</p>
<p>​	clean：clean、        删除target&#x2F;目录</p>
<p>​	resources：resources、 主资源处理</p>
<p>​	compiler：compile、      主代码编译</p>
<p>​	resources：testResources、   测试资源处理</p>
<p>​	compiler：testCompile。  测试代码编译 &#x2F;&#x2F; 输出测试报告</p>
<p>等等，这是Maven生命周期的一个特性。surefire是Maven中负责执行测试的插件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">[INFO] Scanning <span class="keyword">for</span> projects...</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Building Maven hello maven project 1.0-SNAPSHOT</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ hello-maven ---</span><br><span class="line">[INFO] Deleting F:\hello-maven\target</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ hello-mave</span><br><span class="line">n ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\main\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ hello-maven ---</span><br><span class="line"></span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\classes</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ he</span><br><span class="line">llo-maven ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\<span class="built_in">test</span>\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ hello-m</span><br><span class="line">aven ---</span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\test-classes</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-surefire-plugin:2.12.4:<span class="built_in">test</span> (default-test) @ hello-maven ---</span><br><span class="line">[INFO] Surefire report directory: F:\hello-maven\target\surefire-reports</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line"> T E S T S</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">输出测试报告：显示运行了多少测试，失败了多少，出错了多少，跳过了多少。</span><br><span class="line">显然测试通过了</span><br><span class="line">Running com.jonsnows.hellomaven.HelloMavenTest</span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.046 sec</span><br><span class="line"></span><br><span class="line">Results :</span><br><span class="line"></span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</span><br><span class="line"></span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="keyword">time</span>: 1.394 s</span><br><span class="line">[INFO] Finished at: 2018-03-23T10:51:29+08:00</span><br><span class="line">[INFO] Final Memory: 12M/30M</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<h2 id="打包和运行"><a href="#打包和运行" class="headerlink" title="打包和运行"></a>打包和运行</h2><p>​	项目进行编译、测试之后就是打包（package）。Hello Maven的POM中没有指定打包类型，使用默认打包类型jar。执行命令mvn clean package打包，输出如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[INFO] Scanning <span class="keyword">for</span> projects...</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Building Maven hello maven project 1.0-SNAPSHOT</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ hello-maven ---</span><br><span class="line">[INFO] Deleting F:\hello-maven\target</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ hello-mave</span><br><span class="line">n ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\main\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ hello-maven ---</span><br><span class="line"></span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\classes</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ he</span><br><span class="line">llo-maven ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\<span class="built_in">test</span>\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ hello-m</span><br><span class="line">aven ---</span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\test-classes</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-surefire-plugin:2.12.4:<span class="built_in">test</span> (default-test) @ hello-maven ---</span><br><span class="line">[INFO] Surefire report directory: F:\hello-maven\target\surefire-reports</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line"> T E S T S</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">Running com.jonsnows.hellomaven.HelloMavenTest</span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.05 sec</span><br><span class="line"></span><br><span class="line">Results :</span><br><span class="line"></span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</span><br><span class="line"></span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ hello-maven ---</span><br><span class="line">[INFO] Building jar: F:\hello-maven\target\hello-maven-1.0-SNAPSHOT.jar</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="keyword">time</span>: 1.519 s</span><br><span class="line">[INFO] Finished at: 2018-03-23T11:40:22+08:00</span><br><span class="line">[INFO] Final Memory: 13M/32M</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<p>​	类似的，Maven在打包之前执行编译、测试等操作。可看到jar：jar任务负责打包，jar插件的jar目标将项目主代码打包成一个名为hello-maven-1.0-SNAPSHOT.jar的文件，位于target&#x2F;输出目录，是根据artifact-version.jar规则进行命名的，还可以使用finalName自定义该文件名称。</p>
<p>​	复制之个jar到其他项目的classpath中可直接使用。但是，**如何让其他的Maven项目直接引用这个jar呢？**还需要安装，执行mvn clean install：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">[INFO] Scanning <span class="keyword">for</span> projects...</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Building Maven hello maven project 1.0-SNAPSHOT</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ hello-maven ---</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ hello-mave</span><br><span class="line">n ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\main\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ hello-maven ---</span><br><span class="line"></span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\classes</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ he</span><br><span class="line">llo-maven ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\<span class="built_in">test</span>\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ hello-m</span><br><span class="line">aven ---</span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\test-classes</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-surefire-plugin:2.12.4:<span class="built_in">test</span> (default-test) @ hello-maven ---</span><br><span class="line">[INFO] Surefire report directory: F:\hello-maven\target\surefire-reports</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line"> T E S T S</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">Running com.jonsnows.hellomaven.HelloMavenTest</span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.048 sec</span><br><span class="line"></span><br><span class="line">Results :</span><br><span class="line"></span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</span><br><span class="line"></span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ hello-maven ---</span><br><span class="line">[INFO] Building jar: F:\hello-maven\target\hello-maven-1.0-SNAPSHOT.jar</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-install-plugin:2.4:install (default-install) @ hello-maven ---</span><br><span class="line">[INFO] Installing F:\hello-maven\target\hello-maven-1.0-SNAPSHOT.jar to F:\Tools</span><br><span class="line">\Maven-3.5.2-LocalRepository\3.5.2\repository\com\jonsnows\hello-maven\1.0-SNAPS</span><br><span class="line">HOT\hello-maven-1.0-SNAPSHOT.jar</span><br><span class="line">[INFO] Installing F:\hello-maven\pom.xml to F:\Tools\Maven-3.5.2-LocalRepository</span><br><span class="line">\3.5.2\repository\com\jonsnows\hello-maven\1.0-SNAPSHOT\hello-maven-1.0-SNAPSHOT</span><br><span class="line">.pom</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="keyword">time</span>: 1.584 s</span><br><span class="line">[INFO] Finished at: 2018-03-23T11:59:18+08:00</span><br><span class="line">[INFO] Final Memory: 13M/32M</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<p>​	由输出可知，该任务（安装任务install：install）将项目输出的jar安装到了Maven本地仓库，在相应文件夹可看到Hello Maven项目的pom和jar。构件安装到本地仓库后，其他Maven项目就可使用它了。</p>
<p>​	我们已经体验了Maven最主要的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mvn clean compile</span><br><span class="line">mvn clean test        执行前先执行compile</span><br><span class="line">mvn clean package     执行前先执行test</span><br><span class="line">mvn clean install     执行前先执行package</span><br></pre></td></tr></table></figure>

<p>默认打包生成的jar不能直接运行</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466333641.png" alt="1566466333641"></p>
<p>因为带有main方法的类信息不会添加到manifest中（打开jar文件中的META-INF&#x2F;MANIFEST.MF文件，将无法看到Main-Class一行）</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466382778.png" alt="1566466382778"></p>
<p>为了生成可执行的jar文件，需要借助maven-shade-plugin，配置该插件如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">transformers</span>&gt;</span></span><br><span class="line">		        <span class="tag">&lt;<span class="name">transformer</span> <span class="attr">implementation</span>=<span class="string">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span>&gt;</span></span><br><span class="line">		          <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.jonsnows.hellomaven.HelloMaven<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">		        <span class="tag">&lt;/<span class="name">transformer</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;/<span class="name">transformers</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>plugin元素在POM中的 <code>&lt;project&gt; &lt;build&gt; &lt;plugins&gt;</code> 下面，我们配置了mainClass为com.jonsnows.hellomaven.HelloMaven，项目在打包时会将该信息放到MANIFEST中。现在执行mvn clean install，构建完成后打开target&#x2F;目录如下图：</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466606365.png" alt="1566466606365"></p>
<p>打开前面jar的META-INF&#x2F;MANIFEST.MF如下：</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466639189.png" alt="1566466639189"></p>
<p>在项目根目录（POM文件所在目录）执行该jar文件：</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466653666.png" alt="1566466653666"></p>
<h2 id="使用Archetype（原型）生成项目骨架"><a href="#使用Archetype（原型）生成项目骨架" class="headerlink" title="使用Archetype（原型）生成项目骨架"></a>使用Archetype（原型）生成项目骨架</h2><p>​	Hello Maven中有一些Maven约定：在项目根目录放置pom.xml，在src&#x2F;main&#x2F;java目录放置主代码，在src&#x2F;test&#x2F;java目录放置测试代码。这些<strong>基本的目录结构</strong>和<strong>pom.xml文件内容</strong>称为<strong>项目的骨架</strong>。</p>
<p>​	Maven提供了<strong>Archetype</strong>帮助我们快速勾勒出项目骨架。</p>
<p>如果是Maven3，简单地运行：</p>
<p>​	mvn archetype:generate</p>
<p>如果是Maven2，最好运行如下命令：</p>
<p>​	mvn org.apache.maven.plugins:maven-archetype-plugin:2.0-alpha-5:generate</p>
<p>上面的命令实际上是在运行插件maven-archetype-plugin，注意冒号的分隔，其格式为</p>
<p>​	groupId:artifactId:version:goal</p>
<p>org.apache.maven.plugins       &#x2F;&#x2F; maven官方插件的groupId</p>
<p>maven-archetype-plugin     &#x2F;&#x2F; Archetype插件的artifactId</p>
<p>2.0-alpha-5                &#x2F;&#x2F; 当时插件最新的稳定版（现在已不是最新稳定版）</p>
<p>Generate                   &#x2F;&#x2F; 要使用的插件目标</p>
<p>​	在Maven2中简单地运行mvn archetype:generate命令不是安全的，没有指定Archetype插件的版本，Maven就会自动下载最新的版本，可能是不稳定的SNAPSHOT版本，导致运行失败。而在Maven3中，会解析最新的稳定版本，是安全的。</p>
<p>运行命令mvn archetype:generate后，会有一段长长的输出，有很多可用的Archetype供选择，包括著名的Appfuse项目的Archetype、JPA项目的Archetype等。每一个Archetype前面都有编号，命令会提示一个默认的编号，其对应的Archetype为maven-archetype-quickstart，直接回车选择该Archetype，接着Maven提示要创建项目的groupId、artifactId、version以及包名package。如下输入并确认：</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466872041.png" alt="1566466872041"></p>
<p>Archetype插件会创建一个名为hello-maven（我们定义的artifactId）的目录，pom.xml已被创建，主代码和测试用例也创建好。请观察创建后的项目，此处略。</p>
<h2 id="6-m2eclipse简单使用"><a href="#6-m2eclipse简单使用" class="headerlink" title="6.m2eclipse简单使用"></a>6.m2eclipse简单使用</h2><h3 id="6-1导入项目"><a href="#6-1导入项目" class="headerlink" title="6.1导入项目"></a>6.1导入项目</h3><p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466948585.png" alt="1566466948585"></p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566466956556.png" alt="1566466956556"></p>
<h3 id="6-2创建Maven项目"><a href="#6-2创建Maven项目" class="headerlink" title="6.2创建Maven项目"></a>6.2创建Maven项目</h3><p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566467157705.png" alt="1566467157705"></p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566467164774.png" alt="1566467164774"></p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566467171055.png" alt="1566467171055"></p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/1566467179224.png" alt="1566467179224"></p>
<h3 id="6-3运行Maven命令"><a href="#6-3运行Maven命令" class="headerlink" title="6.3运行Maven命令"></a>6.3运行Maven命令</h3><p>eclipse下，右键项目或项目的POM文件，选择 <code>Run As</code> 就会看到可运行的 maven 命令。</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113161012000.png" alt="image-20191113161012000"></p>
<h1 id="坐标和依赖"><a href="#坐标和依赖" class="headerlink" title="坐标和依赖"></a>坐标和依赖</h1><h2 id="何为Maven坐标"><a href="#何为Maven坐标" class="headerlink" title="何为Maven坐标"></a>何为Maven坐标</h2><p>​		Maven坐标是一个部件的唯一标识，为构件引入秩序。</p>
<h2 id="坐标详解"><a href="#坐标详解" class="headerlink" title="坐标详解"></a>坐标详解</h2><p>Maven坐标是通过一些元素定义的，它们是groupId、artifactId、version、packaging、classifier。下面是一组坐标：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.sonatype.nexus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nexus-indexer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这是nexus-indexer的坐标定义，nexus-indexer是一个对Maven仓库编纂索引并提供搜索功能的类库，它是Nexus项目的一个子模块。</p>
<p><font color="blue"><strong>groupId：</strong></font></p>
<p>​		<strong>命名</strong>：定义当前Maven项目隶属的<strong>实际项目</strong>。Maven项目和实际项目不一定是一对一的关系。比如SpringFramework是实际项目，对应的Mavne项目：spring-core、spring-context等模块。<strong>不应该对应项目隶属的组织或公司</strong>，如果groupId只定义到组织级别，artifactId只能定义Maven项目（模块），那么实际项目这个层将难以定义。</p>
<p>​		<strong>表示方式</strong>：通常与域名反向意义对应。org.sonatype表示Sonatype公司建立的一个非盈利性组织，nexus表示Nexus这一实际项目，该groupId与域名nexus.sonatype.org对应</p>
<p><font color="blue"><strong>artifactId：</strong></font></p>
<p>​		定义实际项目中的一个Maven项目（模块），推荐做法是使用实际项目名称作为artifactId的前缀，便于寻找实际构件。默认情况下，Maven生成的构件，其文件名会以artifactId开头，如nexus-indexer-2.0.0.jar，使用前缀后能方便从一个lib文件夹中找到某个项目的一组构件。5个项目，每个项目都有一个core模块，若没有前缀，无法区分各模块属于哪个项目。</p>
<p><font color="blue"><strong>version：</strong></font></p>
<p>​		定义Maven项目当前所处的版本，</p>
<p><font color="blue"><strong>packaging：</strong></font></p>
<p>​		定义Maven项目的打包方式，默认值jar。</p>
<p>​		packaging为jar，生成.jar文件；为war，生成.war文件；但并非一定与构件扩展名对应，比如packaging为maven-plugin的构件扩展名为jar。</p>
<p>​		打包方式会影响构建的生命周期，比如jar打包和war打包会使用不同的命令。</p>
<p><font color="blue"><strong>classifier：</strong></font></p>
<p>​		帮助定义构建输出的一些附属构件。附属构件与主构件对应，如上例中的主构件是nexus-indexer-2.0.0.jar，该项目还可能会通过一些插件生成如nexus-indexer-2.0.0-javadoc.jar、nexus-indexer-2.0.0-sources.jar这样一些附属构件，其包含了Java文档和源代码。这时候，javadoc和sources就是这两个附属构件的classifier。</p>
<p>​		<font color="blue">groupId、artifactId、version        必须定义的</font><br>​		<font color="blue">packaging                                         可选的（默认为jar）</font><br>​		<font color="blue">classifier                                           不能直接定义的</font></p>
<h2 id="依赖的配置"><a href="#依赖的配置" class="headerlink" title="依赖的配置"></a>依赖的配置</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span>							<span class="comment">&lt;!-- 根元素 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span>  				<span class="comment">&lt;!-- 可声明多个项目依赖 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span><span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>		<span class="comment">&lt;!-- 依赖的坐标 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span><span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>	<span class="comment">&lt;!-- 依赖的坐标 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span>		<span class="comment">&lt;!-- &lt;!-- 依赖的坐标 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">type</span>&gt;</span><span class="tag">&lt;/<span class="name">type</span>&gt;</span>	<span class="comment">&lt;!-- 依赖的类型，对应于项目坐标定义的packaging。不声明默认为jar。 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span><span class="tag">&lt;/<span class="name">scope</span>&gt;</span>		<span class="comment">&lt;!-- 依赖的范围 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">optional</span>&gt;</span><span class="tag">&lt;/<span class="name">optional</span>&gt;</span>	<span class="comment">&lt;!-- 标记依赖是否可选，（可选依赖） --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">exclusions</span>&gt;</span>				<span class="comment">&lt;!-- 用来排除依赖传递性 --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">exclusion</span>&gt;</span>			</span><br><span class="line">				<span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span>			</span><br><span class="line">			<span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span>			</span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>				</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>					</span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="依赖范围"><a href="#依赖范围" class="headerlink" title="依赖范围"></a>依赖范围</h2><p>用来控制依赖与三种classpath（编译classpath、测试classpath、运行classpath）的关系</p>
<p><font color="red">complie：</font>编译依赖范围。若不指定，默认使用该依赖范围。对编译、测试、运行三种classpath都有效。例如spring-core，在这三个阶段都需要使用。</p>
<p><font color="red">test：</font>测试依赖范围。只对测试classpath有效，在编译<strong>主代码</strong>或运行项目时无法使用。例如Junit，只在编译<strong>测试代码</strong>及运行测试的时候使用。</p>
<p><font color="red">provided：</font>已提供依赖范围。对于编译和测试classpath有效，运行时无效。例如servlet-api，在运行项目时，由于容器已经提供，就不需要Maven重复引入。</p>
<p><font color="red">runtime：</font>运行时依赖范围。对于测试和运行classpath有效，但在编译主代码时无效。例如，<strong>JDBC驱动实现，项目主代码的编译只需要JDK提供的JDBC接口，只有在执行测试或者运行项目的时候才需要实现上述接口的具体JDBC驱动。</strong></p>
<p><font color="red">system：</font>系统依赖范围。对于编译和测试classpath有效，运行时无效。但是，使用system范围的依赖时必须通过systemPath元素显式地指定依赖文件的路径。由于此类依赖不是通过Maven仓库解析的，而且往往与本机系统绑定，可能造成构建的不可移植，因此需谨慎使用。<strong>systemPath元素可以引用环境变量</strong>：(<a target="_blank" rel="noopener" href="https://blog.csdn.net/hongweigg/article/details/54091148">Maven读取环境变量</a>)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>system<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">systemPath</span>&gt;</span>$&#123;env.JAVA_HOME&#125;/lib/tools.jar<span class="tag">&lt;/<span class="name">systemPath</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><font color="red">import：</font>导入依赖范围。</p>
<p>各种依赖范围（除import）与三种classpath的关系图：</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113163709112.png" alt="image-20191113163709112"></p>
<h2 id="传递性依赖"><a href="#传递性依赖" class="headerlink" title="传递性依赖"></a>传递性依赖</h2><h3 id="何为传递性依赖"><a href="#何为传递性依赖" class="headerlink" title="何为传递性依赖"></a>何为传递性依赖</h3><p>​		project有一个compile范围的spring-core依赖，spring-core有一个compile范围的commons-logging依赖，那么project就会有一个compile范围的commons-logging依赖。Commons-logging是project的一个传递性依赖。</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113163823551.png" alt="image-20191113163823551"></p>
<p>​		Spring Framework会依赖其他开源类库，spring-framework-5.0.0.RELEASE-dist.zip包含了所有Spring Framework的jar包，以及所有它依赖的其他jar包，很容易引入不必要的依赖；另一种做法是只下载Spring Framework的压缩包，不包含其他相关依赖，到实际使用时，根据报错信息或查询相关文档，引入需要的其他依赖。这样会非常麻烦。</p>
<p>​		有了传递性依赖机制，在使用Spring Framework的时候就不用过去考虑它依赖了什么，也不用担心引入多余的依赖。Maven会解析各个直接依赖的POM，将那些必要的间接依赖，以传递性依赖的形式引入到当前项目中。</p>
<h3 id="传递性依赖和依赖范围"><a href="#传递性依赖和依赖范围" class="headerlink" title="传递性依赖和依赖范围"></a>传递性依赖和依赖范围</h3><p>​		依赖范围不仅可以控制依赖与三种classpath的关系，还对传递性依赖产生影响。</p>
<p>​		假设A依赖于B，B依赖于C，即 A<img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/clip_image001.png" alt="img">B<img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/clip_image001.png" alt="img">C，我们说A对于B是第一直接依赖，B对于C是第二直接依赖，A对于C是传递性依赖。第一直接依赖的范围和第二直接依赖的范围决定了传递性依赖的范围。如下图，</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113164245040.png" alt="image-20191113164245040"></p>
<p><strong>规律：</strong></p>
<p>​		当第二直接依赖的范围是compile时，传递性依赖的范围与第一直接依赖的范围一致；</p>
<p>​		当第二直接依赖的范围是test时，依赖不会得以传递；</p>
<p>​		当第二直接依赖的范围是provided时，只传递第一直接依赖范围为provided的依赖，且传递性依赖的范围同样为provided；</p>
<p>​		当第二直接依赖的范围是runtime时，传递性依赖的范围与第一直接依赖的范围一致，但compile例外，此时传递性依赖的范围为runtime。</p>
<h2 id="Mave依赖调解"><a href="#Mave依赖调解" class="headerlink" title="Mave依赖调解"></a>Mave依赖调解</h2><p><strong>第一原则：</strong><font color="red">短路优先</font> </p>
<p>**第二原则：**路径相同则<font color="red">先声明优先</font> </p>
<p><font color="blue">原则目的：</font>确保任何一个构件只有唯一的版本在依赖中存在。</p>
<p>例：</p>
<p>​		A -&gt; B -&gt; C -&gt; X(1.0) </p>
<p>​		A -&gt; D -&gt; X(2.0) </p>
<p>​				X(2.0)会被解析使用。</p>
<p>​		A -&gt; B -&gt; Y(1.0)</p>
<p>​		A -&gt; C -&gt; Y(2.0)</p>
<p>​				依赖路径长度一样，如果B的依赖声明在C之前，那么Y(1.0)就会被解析使用。</p>
<p><strong>其它情况：</strong><font color="red">覆盖策略</font> </p>
<p>若<font color="red">一个组件不同版本</font>的依赖，存在于同一个pom文件，依赖调解两大原则都不起作用，需要采用<strong>覆盖策略</strong>来调解依赖冲突，最终会引入<font color="red">最后声明</font>的依赖。</p>
<h2 id="可选依赖"><a href="#可选依赖" class="headerlink" title="可选依赖"></a>可选依赖</h2><p>​		一般用不到。</p>
<p>例：</p>
<p>​		A依赖B，B依赖C，但不想让A依赖C，我们可以在B中这样配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jonsnows.ProjectC<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Project-C<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在A中正常引入B的依赖即可，这个时候，A就不会依赖C了。如果A用到了B中涉及C的功能，则需要在A的 <code>pom.xml</code> 文件中额外配置对C的依赖。</p>
<p>**应用场景：**假设有一个项目X，它实现了类似Hibernate的功能，支持很多种数据库驱动，例如：mysql，oracle等。我们在构建项目X的时候，确实需要所有这些依赖。但设想，假如有一个项目Y想使用项目X提供的功能，那么它极有可能只使用其中的一种数据库驱动。这个时候，就需要我们在项目X中将所有和驱动相关的依赖设置为可选依赖。只有这样，在项目Y中声明项目X为直接依赖的时候，才不会将项目X的所有关于驱动的依赖自动引入。这时，项目Y只需要额外声明自己真正需要依赖的驱动即可。</p>
<h2 id="排除依赖"><a href="#排除依赖" class="headerlink" title="排除依赖"></a>排除依赖</h2><p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113165951828.png" alt="image-20191113165951828"></p>
<p>​		<strong>可选依赖</strong>也能够达到排除依赖的效果。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.company.project<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">		    	<span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">		    		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		    		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">					<span class="comment">&lt;!-- 不需要version元素 --&gt;</span></span><br><span class="line">		    	<span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- ... 可以排除一个或多个传递性依赖 --&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	    	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="归类依赖"><a href="#归类依赖" class="headerlink" title="归类依赖"></a>归类依赖</h2><p>​		在唯一的地方定义版本，并且在dependency声明中引用这一版本。这样，在升级Spring Framework时只需修改一处。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.company.project<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 使用 properties 元素定义 Maven 属性，下面定义了一个 springframework.version 子元素，其值为 4.3.18.RELEASE 。 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">springframework.version</span>&gt;</span>4.3.18.RELEASE<span class="tag">&lt;/<span class="name">springframework.version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;springframework.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span> </span><br><span class="line">            <span class="comment">&lt;!-- 运行时会替换成实际值 4.3.18.RELEASE --&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;springframework.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;springframework.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;springframework.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="优化依赖"><a href="#优化依赖" class="headerlink" title="优化依赖"></a>优化依赖</h2><p>优化依赖，除多余的依赖，显式声明某些必要的依赖。 </p>
<p>使用 <code>mvn dependency:list</code> 和 <code>mvn dependency:tree</code> 可以帮助我们详细了解项目中所有的依赖的具体详细，在此基础上，还有 <code>mvn dependency:analyze</code> 工具可以帮助分析当前项目的依赖。</p>
<h3 id="已解析依赖"><a href="#已解析依赖" class="headerlink" title="已解析依赖"></a>已解析依赖</h3><p>maven会自动解析所有项目的直接依赖和传递性依赖，并且根据规则正确判断每个依赖的范围。对于一些依赖冲突，也能进行调解，以确保任何一个构件只能唯一的版本在依赖中存在。在这些工作之后，最后得到的那些依赖被称为<strong>已解析依赖</strong>。 </p>
<p>查看项目的已解析依赖：<code>mvn dependency:list</code> </p>
<h3 id="依赖树"><a href="#依赖树" class="headerlink" title="依赖树"></a>依赖树</h3><p>将直接在当前POM声明的依赖定义为顶层依赖，而这些顶层依赖的依赖则定义为第二层依赖，以此类推，有第三、第四层依赖。当这些依赖经过Maven解析之后，就会构成一个<strong>依赖树</strong>，通过这颗依赖树，就能够很清楚地看到某个依赖是通过哪条路径引入的。 </p>
<p>查看项目的依赖树：<code>mvn dependency:tree</code> </p>
<h1 id="仓库"><a href="#仓库" class="headerlink" title="仓库"></a>仓库</h1><h2 id="何为Maven仓库"><a href="#何为Maven仓库" class="headerlink" title="何为Maven仓库"></a>何为Maven仓库</h2><p>Maven可以在某个位置统一存储所有Maven项目共享的构件，这个统一的位置就是仓库。</p>
<p>为了实现重用，项目构建完毕后生成的构件也可以安装或者部署到仓库中，供其他项目使用。</p>
<h2 id="仓库的布局"><a href="#仓库的布局" class="headerlink" title="仓库的布局"></a>仓库的布局</h2><p>任何一个构件都有其唯一的坐标，根据这个坐标可以定义其在仓库中的唯一存储路径，这便是Maven的仓库布局方式。</p>
<p>路径与坐标的大致对应关系为： <code>groupId/artifactId/version/artifactId-version.packaging</code> 。</p>
<h2 id="仓库的分类"><a href="#仓库的分类" class="headerlink" title="仓库的分类"></a>仓库的分类</h2><p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191113171532464.png" alt="image-20191113171532464"></p>
<h3 id="中央仓库"><a href="#中央仓库" class="headerlink" title="中央仓库"></a>中央仓库</h3><p>​		Maven内置了一个中央仓库的地址： <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/">https://repo.maven.apache.org/maven2/</a> </p>
<h3 id="私服"><a href="#私服" class="headerlink" title="私服"></a>私服</h3><p>​		私服是一种特殊的远程仓库，它是架设在局域网内的仓库服务，私服代理广域网上的远程仓库，供局域网内的Maven用户使用。</p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>​		<font color="red">节省组织的外网带宽：</font>消除重复构件的下载，降低外网带宽的压力。</p>
<p>​		<font color="red">加速Maven构建：</font>Maven的一些内部机制（如快照更新检查）要求Maven在执行构建的时候不停地检查远程仓库数据。</p>
<p>​		<font color="red">部署第三方构件：</font>将一些有版权的构件（如Oracle的JDBC驱动）和组织内部生成的私有构件部署到是私服，供内部的Maven项目使用。</p>
<p>​		<font color="red">提高稳定性，增强控制：</font>在私服中缓存大量构件，即使没有Internet连接，Maven也可以正常运行。一些私服软件（如Nexus）还提供了很多额外的功能，如权限管理、RELEASE&#x2F;SNAPSHOT分区等，管理员可以对仓库进行一些更高级的控制。</p>
<p>​		<font color="red">降低中央仓库的负荷：</font>一个公司一个私服对中央仓库只有一次下载，开发人员们的下载只发生在内网。</p>
<h4 id="私服软件"><a href="#私服软件" class="headerlink" title="私服软件"></a>私服软件</h4><p>​		建立私服是用好Maven十分关键的一步，应学会使用<font color="red"><strong>最流行的Maven私服软件——Nexus</strong></font>。</p>
<h2 id="远程仓库的配置"><a href="#远程仓库的配置" class="headerlink" title="远程仓库的配置"></a>远程仓库的配置</h2><p>项目需要的构件存在于另外一个远程仓库，如Jboss Maven仓库，这时默认的中央仓库无法满足项目的需求。可在POM中配置该仓库。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置远程仓库 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>jboss<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>JBoss Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://repository.jboss.com/maven2/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">            <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>daily<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">checksumPolicy</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">checksumPolicy</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>daily<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">checksumPolicy</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">checksumPolicy</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置远程仓库，认证信息配置在settings.xml文件中（可选择配置） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span> <span class="comment">&lt;!-- 仓库声明的唯一id，中央仓库使用的id为central --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Demo Release Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span> <span class="comment">&lt;!-- 仓库的名称，为了方便人阅读，无其他作用 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.3.206:8081/nexus/content/repositories/<span class="tag">&lt;/<span class="name">url</span>&gt;</span> <span class="comment">&lt;!-- 仓库的地址 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">releases</span>&gt;</span> <span class="comment">&lt;!-- 控制Maven对于发布版构件的下载 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span> <span class="comment">&lt;!-- 开启nexus-releases仓库的发布版本下载支持 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>daily<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span> <span class="comment">&lt;!-- 检查更新的频率，默认值是daily，表示Maven每天检查一次 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">checksumPolicy</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">checksumPolicy</span>&gt;</span> <span class="comment">&lt;!-- 配置Maven检查校验和文件的策略 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span> <span class="comment">&lt;!-- 控制Maven对于快照版构件的下载 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span> <span class="comment">&lt;!-- 关闭nexus-releases仓库的快照版本下载支持 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>daily<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">checksumPolicy</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">checksumPolicy</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span> <span class="comment">&lt;!-- 仓库的布局是Maven2及Maven3的默认布局 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><font color="red">repository：</font>在repositories元素下，可以使用repository子元素声明一个或者多个远程仓库。</p>
<p><font color="red">id：</font>仓库声明的唯一id，尤其需要注意的是，Maven自带的<font color="red">中央仓库使用的id为central</font>，如果其他仓库声明也使用该id，就会覆盖中央仓库的配置。</p>
<p><font color="red">name：</font>仓库的名称，为了方便人阅读，无其他作用。</p>
<p><font color="red">url：</font>指向了仓库的地址，一般来说，该地址都基于http协议，Maven用户都可以在浏览器中打开仓库地址浏览构件。</p>
<p><font color="red">releases、snapshots：</font></p>
<p>​		用来控制Maven对于发布版构件和快照版构件的下载。需要注意的是enabled子元素，该例中releases的enabled值为true，表示开启JBoss仓库的发布版本下载支持，而snapshots的enabled值为false，表示关闭JBoss仓库的快照版本下载支持。根据该配置，Maven只会从JBoss仓库下载发布版的构件，而不会下载快照版的构件。</p>
<p>​		除了enabled，它们还包含另外两个子元素 <strong>updatePolicy</strong> 和 <strong>checksumPolicy</strong> 。</p>
<p>​		updatePolicy：配置Maven从远处仓库检查更新的频率，默认值是daily，表示Maven每天检查一次。其他可用的值包括：never-从不检查更新；always-每次构建都检查更新；interval：X-每隔X分钟检查一次更新（X为任意整数）。</p>
<p>​		checksumPolicy：配置Maven检查校验和文件的策略。当构建被部署到Maven仓库中时，会同时部署对应的检验和文件。在下载构件的时候，Maven会验证校验和文件，如果校验和验证失败，当checksumPolicy的值为默认的warn时，Maven会在执行构建时输出警告信息，其他可用的值包括：fail-Maven遇到校验和错误就让构建失败；ignore-使Maven完全忽略校验和错误。</p>
<p><font color="red">layout：</font>元素值default表示仓库的布局是Maven2及Maven3的默认布局，而不是Maven1的布局。</p>
<h3 id="远程仓库的认证"><a href="#远程仓库的认证" class="headerlink" title="远程仓库的认证"></a>远程仓库的认证</h3><p>​		大部分公共的远程仓库无须认证就可以直接访问，但我们在平时的开发中往往会架设自己的Maven远程仓库，出于安全方面的考虑，我们需要提供认证信息才能访问这样的远程仓库。配置认证信息和配置远程仓库不同，<font color="red">远程仓库</font>可以直接在<font color="red">pom.xml中配置</font>，但是<font color="red">认证信息</font>必须<font color="red">配置在settings.xml文件中</font>。这是<font color="red">因为</font>pom往往是被提交到代码仓库中供所有成员访问的，而settings.xml一般只存在于本机。因此，在settings.xml中配置认证信息更为安全。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">&lt;!-- 可以配置多个远程仓库的认证信息 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span>	<span class="comment">&lt;!-- id必须与pom.xml中需要认证的repository元素的id完全一致，正是这个id将认证信息与仓库配置联系在一起。 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span>	<span class="comment">&lt;!-- 认证用户名 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">password</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">password</span>&gt;</span>	<span class="comment">&lt;!-- 认证密码 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servers</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="部署构件至远程仓库"><a href="#部署构件至远程仓库" class="headerlink" title="部署构件至远程仓库"></a>部署构件至远程仓库</h3><p>​		私服的一大作用是部署第三方构件，包括组织内部生成的构件以及一些无法从外部仓库直接获取的构件（一些有版权的构件），这些构件都需要部署到仓库中，供其他团队成员使用。</p>
<p>​		Maven除了能对项目进行编译、测试、打包之外，还能将项目生成的构件部署到远程仓库中。首先，需要编辑项目的 <code>pom.xml</code> 文件。配置 <code>distributionManagement</code> 元素，代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">repository</span>&gt;</span>			<span class="comment">&lt;!-- 发布版本（稳定版）构件的仓库 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span>	<span class="comment">&lt;!-- 远程仓库的唯一标识 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">name</span>&gt;</span>Demo Release Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span>		<span class="comment">&lt;!-- 为了方便人阅读 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.3.206:8081/nexus/content/repositories/releases<span class="tag">&lt;/<span class="name">url</span>&gt;</span>		<span class="comment">&lt;!-- 该仓库地址 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">snapshotRepository</span>&gt;</span>	<span class="comment">&lt;!-- 快照版本（开发测试版）的仓库 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">name</span>&gt;</span>Demo Snapshot Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.3.206:8081/nexus/content/repositories/snapshots<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​		往远程仓库部署构件的时候，往往需要认证，不论从远程仓库下载构件，还是部署构件至远程仓库，配置认证的方式是一样的。</p>
<p>​		配置正确后，运行命令<strong>mvn clean deploy</strong>，Maven就会将项目构建输出的构件部署到配置对应的远程仓库，<strong>如果</strong>项目当前的版本是快照版本，则部署到快照版本仓库地址，否则就部署到发布版本仓库地址。即除了快照版本，其他都部署到发布版本。</p>
<p>​		<font color="red"><strong>发布版和快照版可以是同一个仓库地址吗？</strong></font></p>
<h2 id="快照版本"><a href="#快照版本" class="headerlink" title="快照版本"></a>快照版本</h2><p>Maven为什么要区分发布版和快照版？</p>
<p>​		分模块开发时，模块之间会有依赖关系，快照版本在发布到私服的过程中，Maven会自动为构件打上时间戳。比如模块A的版本设定为2.1-SNAPSHOT，打上时间戳后：2.1-20180901.083052-15，表示2018年9月1日8点30分52秒的第15次快照。当构建依赖于模块B的模块A时，Maven会自动从仓库中检查模块B的2.1-SNAPSHOT版本的最新构件，有更新便下载。</p>
<h2 id="从仓库解析依赖的机制"><a href="#从仓库解析依赖的机制" class="headerlink" title="从仓库解析依赖的机制"></a>从仓库解析依赖的机制</h2><p>Maven是根据怎样的规则从仓库解析并使用依赖构件的呢？</p>
<p>​		当本地没有依赖构件时，Maven会自动从远程仓库下载；当依赖版本为快照版本时，Maven会自动找到最新的快照。</p>
<p>依赖解析机制概括如下：</p>
<p>​		A、依赖范围是system时，Maven直接从本地文件系统解析构件。</p>
<p>​		B、根据依赖坐标计算仓库路径，尝试从本地仓库寻找构件，若发现相应构件，则解析成功。</p>
<p>​		C、本地仓库未找到：</p>
<p>​				a.依赖版本是显式的发布版本构件，如1.2、5.1-beta-1等，则遍历所有的远程仓库，若发现，则下载并解析使用。</p>
<p>​				b.依赖版本是RELEASE或者LATEST，则基于更新策略读取所有远程仓库的元数据（路径格式： <code>groupId/artifactId/maven-metadata.xml</code> ），将其与本地仓库的对应元数据合并后，计算出RELEASE或者LATEST的真实值，然后基于这个真实的值检查本地和远程仓库。</p>
<p>​				c.依赖版本是SNAPSHOT，则基于更新策略读取所有远程仓库的元数据（路径格式：groupId&#x2F;artifactId&#x2F;maven-metadata.xml），将其与本地仓库的对应元数据合并后，得到最新快照版本的值，然后基于该值检查本地仓库，或从远程仓库下载。</p>
<p><font color="blue"><strong>RELEASE</strong></font>、<font color="blue"><strong>LATEST</strong></font>和<font color="blue"><strong>SNAPSHOT</strong></font>版本分别对应了仓库中存在的该构件的<font color="red">最新</font><font color="blue">发布版本</font>、<font color="red">最新</font><font color="blue">版本</font>（包含快照）和<font color="red">最新</font><font color="blue">快照版本</font>，这个“最新”是基于 <code>groupId/artifactId/maven-metadata.xml</code> 计算出来的，该文件内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">metadata</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.company.project<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">versioning</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">latest</span>&gt;</span>1.4.2-SNAPSHOT<span class="tag">&lt;/<span class="name">latest</span>&gt;</span>	<span class="comment">&lt;!-- 指向最新版本，可能是快照版本，前提是快照版和发布版使用同一个仓库 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">release</span>&gt;</span>1.4.0<span class="tag">&lt;/<span class="name">release</span>&gt;</span>			<span class="comment">&lt;!-- 指向最新发布版本 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">versions</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span>				<span class="comment">&lt;!-- 最新发布版本 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span>	<span class="comment">&lt;!-- 最新版本 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">versions</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">lastUpdated</span>&gt;</span>20180901153025<span class="tag">&lt;/<span class="name">lastUpdated</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">versioning</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">metadata</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>以下是快照版本仓库 <code>groupId/artifactId/maven-metadata.xml</code> 文件内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">metadata</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.company.project<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">versioning</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">latest</span>&gt;</span>1.3.1-SNAPSHOT<span class="tag">&lt;/<span class="name">latest</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">versions</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1.2-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">versions</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">lastUpdated</span>&gt;</span>20180901153025<span class="tag">&lt;/<span class="name">lastUpdated</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">versioning</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">metadata</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>依赖版本可如下配置：</p>
<p>​		Maven3不再支持在插件配置中使用LATEST和RELEASE，如果不设置插件版本，其效果和RELEASE一样。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">springframework.version</span>&gt;</span>4.3.18.RELEASE<span class="tag">&lt;/<span class="name">springframework.version</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- &lt;springframework.version&gt;RELEASE&lt;/springframework.version&gt; --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- &lt;springframework.version&gt;LATEST&lt;/springframework.version&gt; --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- &lt;springframework.version&gt;SNAPSHOT&lt;/springframework.version&gt; --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;springframework.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h2><p>​		如果仓库X可以提供仓库Y存储的所有内容，那么X就是Y的一个镜像。任何一个可以从仓库Y获得的构件，都能够从它的镜像中获取。</p>
<p>​		例如 <a target="_blank" rel="noopener" href="http://maven.net.cn/content/groups/public/">http://maven.net.cn/content/groups/public/</a> 是中央仓库 <a target="_blank" rel="noopener" href="http://repo1.maven.org/maven2/">http://repo1.maven.org/maven2/</a> 在中国的镜像，该镜像往往能够提供比中央仓库更快的服务。因此，可以配置Maven使用该镜像来代替中央仓库。编辑setting.xml：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span>&gt;</span>maven.net.cn<span class="tag">&lt;/<span class="name">id</span>&gt;</span>  <span class="comment">&lt;!-- 仓库的唯一标识符 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>  <span class="comment">&lt;!-- 配置为中央仓库的镜像，任何对中央仓库的请求都会转至该镜像 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>one of the central mirrors in China<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.net.cn/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​		关于<font color="red">镜像</font>更<font color="red">常见的用法是结合私服</font>。私服代理所有外部的公共仓库（包括中央仓库），组织内部的Maven用户使用一个私服地址就可以，这样就将配置集中到私服，从而简化Maven本身的配置。<font color="red">私服就是所有仓库的镜像</font>。可以在setting.xml中配置这样一个镜像：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span>&gt;</span>internal-repository<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">name</span>&gt;</span>Internal Repository Manager<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.3.206/maven2/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span> <span class="comment">&lt;!-- 配置为所有Maven仓库的镜像，任何对远程仓库的请求都会被转至此url --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​		如果该镜像仓库需要认证，则配置一个id为internal-repository的<server>即可，详情见 <strong>远程仓库的认证</strong>。</server></p>
<p>Maven的镜像配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>               <span class="comment">&lt;!-- 匹配所有远程仓库 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>external:*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>      <span class="comment">&lt;!-- 匹配所有不在本机上的远程仓库 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>repo1,repo2<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>     <span class="comment">&lt;!-- 匹配多个远程仓库 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*,!repo1<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>        <span class="comment">&lt;!-- 匹配除 repo1 外的所有远程仓库 --&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="仓库搜索服务"><a href="#仓库搜索服务" class="headerlink" title="仓库搜索服务"></a>仓库搜索服务</h2><p>​		使用maven进行日常开发的时候，一个常见问题就是如何寻找需要的依赖，我们可能只知道需要使用类库的项目名称，但是添加maven依赖要求提供确切的maven坐标，这时就可以使用仓库搜索服务来根据关键字得到maven坐标。</p>
<p>​		在中央仓库搜索： <a target="_blank" rel="noopener" href="https://mvnrepository.com/">https://mvnrepository.com/</a> 。</p>
<p>​		在最流行的Maven私服软件Nexus中搜索。</p>
<h1 id="生命周期和插件"><a href="#生命周期和插件" class="headerlink" title="生命周期和插件"></a>生命周期和插件</h1><p>​		<font color="red">Maven的生命周期是抽象的，其实际行为都由插件来完成，</font>如package阶段的任务可能就会由maven-jar-plugin完成。生命周期和插件两者协同工作，密不可分。</p>
<h2 id="何为生命周期"><a href="#何为生命周期" class="headerlink" title="何为生命周期"></a>何为生命周期</h2><p>​		项目构建的生命周期一直存在。Mavne出现之前，公司和公司间、项目和项目间，往往使用不同的方式做类似的工作。Maven的生命周期就是为了对所有的构建过程进行抽象和统一，这个生命周期包含了项目的清理、初始化、编译、测试、打包、集成测试、验证、部署和站点生成等几乎所有构建步骤。几乎所有项目的构建，都能映射到这样一个生命周期上。</p>
<p>​		Maven的生命周期是抽象的，这意味着生命周期本身不做任何实际的工作，实际的任务都交有插件来完成。这种思想与设计模式中的模板方法非常相似。如下的模板方法抽象类能够很好地体现Maven生命周期的概念：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractBuild</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">build</span><span class="params">()</span> &#123;</span><br><span class="line">		initialize();</span><br><span class="line">		compile();</span><br><span class="line">		test();</span><br><span class="line">		packagee();</span><br><span class="line">		integrationTest();</span><br><span class="line">		deploy();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">()</span>;</span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">compile</span><span class="params">()</span>;</span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>;</span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">packagee</span><span class="params">()</span>;</span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">integrationTest</span><span class="params">()</span>;</span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">deploy</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​		上述代码和Maven实际代码相差甚远，Maven的生命周期包含更多的步骤和更复杂的逻辑，但他们的基本理念是相同的。</p>
<p>​		生命周期抽象了构建的各个步骤，定义了它们的次序，但没有提供具体实现。每个构建步骤都可以绑定一个或者多个插件行为，Maven为大多数构建步骤编写并绑定了默认插件。用户几乎不会察觉到插件的存在，但实际上编译是由maven-compiler-plugin完成的，而测试是由maven-surefire-plugin完成的。当用户有特殊需要时，可以配置插件定制构建行为，甚至自己编写插件。</p>
<p>​		Maven定义的生命周期和插件机制一方面保证了所有Mavne项目有一致的构建标准，另一方面又通过默认插件简化和稳定了实际项目的构建。此外，该机制还提供了足够的扩展空间，用户可以通过配置现有插件或者自行编写插件来自定义构建行为。</p>
<h2 id="生命周期详解"><a href="#生命周期详解" class="headerlink" title="生命周期详解"></a>生命周期详解</h2><h3 id="三套生命周期"><a href="#三套生命周期" class="headerlink" title="三套生命周期"></a>三套生命周期</h3><p><font color="red">三套项目独立的生命周期：</font></p>
<p>​		<code>clean</code>         清理项目</p>
<p>​		<code>default</code>      构建项目</p>
<p>​		<code>site</code>            建立项目站点</p>
<p>用户可以仅仅调用 <code>clean</code> 生命周期的某个阶段，而不会对其他生命周期产生任何影响。同理…</p>
<h3 id="clean-生命周期"><a href="#clean-生命周期" class="headerlink" title="clean 生命周期"></a>clean 生命周期</h3><p><strong>阶段</strong></p>
<p>​		<code>pre-clean</code>        执行一些清理前需要完成的工作</p>
<p>​		<code>clean</code>                清理上一次构建生成的文件</p>
<p>​		<code>post-clean</code>      执行一些清理后需要完成的工作</p>
<h3 id="default-生命周期"><a href="#default-生命周期" class="headerlink" title="default 生命周期"></a>default 生命周期</h3><p><strong>阶段</strong></p>
<p>​		<code>validate</code></p>
<p>​		<code>initialize</code></p>
<p>​		<code>generate-sources</code></p>
<p>​		<code>process-sources</code>      处理项目主资源文件。一般来说，是对src&#x2F;main&#x2F;resources目录的内容进行变量替换等工作后，复制到项目输出的主classpath目录中。</p>
<p>​		<code>generate-resources</code></p>
<p>​		<code>process-resources</code></p>
<p>​		<code>compile</code>      编译项目的主源码。一般来说，是编译src&#x2F;main&#x2F;java目录下的Java文件至项目输出的主classpath目录中。</p>
<p>​		<code>process-classes</code></p>
<p>​		<code>generate-test-sources</code></p>
<p>​		<code>process-test-sources</code>      处理项目测试资源文件。一般来说，是对src&#x2F;test&#x2F;resources目录的内容进行变量替换等工作后，复制到项目输出的测试classpath目录中。</p>
<p>​		<code>generate-test-resources</code></p>
<p>​		<code>process-test-resources</code></p>
<p>​		<code>test-compile</code>      编译项目的测试代码。一般来说，是编译src&#x2F;test&#x2F;java目录下的Java文件至项目输出的测试classpath目录中。</p>
<p>​		<code>process-test-classes</code></p>
<p>​		<code>test</code>      使用单元测试框架运行测试，测试代码不会被打包或部署。</p>
<p>​		<code>prepare-package</code></p>
<p>​		<code>package</code>      获取编译后的代码，打包成可发布的格式，如 JAR。</p>
<p>​		<code>pre-integration-test</code></p>
<p>​		<code>integration-test</code></p>
<p>​		<code>post-integration-test</code></p>
<p>​		<code>verify</code></p>
<p>​		<code>install</code>      将包安装到Mavne本地仓库，供本地其他Maven项目使用。</p>
<p>​		<code>deploy</code>     将最终的包复制到远程仓库，供其他开发人员和Maven项目使用。  </p>
<h3 id="site-生命周期"><a href="#site-生命周期" class="headerlink" title="site 生命周期"></a>site 生命周期</h3><p>site生命周期的目的是建立和发布项目站点，Maven能够基于POM所包含的信息，自动生成一个友好的站点，方便团队交流和发布项目信息。</p>
<p><strong>阶段</strong></p>
<p>​		<code>pre-site</code>      执行一些在生成项目站点之前需要完成的工作。</p>
<p>​		<code>site</code>      生成项目站点文档。</p>
<p>​		<code>post-site</code>      执行一些在生成项目站点之后需要完成的工作。</p>
<p>​		<code>site-deploy</code>      将生成的项目站点发布到服务器上。</p>
<h3 id="命令行与生命周期"><a href="#命令行与生命周期" class="headerlink" title="命令行与生命周期"></a>命令行与生命周期</h3><p>​		<font color="blue">命令行执行Maven任务的方式</font>：<font color="red">调用Maven的生命周期阶段</font>。各个生命周期相互独立，一个生命周期的阶段有前后依赖关系。以常见的Maven为例，解释其执行的生命周期阶段：</p>
<p><font color="blue">$mvn clean</font> ：调用clean生命周期的clean阶。实际执行的阶段为clean生命周期的pre-clean和clean阶段。</p>
<p><font color="blue">$mvn test</font> ：调用default生命周期的test阶段。实际执行的阶段为default生命周期的validate、initialize等，直到test的所有阶段。所以在执行测试的时候，项目代码也会被编译。</p>
<p><font color="blue">$mvn clean install</font> ：调用clean生命周期的clean阶段和default生命周期的install阶段。实际执行的阶段为clean生命周期的pre-clean、clean阶段，以及default生命周期的从validate至install的所有阶段。该命令结合了两个生命周期，在执行真正的项目构建之前清理项目是一个很好的实践。</p>
<p><font color="blue">$mvn clean deploy site-deploy</font> ：推理可知。</p>
<p>​		Maven中主要的生命周期阶段并不多，<font color="red">常用的Maven命令都是基于这些阶段简单组合而成</font>，因此对Maven生命周期有一个基本的理解，就可以正确而熟练地使用Maven命令。</p>
<h2 id="插件目标"><a href="#插件目标" class="headerlink" title="插件目标"></a>插件目标</h2><p>​		为每一个功能（即任务）编写一个独立的插件是不可取的，因为有些功能（即任务）之间有可复用的代码。</p>
<p>​		将一些功能（即任务）聚集在一个插件里（为了复用代码），每个<font color="blue">功能</font>（即任务）<font color="blue">就是</font>一个<font color="blue">插件目标</font>。</p>
<p>帮助理解：</p>
<p>​		<strong>一个类（插件）有很多方法（功能），每个方法看作一个插件目标。</strong></p>
<p>​		<strong>一个 jar 包（插件）有很多类（功能），每个类看作一个插件目标。</strong></p>
<p>使用示例：</p>
<p>​		maven-dependency-plugin插件</p>
<p>​				dependency:analyze 分析项目依赖，找出潜在的无用依赖。</p>
<p>​				dependency:tree 列出项目的依赖树，分析依赖来源。</p>
<p>​				dependency:list 列出项目所有已解析的依赖。</p>
<p>​		maven-compiler-plugin插件</p>
<p>​				compiler:compile</p>
<p>通用写法</p>
<p>​		<font color="blue">冒号前：插件前缀</font>（可看作类名或 jar 包名）</p>
<p>​		<font color="blue">冒号后：插件的目标</font>（可看作方法名或类名）。</p>
<h2 id="插件绑定"><a href="#插件绑定" class="headerlink" title="插件绑定"></a>插件绑定</h2><p>​		Maven的<font color="blue">生命周期与插件相互绑定</font>，用以完成实际的构建任务。（实质：生命周期的某个<font color="red">阶段</font>与插件的某个<font color="red">目标</font>相互<font color="red">绑定</font>，以完成某个具体的构建任务）。</p>
<p>​		例如：项目编译，它对应default生命周期的compile阶段，而maven-compiler-plugin插件的compile目标能完成该任务。因此，将它们绑定，就能实现项目编译的目的，如图：</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191122171508378.png" alt="image-20191122171508378"></p>
<h3 id="内置绑定"><a href="#内置绑定" class="headerlink" title="内置绑定"></a>内置绑定</h3><p>​		Maven在核心已经为一些主要的生命周期<font color="red">阶段绑定</font>了插件<font color="red">目标</font>，当用户通过命令行调用生命周期阶段时，对应的插件目标就会执行相应的任务，从命令行输出中可看到项目构建过程执行了哪些插件目标。</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191122172423340.png" alt="image-20191122172423340"></p>
<p>​		<font color="red">default生命周期还有很多其他阶段，默认它们没有绑定任何插件，因此也没有任何实际行为。</font></p>
<p>​		default生命周期的阶段与插件目标的绑定关系由项目<font color="red">打包类型</font>决定。jar 打成 JAR 包，war 打成 WAR 包。</p>
<p>例如执行 mvn clean install ：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">[INFO] Scanning <span class="keyword">for</span> projects...</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Building Maven hello maven project 1.0-SNAPSHOT</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ hello-maven ---</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ hello-mave</span><br><span class="line">n ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\main\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ hello-maven ---</span><br><span class="line"></span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\classes</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ he</span><br><span class="line">llo-maven ---</span><br><span class="line">[INFO] Using <span class="string">&#x27;UTF-8&#x27;</span> encoding to copy filtered resources.</span><br><span class="line">[INFO] skip non existing resourceDirectory F:\hello-maven\src\<span class="built_in">test</span>\resources</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ hello-m</span><br><span class="line">aven ---</span><br><span class="line">[INFO] Changes detected - recompiling the module!</span><br><span class="line">[INFO] Compiling 1 <span class="built_in">source</span> file to F:\hello-maven\target\test-classes</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-surefire-plugin:2.12.4:<span class="built_in">test</span> (default-test) @ hello-maven ---</span><br><span class="line">[INFO] Surefire report directory: F:\hello-maven\target\surefire-reports</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line"> T E S T S</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">Running com.zhaolq.hellomaven.HelloMavenTest</span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.048 sec</span><br><span class="line"></span><br><span class="line">Results :</span><br><span class="line"></span><br><span class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</span><br><span class="line"></span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ hello-maven ---</span><br><span class="line">[INFO] Building jar: F:\hello-maven\target\hello-maven-1.0-SNAPSHOT.jar</span><br><span class="line">[INFO]</span><br><span class="line">[INFO] --- maven-install-plugin:2.4:install (default-install) @ hello-maven ---</span><br><span class="line">[INFO] Installing F:\hello-maven\target\hello-maven-1.0-SNAPSHOT.jar to F:\Tools</span><br><span class="line">\Maven-3.5.2-LocalRepository\3.5.2\repository\com\zhaolq\hello-maven\1.0-SNAPS</span><br><span class="line">HOT\hello-maven-1.0-SNAPSHOT.jar</span><br><span class="line">[INFO] Installing F:\hello-maven\pom.xml to F:\Tools\Maven-3.5.2-LocalRepository</span><br><span class="line">\3.5.2\repository\com\zhaolq\hello-maven\1.0-SNAPSHOT\hello-maven-1.0-SNAPSHOT</span><br><span class="line">.pom</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="keyword">time</span>: 1.584 s</span><br><span class="line">[INFO] Finished at: 2018-03-23T11:59:18+08:00</span><br><span class="line">[INFO] Final Memory: 13M/32M</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<h3 id="自定义绑定（创建源码jar）"><a href="#自定义绑定（创建源码jar）" class="headerlink" title="自定义绑定（创建源码jar）"></a>自定义绑定（创建源码jar）</h3><p>​		自己选择将某个插件目标绑定到生命周期的某个阶段上。</p>
<p>例子：创建项目的<font color="blue">源码jar包</font>。</p>
<p>​		内置的插件绑定关系中并没有涉及该任务，因此需要用户自行配置。</p>
<p>​		<font color="blue">maven-source-plugin</font> 插件的 <font color="blue">jar-no-fork</font> 目标能够将项目的主代码打包成 jar 文件，将其绑定到 default 生命周期的 verify 阶段上，在 package（创建项目jar包）后和 install（安装构件）前创建源码 jar 包。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">plugin</span>&gt;</span> <span class="comment">&lt;!-- 声明插件的使用 --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-source-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">execution</span>&gt;</span> <span class="comment">&lt;!-- 配置执行一个任务 --&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">id</span>&gt;</span>attach-sources<span class="tag">&lt;/<span class="name">id</span>&gt;</span> <span class="comment">&lt;!-- 任务的唯一标识符 --&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">phase</span>&gt;</span>verify<span class="tag">&lt;/<span class="name">phase</span>&gt;</span> <span class="comment">&lt;!-- 绑定到 verify 生命周期阶段 --&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">goal</span>&gt;</span>jar-no-fork<span class="tag">&lt;/<span class="name">goal</span>&gt;</span> <span class="comment">&lt;!-- 要执行的插件目标 --&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>自定义插件绑定完成，运行 <strong>mvn verify</strong> 。有如下输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[INFO] --- maven-source-plugin:2.2.1:jar-no-fork (attach-sources) @ project-util ---</span><br><span class="line">[INFO] Building jar: E:\WorkspacesOxygen\MavenProjectSpace\project\project-util\target\project-util-0.0.1-sources.jar</span><br></pre></td></tr></table></figure>

<p>可以看到，<code>maven-source-plugin:jar-no-fork</code> 会创建一个以 <code>–sources.jar</code> 结尾的源码文件包。</p>
<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191122173657306.png" alt="image-20191122173657306"></p>
<p>不通过phase元素配置生命周期阶段，插件目标也能绑定到生命周期中。有很多插件的目标在编写时已经定义了默认的绑定阶段。可以使用 <code>maven-help-plugin</code> 查看插件详情信息，了解插件目标的默认绑定阶段。命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mvn <span class="built_in">help</span>:describe -Dplugin=org.apache.maven.plugins:maven-source-plugin:2.2.1 -Ddetail</span><br></pre></td></tr></table></figure>

<p><img src="/article/2019/07/Maven%E5%AE%9E%E6%88%98/image-20191122173745609.png" alt="image-20191122173745609"></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="zhaolq 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="zhaolq 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Maven/" rel="tag"># Maven</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/article/2019/07/curl%E3%80%81wget%E3%80%81ab/" rel="prev" title="curl、wget、ab">
                  <i class="fa fa-angle-left"></i> curl、wget、ab
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/article/2019/07/Eclipse%E4%B8%AD%E4%BB%8Esvn%E4%B8%AD%E6%A3%80%E5%87%BAmaven%E9%A1%B9%E7%9B%AE/" rel="next" title="Eclipse中从svn中检出maven项目">
                  Eclipse中从svn中检出maven项目 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">zhaolq</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
