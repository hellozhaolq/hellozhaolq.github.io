<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.zhaolq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"androidstudio","dark":"androidstudio"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":true,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="百科：   公开密钥加密 - 维基百科   RSA加密算法 - 维基百科   公开密钥指纹 - 维基百科  RSA 非对称加密算法，公钥加密-&gt;私钥解密、私钥加密(签名)-&gt;公钥解密(验签)。 RSA 非对称加密算法，被加密的数据长度，需要短于密钥长度，否则会加密失败。RSA 分段加密。">
<meta property="og:type" content="article">
<meta property="og:title" content="公私钥和证书的生成与管理">
<meta property="og:url" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="洋蔥">
<meta property="og:description" content="百科：   公开密钥加密 - 维基百科   RSA加密算法 - 维基百科   公开密钥指纹 - 维基百科  RSA 非对称加密算法，公钥加密-&gt;私钥解密、私钥加密(签名)-&gt;公钥解密(验签)。 RSA 非对称加密算法，被加密的数据长度，需要短于密钥长度，否则会加密失败。RSA 分段加密。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210203100529136.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210203103207726.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210203103214898.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210119113131137.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210205114905816.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20201207180058631.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20201209172045671.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20201208092705620.png">
<meta property="og:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20201208141647141.png">
<meta property="article:published_time" content="2020-12-07T01:15:35.000Z">
<meta property="article:modified_time" content="2020-12-07T01:15:35.000Z">
<meta property="article:author" content="zhaolq">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210203100529136.png">


<link rel="canonical" href="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/","path":"article/2020/12/公私钥和证书的生成与管理/","title":"公私钥和证书的生成与管理"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>公私钥和证书的生成与管理 | 洋蔥</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>



  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">洋蔥</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">贪婪，找不到比这更好的词了，是件好事。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#OpenSSH-ssh-keygen%E7%BB%84%E4%BB%B6"><span class="nav-number">1.</span> <span class="nav-text">OpenSSH (ssh-keygen组件)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%86%E9%92%A5%E5%AF%B9%E7%94%9F%E6%88%90"><span class="nav-number">1.1.</span> <span class="nav-text">密钥对生成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSH%E5%AF%86%E9%92%A5%E6%A0%BC%E5%BC%8F"><span class="nav-number">1.2.</span> <span class="nav-text">SSH密钥格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AC%E9%92%A5%E6%8F%90%E5%8F%96"><span class="nav-number">1.3.</span> <span class="nav-text">公钥提取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AC%E9%92%A5%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.4.</span> <span class="nav-text">公钥转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#windows%E4%B8%8B%E7%9A%84OpenSSH"><span class="nav-number">1.5.</span> <span class="nav-text">windows下的OpenSSH</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">1.6.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OpenSSL"><span class="nav-number">2.</span> <span class="nav-text">OpenSSL</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BopenSSL%E7%89%88%E6%9C%AC"><span class="nav-number">2.1.</span> <span class="nav-text">查看openSSL版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-genpkey"><span class="nav-number">2.2.</span> <span class="nav-text">openssl-genpkey</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-rsa"><span class="nav-number">2.3.</span> <span class="nav-text">openssl-rsa</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-pkey"><span class="nav-number">2.4.</span> <span class="nav-text">openssl-pkey</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-req"><span class="nav-number">2.5.</span> <span class="nav-text">openssl-req</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B9%E8%AF%81%E4%B9%A6"><span class="nav-number">2.5.1.</span> <span class="nav-text">根证书</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6%E6%A0%87%E5%87%86"><span class="nav-number">2.5.2.</span> <span class="nav-text">证书标准</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D"><span class="nav-number">2.5.3.</span> <span class="nav-text">证书文件扩展名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6%E8%8E%B7%E5%8F%96%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7"><span class="nav-number">2.5.4.</span> <span class="nav-text">证书获取及相关工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E6%9D%83%E5%A8%81%E8%AF%81%E4%B9%A6%E9%A2%81%E5%8F%91%E6%9C%BA%E6%9E%84%E7%94%B3%E8%AF%B7%E8%AF%81%E4%B9%A6"><span class="nav-number">2.5.5.</span> <span class="nav-text">向权威证书颁发机构申请证书</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E8%AF%81%E4%B9%A6%E7%AD%BE%E7%BD%B2%E8%AF%B7%E6%B1%82-CSR"><span class="nav-number">2.5.5.1.</span> <span class="nav-text">关于证书签署请求(CSR)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%9F%E6%88%90-CSR"><span class="nav-number">2.5.5.2.</span> <span class="nav-text">生成 CSR</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BE%E4%BE%8B"><span class="nav-number">2.5.6.</span> <span class="nav-text">举例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-x509"><span class="nav-number">2.6.</span> <span class="nav-text">openssl-x509</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-ca"><span class="nav-number">2.7.</span> <span class="nav-text">openssl-ca</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-crl"><span class="nav-number">2.8.</span> <span class="nav-text">openssl-crl</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-verify"><span class="nav-number">2.9.</span> <span class="nav-text">openssl-verify</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-pkcs7"><span class="nav-number">2.10.</span> <span class="nav-text">openssl-pkcs7</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-crl2pkcs7"><span class="nav-number">2.11.</span> <span class="nav-text">openssl-crl2pkcs7</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-pkcs12"><span class="nav-number">2.12.</span> <span class="nav-text">openssl-pkcs12</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-pkeyutl"><span class="nav-number">2.13.</span> <span class="nav-text">openssl-pkeyutl</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl-dgst"><span class="nav-number">2.14.</span> <span class="nav-text">openssl-dgst</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java-Keytool%E5%B7%A5%E5%85%B7%E7%AE%A1%E7%90%86%E8%AF%81%E4%B9%A6"><span class="nav-number">3.</span> <span class="nav-text">Java Keytool工具管理证书</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OpenPGP"><span class="nav-number">4.</span> <span class="nav-text">OpenPGP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GUI"><span class="nav-number">4.1.</span> <span class="nav-text">GUI</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PGP"><span class="nav-number">4.2.</span> <span class="nav-text">PGP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GPG"><span class="nav-number">4.3.</span> <span class="nav-text">GPG</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4"><span class="nav-number">4.3.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%88%98"><span class="nav-number">4.3.2.</span> <span class="nav-text">实战</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD-GnuPG-%E7%9B%AE%E5%BD%95"><span class="nav-number">4.3.3.</span> <span class="nav-text">备份 GnuPG 目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-GPG-%E5%AF%86%E9%92%A5%E8%BF%9B%E8%A1%8C-SSH-%E8%AE%A4%E8%AF%81"><span class="nav-number">4.3.4.</span> <span class="nav-text">使用 GPG 密钥进行 SSH 认证</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PuTTY%E5%B7%A5%E5%85%B7"><span class="nav-number">5.</span> <span class="nav-text">PuTTY工具</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MobaXterm%E5%B7%A5%E5%85%B7"><span class="nav-number">6.</span> <span class="nav-text">MobaXterm工具</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7"><span class="nav-number">7.</span> <span class="nav-text">在线工具</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%BC%E5%BC%8F"><span class="nav-number">8.</span> <span class="nav-text">格式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PEM%E6%A0%BC%E5%BC%8F"><span class="nav-number">8.1.</span> <span class="nav-text">PEM格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PEM%E6%A0%BC%E5%BC%8F-PKCS-1-%E7%BB%93%E6%9E%84%E6%A0%87%E5%87%86-%E8%80%81"><span class="nav-number">8.2.</span> <span class="nav-text">PEM格式 PKCS#1 结构标准-老</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PEM%E6%A0%BC%E5%BC%8F-PKCS-8-%E7%BB%93%E6%9E%84%E6%A0%87%E5%87%86-%E6%96%B0"><span class="nav-number">8.3.</span> <span class="nav-text">PEM格式 PKCS#8 结构标准-新</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenSSH%E5%85%AC%E9%92%A5"><span class="nav-number">8.4.</span> <span class="nav-text">OpenSSH公钥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSH2%E5%85%AC%E9%92%A5"><span class="nav-number">8.5.</span> <span class="nav-text">SSH2公钥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DER%E6%A0%BC%E5%BC%8F"><span class="nav-number">8.6.</span> <span class="nav-text">DER格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P7B-PKCS-7%E6%96%87%E4%BB%B6-PEM"><span class="nav-number">8.7.</span> <span class="nav-text">P7B&#x2F;PKCS#7文件 (PEM)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PFX-PKCS-12%E6%96%87%E4%BB%B6-PEM"><span class="nav-number">8.8.</span> <span class="nav-text">PFX&#x2F;PKCS#12文件 (PEM)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="nav-number">9.</span> <span class="nav-text">格式转换</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PKCS-1%E4%B8%8EPKCS-8%E8%BD%AC%E6%8D%A2"><span class="nav-number">9.1.</span> <span class="nav-text">PKCS#1与PKCS#8转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSH2%E5%85%AC%E9%92%A5%E4%B8%8EOpenSSH%E5%85%AC%E9%92%A5%E8%BD%AC%E6%8D%A2"><span class="nav-number">9.2.</span> <span class="nav-text">SSH2公钥与OpenSSH公钥转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ppk%E4%B8%8Epem-PKCS-1-%E8%BD%AC%E6%8D%A2"><span class="nav-number">9.3.</span> <span class="nav-text">ppk与pem(PKCS#1)转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PEM%E8%BD%ACDER"><span class="nav-number">9.4.</span> <span class="nav-text">PEM转DER</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DER%E8%BD%ACPEM"><span class="nav-number">9.5.</span> <span class="nav-text">DER转PEM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PEM%E8%AF%81%E4%B9%A6%E6%A0%BC%E5%BC%8F%E8%BD%ACP7B"><span class="nav-number">9.6.</span> <span class="nav-text">PEM证书格式转P7B</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P7B%E8%AF%81%E4%B9%A6%E6%A0%BC%E5%BC%8F%E8%BD%ACPEM"><span class="nav-number">9.7.</span> <span class="nav-text">P7B证书格式转PEM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PEM%E8%AF%81%E4%B9%A6%E6%A0%BC%E5%BC%8F%E8%BD%ACPFX"><span class="nav-number">9.8.</span> <span class="nav-text">PEM证书格式转PFX</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PFX%E8%AF%81%E4%B9%A6%E6%A0%BC%E5%BC%8F%E8%BD%ACPEM"><span class="nav-number">9.9.</span> <span class="nav-text">PFX证书格式转PEM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P7B%E8%AF%81%E4%B9%A6%E6%A0%BC%E5%BC%8F%E8%BD%ACPFX-%E5%85%88%E8%BD%AC%E6%88%90PEM"><span class="nav-number">9.10.</span> <span class="nav-text">P7B证书格式转PFX (先转成PEM)</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhaolq"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">zhaolq</p>
  <div class="site-description" itemprop="description">有用、有趣、有情义！</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">554</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hellozhaolq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hellozhaolq" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hello.zhaolq@qq.com" title="E-Mail → mailto:hello.zhaolq@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaolq.com/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zhaolq">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洋蔥">
      <meta itemprop="description" content="有用、有趣、有情义！">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="公私钥和证书的生成与管理 | 洋蔥">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          公私钥和证书的生成与管理
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-07 09:15:35" itemprop="dateCreated datePublished" datetime="2020-12-07T09:15:35+08:00">2020-12-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><font color="blue"><strong>百科：</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86">公开密钥加密 - 维基百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95">RSA加密算法 - 维基百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E6%8C%87%E7%BA%B9">公开密钥指纹 - 维基百科</a> </p>
<p>RSA 非对称加密算法，公钥加密-&gt;私钥解密、私钥加密(签名)-&gt;公钥解密(验签)。</p>
<p>RSA 非对称加密算法，被加密的数据长度，需要短于密钥长度，否则会加密失败。<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000011263680">RSA 分段加密</a>。</p>
<span id="more"></span>

<p><font color="blue"><strong>推荐链接：</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/pixy/p/4722381.html">密钥、证书生成和管理总结</a> </p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/xiangguiwang/article/details/76400805">DER、CRT、CER、PEM格式的证书及转换</a> </p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/kimylrong/article/details/43525333">OpenSSL与KeyStore指令小集</a> </p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/jiftlixu/article/details/19836405">JAVA解析各种编码密钥对（DER、PEM、openssh公钥）</a> </p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/zhymax/article/details/7683925">使用openssl命令剖析RSA私钥文件格式</a> </p>
<p>在线工具：</p>
<p> <a target="_blank" rel="noopener" href="https://www.ssleye.com/">https://www.ssleye.com/</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.getssl.cn/ssltools">https://www.getssl.cn/ssltools</a> </p>
<p> <a target="_blank" rel="noopener" href="https://csr.chinassl.net/">https://csr.chinassl.net/</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.chinassl.net/ssltools/">https://www.chinassl.net/ssltools/</a> </p>
<h1 id="OpenSSH-ssh-keygen组件"><a href="#OpenSSH-ssh-keygen组件" class="headerlink" title="OpenSSH (ssh-keygen组件)"></a>OpenSSH (ssh-keygen组件)</h1><p> <strong><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Secure_Shell">Secure Shell</a></strong>（安全外壳协议，简称<strong>SSH</strong>）是一种加密的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE">网络传输协议</a>，可在不安全的网络中为网络服务提供安全的传输环境。不过，SSH也被指出有被嗅探甚至解密的漏洞 (详见百科)，<a target="_blank" rel="noopener" href="https://github.com/Ganapati/RsaCtfTool">RSA多重攻击工具：从弱公钥中解密数据并尝试恢复私钥</a>。 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Secure_Shell#SSH%E7%9A%84%E5%AE%89%E5%85%A8%E9%AA%8C%E8%AF%81">SSH的安全验证</a> 。</p>
<p> <strong><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/OpenSSH">OpenSSH</a></strong>（<strong>OpenBSD Secure Shell</strong>）是使用<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/SSH">SSH</a>透过<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%A8%88%E7%AE%97%E6%A9%9F%E7%B6%B2%E7%B5%A1">计算机网络</a>加密通信的实现，带有多个命令行工具 (详见百科)。其中的 <strong><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Ssh-keygen">ssh-keygen</a></strong> 是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/UNIX">Unix</a>和类Unix计算机系统上的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Secure_Shell">安全外壳</a>（SSH）协议套件的标准组件，用于通过使用各种 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%AD%A6">加密技术</a> <font color="blue">在不安全的网络上建立远程计算机之间的安全shell会话</font>。ssh-keygen 实用程序用于生成、管理和转换身份验证密钥。这些密钥与相关工具<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/GnuPG">GnuPG</a>使用的密钥不同。ssh-keygen <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Ssh-keygen#%E6%94%AF%E6%8C%81%E7%9A%84%E5%AF%86%E9%92%A5%E6%A0%BC%E5%BC%8F">支持的算法</a> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95">RSA</a>、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95">DSA</a>、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/ECDSA">ECDSA</a> 等。</p>
<p>如何使用ssh-keygen生成新的SSH密钥？请参考官方：<a target="_blank" rel="noopener" href="https://www.openssh.com/manual.html">https://www.openssh.com/manual.html</a></p>
<p>旧版选项：</p>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">-b &lt;bits&gt;</td>
<td align="center">指定要创建的密钥的位数。对于RSA密钥，最小长度为1024位，默认长度为3072位。通常认为3072位已足够。对于ECDSA密钥，-b参数通过选择三种椭圆曲线大小之一来确定密钥长度：256、384或521位。尝试使用这三个值以外的位长度生成ECDSA密钥将导致失败。ECDSA-SK、Ed25519和Ed25519-SK密钥具有固定长度，因此-b参数将被忽略。</td>
</tr>
<tr>
<td align="center">-C &lt;comment&gt;</td>
<td align="center">提供新注释。</td>
</tr>
<tr>
<td align="center">-f &lt;file&gt;</td>
<td align="center">指定用于存储密钥的文件名(全路径名)。</td>
</tr>
<tr>
<td align="center">-e &lt;export&gt;</td>
<td align="center">导出为其它格式的密钥文件，可以转换密钥类型</td>
</tr>
<tr>
<td align="center">-i &lt;input&gt;</td>
<td align="center">从其他格式的密钥文件导入，可以转换密钥类型</td>
</tr>
<tr>
<td align="center">-m &lt;PEM|PKCS8|RFC4716&gt;</td>
<td align="center">与-e,-i,-p配合使用，指明使用的密钥文件格式</td>
</tr>
<tr>
<td align="center">-N &lt;password&gt;</td>
<td align="center">提供新的密码短语。</td>
</tr>
<tr>
<td align="center">-o</td>
<td align="center">使用新的OpenSSH格式。</td>
</tr>
<tr>
<td align="center">-p</td>
<td align="center">请求更改私钥文件的密码短语，而非创建新的私钥。程序将提示用户选择包含私钥的文件，输入旧密码短语，并两次输入新密码短语。</td>
</tr>
<tr>
<td align="center">-P &lt;password&gt;</td>
<td align="center">提供（旧）密码短语。</td>
</tr>
<tr>
<td align="center">-t</td>
<td align="center">指定要创建的密钥类型。可能的值包括“ecdsa”、“ecdsa-sk”、“ed25519（默认值）”、“ed25519-sk”或“rsa”。<br>此标志也可用于指定使用RSA CA密钥签名证书时所需的签名类型。可用的RSA签名变体包括“ssh-rsa”（SHA1签名，不推荐）、“rsa-sha2-256”和“rsa-sha2-512”（RSA密钥的默认值）。</td>
</tr>
<tr>
<td align="center">-y</td>
<td align="center">此选项将读取一个私有的OpenSSH格式文件，并将其中的OpenSSH公钥打印到标准输出（stdout）。</td>
</tr>
</tbody></table>
<h2 id="密钥对生成"><a href="#密钥对生成" class="headerlink" title="密钥对生成"></a>密钥对生成</h2><p>若不指定 <code>-f</code> 参数，默认情况下，用户的 SSH 密钥存储在 <code>~/.ssh</code> 目录下。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">BEGIN OPENSSH PRIVATE KEY</span></span><br><span class="line">ssh-keygen -o -t rsa -f id_rsa1 -b 1024</span><br><span class="line">cat id_rsa1</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAIEAue9G7SelK1fMXX4WRrSS6TAwAYlKJlgHyjAoPDb5MTn6ZAAZ/7U+</span><br><span class="line">KuKSiUfA0JjfUVviTHwq4ojevQSblcrHO1VuhKvAQXgRCt891iCSxQtq4gA9kwZ407eaDr</span><br><span class="line">ObJy2pn8Y6OuBX+mtKka9xhtwnjoxUU5bvYbiWly6PAFIL6q0AAAIgJzsoxSc7KMUAAAAH</span><br><span class="line">c3NoLXJzYQAAAIEAue9G7SelK1fMXX4WRrSS6TAwAYlKJlgHyjAoPDb5MTn6ZAAZ/7U+Ku</span><br><span class="line">KSiUfA0JjfUVviTHwq4ojevQSblcrHO1VuhKvAQXgRCt891iCSxQtq4gA9kwZ407eaDrOb</span><br><span class="line">Jy2pn8Y6OuBX+mtKka9xhtwnjoxUU5bvYbiWly6PAFIL6q0AAAADAQABAAAAgGejmhNCz+</span><br><span class="line">wS6lUKnPwYVvMn6vpQPkaVNvJaWXMG6Wuo94qaC+PecKKS3D8tAarEK2Y8Iy2i4HyY8h7F</span><br><span class="line">3Ltn5hiV1n7hPYwuIX6OszhFuadjNVhDc2tIWJDZdHCx5eUsJH2fcLe5nJ31kS/0upBqBJ</span><br><span class="line">K5SrQUmUX4vKgBsdroo4G5AAAAQQCGCraCsb39K85ZeFL6rUhGNl9DqZ3exQ5SmPz1LndT</span><br><span class="line">dmC1q1TekTXAwwIHMkCooGqjmPwQQQ4a9FFTnjqjDBrzAAAAQQDzsAb5jo3xtUpYQ9aaWo</span><br><span class="line">QRYTB4uEYoLpBthJZNghMA4FgwNdPe1EQtkKuBnrV45al8ft4KI0oJz76Fcx7HQ+Q3AAAA</span><br><span class="line">QQDDVD7g9k5YsmviTjoMSDlfwo12AMn9XUYmAxEAVqvMZsOAOFne6CqrcszIZqY+JoQ9uc</span><br><span class="line">9suCwFCkHq2CbuZz47AAAAKnJvb3RAZ3piaC1kZXYtemhhb2xhbnFpLmJjYy1nemJoLmJh</span><br><span class="line">aWR1LmNvbQ==</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">BEGIN RSA PRIVATE KEY</span></span><br><span class="line">ssh-keygen -t rsa -f id_rsa2 -b 1024 -C &quot;hello@zhaolq.com&quot;</span><br><span class="line">cat id_rsa2</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXQIBAAKBgQCn79fck+7sba2m/8F3gTFJpMjMy1oqNiC1WFAVN/0T1PMpw8mJ</span><br><span class="line">CMgf2JA4endeIlM05GlHSpVsnauEKy/Dgbbf7NFKOH87/6meAKTPdqr5DvT4gsQT</span><br><span class="line">B5RxLTG9dclJ2IZgSYqI2iqKmGB3zKVn+GJWdXV8YGwo8b+zOEFNhZcwvwIDAQAB</span><br><span class="line">AoGAfhbQZicUPqPiu/5PDiEMFpUIxurvmb3mNQJHrobJF3jN0c/Uo3TafT6mmiEp</span><br><span class="line">Op5fBtlwSjyvkEuZmbSrOglMegCWYiFNStfkxadSJRVRzbKCTDt5A3GEmQSm/Tzn</span><br><span class="line">I6IFgtkzNgWR8g8iAPhkuzRKDiJjvoVlxG53oSeMfkL0gEECQQDadXBHYvslRE8R</span><br><span class="line">XXQFslpEBqqL8nSV4BsY+Zk4JpTvhkM8rvt+DAV0TmkUOF4cjBoZ9GpF6dGe62Ql</span><br><span class="line">aIjEgd0PAkEAxMvRfpKSDKUFnnEHLrdnx1H+RYnRaqjt59nxjAl8n0infPlGCc23</span><br><span class="line">B0S9qVxXF2vMZRE1rvrdp2cbn77xmonRUQJBAIB5fHSfI3ABQjbGLQuEnk1PVlFD</span><br><span class="line">X4kc6RLBB3jcR86tuTEg/0pbq4GA848urzo+ssL82NsQ7XR2nsjZN0XJ0cUCQQCB</span><br><span class="line">o1Jp8tvLAJpm+UYl/COdJeI+pL8TaBzwcp2wBj/WHeJXbU45/w3m992Ix4+HmjeX</span><br><span class="line">DHM0xYVmVYHZBcvaZZdBAkAWXpCKRKa3UW3VrvR1L9w6h5HgD7oL5cjC2saXqX59</span><br><span class="line">h3V4utreg9Gt8iTTGJCm3tqV28aEFni3BKb7scUEhiQY</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<h2 id="SSH密钥格式"><a href="#SSH密钥格式" class="headerlink" title="SSH密钥格式"></a>SSH密钥格式</h2><table>
<thead>
<tr>
<th>项目</th>
<th><code>-----BEGIN RSA PRIVATE KEY-----</code></th>
<th><code>-----BEGIN OPENSSH PRIVATE KEY-----</code></th>
</tr>
</thead>
<tbody><tr>
<td>🔢 格式标准</td>
<td><strong>PKCS#1</strong>（老式）</td>
<td><strong>OpenSSH 专属格式</strong>（自 v6.5 起）</td>
</tr>
<tr>
<td>🔐 加密算法</td>
<td><strong>只能是 RSA</strong></td>
<td>可包含多种算法（<strong>RSA、ED25519、ECDSA</strong>）</td>
</tr>
<tr>
<td>📦 内容结构</td>
<td>ASN.1 DER（Base64 编码）</td>
<td>内部使用自定义结构（Base64）</td>
</tr>
<tr>
<td>📂 兼容性</td>
<td>OpenSSL、Java、OpenSSH（可用）</td>
<td>仅 OpenSSH 系列使用</td>
</tr>
<tr>
<td>🔁 是否可转换</td>
<td>✅ 可转为 PKCS#8 或 OpenSSH 格式</td>
<td>✅ 可导出为公钥，也能转为 PEM 格式（即 PKCS#1 和 PKCS#8）</td>
</tr>
<tr>
<td>🧭 查看公钥</td>
<td>用 <code>openssl rsa -in ... -pubout</code></td>
<td>用 <code>ssh-keygen -y -f ...</code></td>
</tr>
<tr>
<td>🧰 典型来源</td>
<td><code>openssl genrsa</code></td>
<td><code>ssh-keygen</code> 默认生成（自 v6.5 起）</td>
</tr>
</tbody></table>
<p> <font color="red">二者可以通过 <strong>PuTTY工具</strong> 进行转换，见后文。</font> </p>
<h2 id="公钥提取"><a href="#公钥提取" class="headerlink" title="公钥提取"></a>公钥提取</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从私钥提取OpenSSH格式公钥</span></span><br><span class="line">ssh-keygen -y -f priKey.pem &gt; sshPubkey.pub</span><br></pre></td></tr></table></figure>

<h2 id="公钥转换"><a href="#公钥转换" class="headerlink" title="公钥转换"></a>公钥转换</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将SSH2公钥转换成OpenSSH公钥</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -i -m ssh2 -f ssh2.pub &gt; openssh.pub <span class="comment"># -i:默认导入的文件格式为SSH2</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将PEM格式PKCS#8标准公钥转换成OpenSSH公钥</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -i -m PKCS8 -f PKCS8Pubkey.pem &gt; openssh.pub</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将PEM格式PKCS#1标准公钥转换成OpenSSH公钥</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -i -m PEM -f PKCS1Pubkey.pem &gt; openssh.pub</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将OpenSSH公钥转换成SSH2公钥</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -e -m ssh2 -f openssh.pub &gt; ssh2.pub <span class="comment"># -e:默认导出的文件格式为SSH2</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将OpenSSH公钥转换成PEM格式PKCS#1标准公钥</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -e -m PEM -f openssh.pub &gt; PKCS1Pubkey.pem</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将OpenSSH公钥转换成PEM格式PKCS#8标准公钥</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -e -m PKCS8 -f openssh.pub &gt; PKCS8Pubkey.pem</span></span><br></pre></td></tr></table></figure>

<h2 id="windows下的OpenSSH"><a href="#windows下的OpenSSH" class="headerlink" title="windows下的OpenSSH"></a>windows下的OpenSSH</h2><p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210203100529136.png" alt="image-20210203100529136"></p>
<p><font color="blue"><strong>使用 SSH 远程 Linux：</strong></font> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i G:\pvt_pkcs1.pem root@8.129.8.11 -p 22</span><br></pre></td></tr></table></figure>

<p><font color="blue"><strong>修改文件权限：</strong></font> </p>
<p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210203103207726.png" alt="image-20210203103207726"></p>
<p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210203103214898.png" alt="image-20210203103214898"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><font color="red">OpenSSH 公钥可用于 OpenSSH 授权，以 <code>ssh-rsa + 空格</code> 开头，后跟一串字符，以 <code>空格 + 注释</code> 结尾。注释部分可以随意修改，也可删除。</font> </p>
<p>使用 SSH 基于 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86">密钥</a> 的安全验证来远程登录系统，只需要将 <code>id_rsa.pub</code> 文件中的内容粘贴到远程系统的 <code>/root/.ssh/authorized_keys</code> 文件中，然后配置远程工具私钥认证即可。</p>
<p><font color="blue"> <strong>Putty 基于密钥登录只能使用 ppk 文件格式；而其他ssh客户端，大多都只能使用 PEM格式 (PKCS#1标准)。</strong></font> </p>
<h1 id="OpenSSL"><a href="#OpenSSL" class="headerlink" title="OpenSSL"></a>OpenSSL</h1><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/OpenSSL">OpenSSL -维基百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://docs.openssl.org/master/man1/openssl/">https://docs.openssl.org/master/man1/openssl/</a></p>
<p> <a target="_blank" rel="noopener" href="https://docs.openssl.org/master/man1/">https://docs.openssl.org/master/man1/</a>        <strong>OpenSSL 所有命令手册</strong></p>
<p>OpenSSL是一种加密工具套件。为了减少全局手册页名称空间的混乱，在OpenSSL 3.0中不推荐使用不带 <code>openssl-</code> 前缀的手册页条目，并将在OpenSSL 4.0中将其删除。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看子命令</span></span><br><span class="line">openssl --help</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">每个openssl子命令同样可以使用 --<span class="built_in">help</span></span></span><br><span class="line">openssl genrsa --help</span><br></pre></td></tr></table></figure>

<h2 id="查看openSSL版本"><a href="#查看openSSL版本" class="headerlink" title="查看openSSL版本"></a>查看openSSL版本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl version</span><br><span class="line">openssl version -a</span><br></pre></td></tr></table></figure>

<h2 id="openssl-genpkey"><a href="#openssl-genpkey" class="headerlink" title="openssl-genpkey"></a>openssl-genpkey</h2><p><a target="_blank" rel="noopener" href="https://docs.openssl.org/master/man1/openssl-genpkey/">https://docs.openssl.org/master/man1/openssl-genpkey/</a></p>
<p>此命令生成私钥或密钥对。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成RSA密钥，位长度为1024，输出 PEM 格式 PKCS#8 标准</span></span><br><span class="line">openssl genpkey -algorithm RSA -out privatekey.pem -pkeyopt rsa_keygen_bits:1024 -outform PEM</span><br><span class="line">cat privatekey.pem</span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAM4Phl7/PrVtcyO+</span><br><span class="line">D0zlUXwNrhsIiaXSHQJVXyQwUS3kb4vA95yNMXmpbTPSe6i2dJK3cQXvf+xK4eiw</span><br><span class="line">aWFTOaluDieqMpLmkNQdGP3EKONb9eMuTEZhWSg05/a3Kk7w6pHRFV5Qp45Ryc82</span><br><span class="line">bMH6gZH5jMSIWM95fRyBU/JVmtSlAgMBAAECgYEAgOL1CTZd4t0yx4h5yX8mGJH1</span><br><span class="line">9LLCZhWmT29WsywFms7ndmKcfi9SYua2h1OARWbaQ2q6JxxGx2WPKBwvzdBgn5nf</span><br><span class="line">aNpUPmCNaT6yeEmr4wM4FzRv5RyZYiW4APBf9j0CNGMYHEbTLCBGekGN1m1jW7FR</span><br><span class="line">nS7+eysJEV4fBlulhYECQQDtIenn7Kf+7xHDXbxRqiE7qomIjquSvca6gAbcUbBi</span><br><span class="line">D32lrsrrTeeexCy5/BLMuDVxMWIWDUKxTCjgIoFSFrFTAkEA3nS3s+cJjQdrJJmJ</span><br><span class="line">0Jh1fdoS0w+Uu9S+aUGGfB1TCTUZiEAChAeYyeNLtCVkqrpRAy2HnRa6SXa4Oyue</span><br><span class="line">NjPLJwJAJ3fpkqyVGZ14+2dynLUQavnrgkscy4PCu+/rNGh0Tx3878K0C44f6xED</span><br><span class="line">0MDf8CsI2ho6FSmH3DKs6wFTPPKB+QJAVt1uymIiOZ62+NC3nuuZnW4lQaNo6buW</span><br><span class="line">KtW6ZQayYPsKIEkWcmXhBJyr+AlN+NjOP5ZsySuRzJP+NqS+n92zqwJBAOPYdnsJ</span><br><span class="line">69MSn+WoPDph6oJieTiZVHY96Sq2NMfGfue0hO6GIo9q62+dt9G93bAQeoiqcRxI</span><br><span class="line">9GLeiXscGvpPqE4=</span><br><span class="line">-----END PRIVATE KEY-----</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成RSA密钥，位长度为2048，使用3DES加密，输出格式为DER</span></span><br><span class="line">openssl genpkey -algorithm RSA -out privatekey.der -pkeyopt rsa_keygen_bits:1024 -des3 -pass pass:123456 -outform DER</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成EC密钥，输出 PEM 格式 PKCS#8 标准</span></span><br><span class="line">openssl genpkey -algorithm EC -out eckey.pem -pkeyopt ec_paramgen_curve:P-384 -pkeyopt ec_param_enc:named_curve -outform PEM</span><br><span class="line">cat eckey.pem </span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIG2AgEAMBAGByqGSM49AgEGBSuBBAAiBIGeMIGbAgEBBDChgwc8mE6PS/5hla0P</span><br><span class="line">/nbXt/SF+Pm+GQB9VjTmGolr5Jl4HqeX1Ig4uzRicyqiF6ahZANiAASDMXlyv63I</span><br><span class="line">CgvQzxzkIcDJKxNm8l9P8p/FuYvLY9ELUphbD2ZKCQr/ORYSHWSYsgrpDP1uyEJ9</span><br><span class="line">TXQWn9hHra2BFY3TA+1Fg4W+fpHhtel/6B9mmG4owy81SIc8Y52ITPE=</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<h2 id="openssl-rsa"><a href="#openssl-rsa" class="headerlink" title="openssl-rsa"></a>openssl-rsa</h2><p><a target="_blank" rel="noopener" href="https://docs.openssl.org/master/man1/openssl-rsa/">https://docs.openssl.org/master/man1/openssl-rsa/</a></p>
<p>此命令处理 RSA 密钥。它们可以在各种格式之间转换，并打印。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改加密算法并设置密码，这里的des3作用在输出密钥。输入密钥信息中包含了对称加密算法，只需要给出密码</span></span><br><span class="line">openssl rsa -in privatekey.pem -passin pass:123456 -des3 -out privatekey2.pem -passout pass:654321</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除RSA私钥的加密密码</span></span><br><span class="line">openssl rsa -in privatekey2.pem -passin pass:654321 -out privatekeyout.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用三重DES加密私钥</span></span><br><span class="line">openssl rsa -in privatekeyout.pem -des3 -out 3desprivatekey.pem # 需要手动输入加密密码</span><br><span class="line">openssl rsa -in privatekeyout.pem -des3 -out 3desprivatekey.pem -passout pass:123456</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查私钥是否为有效的RSA密钥：</span></span><br><span class="line">openssl rsa -check -in privatekey.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从私钥中提取PEM格式公钥 (PKCS#8标准)</span></span><br><span class="line">openssl rsa -in privatekey.pem -pubout -out publickey.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从私钥中提取PEM格式公钥 (PKCS#1标准)</span></span><br><span class="line">openssl rsa -in privatekey.pem -RSAPublicKey_out -out publickey.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">转换私钥格式(PEM-&gt;DER)</span></span><br><span class="line">openssl rsa -in privatekey.pem -outform der -out privatekey.der</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">转换私钥格式(DER-&gt;PEM)</span></span><br><span class="line">openssl rsa -in privatekey.der -inform der -out privatekey.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将私钥打印到标准输出</span></span><br><span class="line">openssl rsa -in privatekey.pem -text -noout</span><br></pre></td></tr></table></figure>

<h2 id="openssl-pkey"><a href="#openssl-pkey" class="headerlink" title="openssl-pkey"></a>openssl-pkey</h2><p><a target="_blank" rel="noopener" href="https://docs.openssl.org/master/man1/openssl-pkey/">https://docs.openssl.org/master/man1/openssl-pkey/</a></p>
<p>此命令处理公钥或私钥。它们可以在各种格式之间转换，并打印。</p>
<p>该处理命令和 <code>openssl-rsa</code> 使用很相似，它可以处理更多的公开密钥加密算法 (RSA、ECDSA等)。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除私钥的加密密码</span></span><br><span class="line">openssl pkey -in key.pem -out keyout.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用三重DES加密私钥</span></span><br><span class="line">openssl pkey -in key.pem -des3 -out keyout.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">转换私钥格式(PEM-&gt;DER)</span></span><br><span class="line">openssl pkey -in key.pem -outform DER -out keyout.der</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">转换私钥格式(DER-&gt;PEM)</span></span><br><span class="line">openssl pkey -in key.der -inform der -out keyout.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">要仅输出私钥的公钥部分</span></span><br><span class="line">openssl pkey -in key.pem -pubout -out pubkey.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">PKCS1私钥转换为PKCS8</span></span><br><span class="line">openssl pkey -in PKCS1.pem -out PKCS8.pem</span><br><span class="line">openssl pkcs8 -in PKCS1.pem -topk8 -nocrypt -out PKCS8.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">PKCS8私钥转换为PKCS1</span></span><br><span class="line">openssl rsa -in PKCS8.pem -out PKCS1.pem</span><br><span class="line">openssl ec -in PKCS8.pem -out PKCS1.pem</span><br></pre></td></tr></table></figure>

<h2 id="openssl-req"><a href="#openssl-req" class="headerlink" title="openssl-req"></a>openssl-req</h2><p><a target="_blank" rel="noopener" href="https://docs.openssl.org/master/man1/openssl-req/">https://docs.openssl.org/master/man1/openssl-req/</a></p>
<p>此命令主要用于创建和处理 PKCS#10 格式的证书请求 (CSR)。此外，它还可以创建自签名证书，例如用作根 CA。</p>
<h3 id="根证书"><a href="#根证书" class="headerlink" title="根证书"></a>根证书</h3><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%A0%B9%E8%AF%81%E4%B9%A6"><strong>根证书</strong></a> 是认证中心机构（Certificate Authority）给自己签发的证书，签发者就是自身，是信任链的起点。里面包含了CA信息、CA公钥、用自身的私钥对这些信息的签名。下载并使用根证书就表示你信任它的来源机构，自然也信任证书以下签发的所有证书。某个证书可以用签发他的证书中的公钥验证，签发他的证书又需要上一层签发证书来验证，直到通过根证书中的公钥验证，那么这个证书就是可信任的。</p>
<h3 id="证书标准"><a href="#证书标准" class="headerlink" title="证书标准"></a>证书标准</h3><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/X.509">X.509 - 维基百科</a> </p>
<h3 id="证书文件扩展名"><a href="#证书文件扩展名" class="headerlink" title="证书文件扩展名"></a>证书文件扩展名</h3><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/X.509#%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D">证书扩展名 - 维基百科</a> </p>
<p>X.509有多种常用的扩展名。不过其中的一些还用于其它用途，就是说具有这个扩展名的文件可能并不是证书，比如说可能只是保存了私钥。</p>
<ul>
<li><code>.pem</code> – <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/w/index.php?title=%E9%9A%90%E7%A7%81%E5%A2%9E%E5%BC%BA%E5%9E%8B%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6&action=edit&redlink=1">隐私增强型电子邮件</a>格式，通常是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Base64">Base64</a>格式的。</li>
<li><code>.der</code>、<code>.cer</code>、<code>.crt</code> – 通常是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/w/index.php?title=DER&action=edit&redlink=1">DER</a>二进制格式的。</li>
<li><code>.p7b</code>、<code>.p7c</code> – <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A0%87%E5%87%86">PKCS#7</a> 格式，没有数据的SignedData结构，仅证书或<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%AF%81%E4%B9%A6%E5%90%8A%E9%94%80%E5%88%97%E8%A1%A8">证书吊销列表 (CRL)</a>。</li>
<li><code>.p12</code> – <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A0%87%E5%87%86">PKCS#12</a> 格式，包含证书的同时可能还包含<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%A7%81%E9%92%A5">私钥</a></li>
<li><code>.pfx</code> – PFX，PKCS#12之前的格式（通常用PKCS#12格式，比如由<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%B6%B2%E9%9A%9B%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E6%9C%8D%E5%8B%99">互联网信息服务</a>产生的PFX文件）</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A0%87%E5%87%86">PKCS#7</a> 是签名或加密数据的格式标准，官方称之为容器。由于证书是可验真的签名数据，所以可以用SignedData结构表述。 <code>.P7C</code>文件是退化的SignedData结构，没有包括签名的数据。</p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A0%87%E5%87%86">PKCS#12</a> 由PFX进化而来的用于交换公共的和私有的对象的标准格式。</p>
<h3 id="证书获取及相关工具"><a href="#证书获取及相关工具" class="headerlink" title="证书获取及相关工具"></a>证书获取及相关工具</h3><p> <a target="_blank" rel="noopener" href="https://www.getssl.cn/">https://www.getssl.cn/</a> </p>
<p>向权威机构要证书通常是要钱的，但也有免费的。</p>
<p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210119113131137.png" alt="image-20210119113131137"></p>
<h3 id="向权威证书颁发机构申请证书"><a href="#向权威证书颁发机构申请证书" class="headerlink" title="向权威证书颁发机构申请证书"></a>向权威证书颁发机构申请证书</h3><h4 id="关于证书签署请求-CSR"><a href="#关于证书签署请求-CSR" class="headerlink" title="关于证书签署请求(CSR)"></a>关于证书签署请求(CSR)</h4><p>如果你想从证书颁发机构 (certificate authority 简称 CA) 那里获得 SSL 证书，你必须生成一个证书签署请求 (certificate signing request 简称 CSR) 。一个 CSR 主要是由一个密钥对的公钥和一些附加信息组成。当证书被签署时，这两部分都会被插入到证书中，可以从浏览器中导出证书并用在线工具查看证书的内容。</p>
<p>把生成的 CSR 交给权威证书颁发机构，权威证书颁发机构对此进行签名，完成。保留好 CSR，当权威证书颁发机构颁发的证书过期的时候，你还可以用同样的 CSR 来申请新的证书，key (私钥) 保持不变。</p>
<h4 id="生成-CSR"><a href="#生成-CSR" class="headerlink" title="生成 CSR"></a>生成 CSR</h4><p>当生成 CSR 时，你会被提示输入证书相关的详细信息。这些信息被称为区分名称 (Distinguised Name 简称 DN)。DN 中的一个重要字段是通用名称 (<font color="red">Common Name 简称 CN</font>)，它应该是你打算使用证书的主机的完全合格域名 (Fully Qualified Domain Name 简称 FQDN)，<font color="red">而其他信息乃非必须</font>。如果用户未输入任何内容，则使用默认值；如果不存在默认值，则忽略该字段（留空）。<font color="red">即便存在默认值，仍然可以省略该字段，仅需输入 <code>.</code> 字符。</font></p>
<p>当生成 CSR 时，可以通过命令行或文件传递信息来跳过交互式提示。可以通过在任何请求 CSR 信息的 OpenSSL 命令中添加 <code>-subj</code> 选项来实现非交互式地回答 CSR 信息提示。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-subj &quot;/C=US/ST=New York/L=Brooklyn/O=Example Brooklyn Company/CN=examplebrooklyn.com&quot;</span><br></pre></td></tr></table></figure>

<h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建一个私钥，然后从中生成一个新的CSR</span></span><br><span class="line">openssl genpkey -algorithm RSA -out privatekey.pem -pkeyopt rsa_keygen_bits:2048</span><br><span class="line">openssl req \</span><br><span class="line">       -new \</span><br><span class="line">       -key privatekey.pem \</span><br><span class="line">       -out req.csr \</span><br><span class="line">       -subj &quot;/CN=www.zhaolq.com&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查并验证证书申请</span></span><br><span class="line">openssl req -in req.csr -text -verify -noout</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建一个新的CSR和一个新的私钥</span></span><br><span class="line">openssl req \</span><br><span class="line">       -newkey rsa:2048 \</span><br><span class="line">       -nodes \</span><br><span class="line">       -keyout privatekey.pem \</span><br><span class="line">       -out req.csr \</span><br><span class="line">       -subj &quot;/CN=www.zhaolq.com&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">选项 -nodes 指定私钥没有用密码加密。在OpenSSL 3.0中，也不建议使用 -nodes 选项。使用 -noenc 代替</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从CSR中提取公钥</span></span><br><span class="line">openssl req -in req.csr -noout -pubkey</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成自签名证书/测试证书</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">【参数中带-x509表示直接生成自签证书，不带则表示生成证书签署请求】</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生产环境中还是不要使用自签的证书，否则浏览器会不认，或者如果你是企业应用的话能够强制让用户的浏览器接受你的自签证书也行。</span></span><br><span class="line">openssl req \</span><br><span class="line">       -x509 \</span><br><span class="line">       -days 3650 \</span><br><span class="line">       -newkey rsa:2048 \</span><br><span class="line">       -nodes \</span><br><span class="line">       -keyout privatekey.pem \</span><br><span class="line">       -out my.crt \</span><br><span class="line">       -subj &quot;/CN=www.zhaolq.com&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据私钥生成自签名证书</span></span><br><span class="line">openssl req \</span><br><span class="line">       -x509 \</span><br><span class="line">       -days 3650 \</span><br><span class="line">       -new \</span><br><span class="line">       -key privatekey.pem \</span><br><span class="line">       -out my2.crt \</span><br><span class="line">       -subj &quot;/CN=www.zhaolq.com&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建一个SM2私钥，然后从中生成一个证书请求</span></span><br><span class="line">openssl ecparam -genkey -name SM2 -out sm2.key</span><br><span class="line">openssl req -new -key sm2.key -out sm2.csr -sm3 -sigopt &quot;distid:1234567812345678&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查并验证SM2证书请求</span></span><br><span class="line">openssl req -verify -in sm2.csr -sm3 -vfyopt &quot;distid:1234567812345678&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看CSR内容</span></span><br><span class="line">openssl req -in req.csr -text</span><br><span class="line">openssl req -in req.csr -text -noout -verify</span><br><span class="line">       </span><br></pre></td></tr></table></figure>

<h2 id="openssl-x509"><a href="#openssl-x509" class="headerlink" title="openssl-x509"></a>openssl-x509</h2><p>此命令是多用途证书命令。它可用于显示证书信息，将证书转换为各种形式，签署证书请求（例如“mini CA”）或编辑证书信任设置。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从证书中提取公钥</span></span><br><span class="line">openssl x509 -in cert.pem -noout -pubkey</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示证书内容</span></span><br><span class="line">openssl x509 -in cert.pem -noout -text -subject</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示证书序列号</span></span><br><span class="line">openssl x509 -in cert.pem -noout -serial</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示证书主题名称</span></span><br><span class="line">openssl x509 -in cert.pem -noout -subject</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">以RFC2253格式显示证书主题名称</span></span><br><span class="line">openssl x509 -in cert.pem -noout -subject -nameopt RFC2253</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在支持UTF8的终端上以单行形式显示证书主题名称</span></span><br><span class="line">openssl x509 -in cert.pem -noout -subject -nameopt oneline,-esc_msb</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示证书SHA1指纹</span></span><br><span class="line">openssl x509 -sha1 -in cert.pem -noout -fingerprint</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将证书从PEM转换为DER格式</span></span><br><span class="line">openssl x509 -in cert.pem -inform PEM -out cert.der -outform DER</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将证书从DER转换为PEM格式</span></span><br><span class="line">openssl x509 -in cert.der -inform DER -out cert2.pem -outform PEM</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据私钥和证书生成CSR，将证书转换为证书请求</span></span><br><span class="line">openssl x509 -x509toreq -in cert.pem -out req.csr -signkey privatekey.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据私钥和CSR生成自签名证书</span></span><br><span class="line">openssl x509 \</span><br><span class="line">       -req \</span><br><span class="line">       -in req.csr \</span><br><span class="line">       -out cacert.pem \</span><br><span class="line">       -signkey privatekey.pem \</span><br><span class="line">       -days 3650</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据私钥和CSR生成自签名证书，添加CA扩展项</span></span><br><span class="line">openssl x509 \</span><br><span class="line">       -req \</span><br><span class="line">       -in req.csr \</span><br><span class="line">       -out cacert.pem \</span><br><span class="line">       -signkey privatekey.pem \</span><br><span class="line">       -extfile /etc/pki/tls/openssl.cnf \</span><br><span class="line">       -extensions v3_ca \</span><br><span class="line">       -days 3650</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用上面生成的 自签名证书/根证书 签署证书请求</span></span><br><span class="line">openssl x509 \</span><br><span class="line">       -req \</span><br><span class="line">       -in req2.csr \</span><br><span class="line">       -out cacert2.pem \</span><br><span class="line">       -CA cacert.pem \</span><br><span class="line">       -CAkey privatekey.pem \</span><br><span class="line">       -CAcreateserial \</span><br><span class="line">       -days 3650</span><br></pre></td></tr></table></figure>

<h2 id="openssl-ca"><a href="#openssl-ca" class="headerlink" title="openssl-ca"></a>openssl-ca</h2><p>此命令模拟CA应用程序。它可以用于以多种形式签署证书请求（CSR）并生成证书吊销列表（CRL）。</p>
<p>请注意，还有很多种生成证书的方法： <a target="_blank" rel="noopener" href="https://www.openssl.org/docs/manmaster/man1/openssl-req.html">openssl-req</a> 和 <a target="_blank" rel="noopener" href="https://www.openssl.org/docs/manmaster/man1/openssl-x509.html">openssl-x509</a> 命令可用于直接创建证书。</p>
<p><a href="/article/2020/12/%E4%BD%BF%E7%94%A8OpenSSL%E6%9E%84%E5%BB%BA%E7%A7%81%E6%9C%89CA/">使用OpenSSL构建私有CA</a> </p>
<h2 id="openssl-crl"><a href="#openssl-crl" class="headerlink" title="openssl-crl"></a>openssl-crl</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将CRL文件从PEM转换为DER</span></span><br><span class="line">openssl crl -in /home/crl.pem -outform DER -out /home/crl.der</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将CRL文件从DER转换为PEM</span></span><br><span class="line">openssl crl -inform DER -in /home/crl.der -out /home/crl2.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取PEM证书格式的crl文本内容</span></span><br><span class="line">openssl crl -in /home/crl.pem -text -noout</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取DER证书格式的crl文本内容</span></span><br><span class="line">openssl crl -inform DER -in /home/crl.der -text -noout</span><br></pre></td></tr></table></figure>

<h2 id="openssl-verify"><a href="#openssl-verify" class="headerlink" title="openssl-verify"></a>openssl-verify</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl verify -CAfile rootca.crt subcert.crt</span><br></pre></td></tr></table></figure>

<h2 id="openssl-pkcs7"><a href="#openssl-pkcs7" class="headerlink" title="openssl-pkcs7"></a>openssl-pkcs7</h2><p> <a target="_blank" rel="noopener" href="https://www.getssl.cn/export_p7b.php">在线导出PKCS7 P7B格式</a> </p>
<p>PKCS＃7结构证书可以包含多个证书。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将pem格式的PKCS＃7结构证书转换为der格式的PKCS＃7结构证书</span></span><br><span class="line">openssl pkcs7 -inform PEM -in p7b.pem -outform DER -out p7b.der</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将所有证书输出到一个文件中。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将pem格式的PKCS＃7结构证书转pem证书</span></span><br><span class="line">openssl pkcs7 -print_certs -inform PEM -in p7b.pem -out cert.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将der格式的PKCS＃7结构证书转pem证书</span></span><br><span class="line">openssl pkcs7 -print_certs -inform DER -in p7b.der -out cert.pem</span><br></pre></td></tr></table></figure>

<h2 id="openssl-crl2pkcs7"><a href="#openssl-crl2pkcs7" class="headerlink" title="openssl-crl2pkcs7"></a>openssl-crl2pkcs7</h2><p>根据可选的CRL和一个或多个pem证书，转换为 PKCS#7 简并的 “certificates only” 结构。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据pem证书以无CRL的格式创建PEM格式的PKCS＃7结构证书</span></span><br><span class="line">openssl crl2pkcs7 -nocrl -certfile cert.pem -out p7b.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据可选的CRL和pem证书创建PEM格式的PKCS＃7结构证书</span></span><br><span class="line">openssl crl2pkcs7 -in crl.pem -certfile cert.pem -out p7b.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从几种不同的pem证书中以无CRL的格式创建PEM格式的PKCS＃7结构</span></span><br><span class="line">openssl crl2pkcs7 \</span><br><span class="line">       -nocrl \</span><br><span class="line">       -certfile cert1.pem \</span><br><span class="line">       -certfile cert2.pem \</span><br><span class="line">       -outform PEM \</span><br><span class="line">       -out p7b.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从几种不同的pem证书中以无CRL的格式创建DER格式的PKCS＃7结构</span></span><br><span class="line">openssl crl2pkcs7 \</span><br><span class="line">       -nocrl \</span><br><span class="line">       -certfile cert1.pem \</span><br><span class="line">       -certfile cert2.pem \</span><br><span class="line">       -outform DER \</span><br><span class="line">       -out p7b.der</span><br></pre></td></tr></table></figure>

<h2 id="openssl-pkcs12"><a href="#openssl-pkcs12" class="headerlink" title="openssl-pkcs12"></a>openssl-pkcs12</h2><p>创建和解析 PKCS#12 文件（有时称为PFX文件）。PKCS#12 文件被 Netscape、MSIE 和 MS Outlook 等多个程序使用。</p>
<p> <a target="_blank" rel="noopener" href="https://www.getssl.cn/export_pfx.php">在线导出PFX、PKCS12</a> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解析PKCS#12文件并将其输出到PEM文件</span></span><br><span class="line">openssl pkcs12 -in cert.pfx -out file.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不加密私钥。由于openssl版本不同，选择以下一种方式。</span></span><br><span class="line">openssl pkcs12 -in cert.pfx -out file.pem -nodes</span><br><span class="line">openssl pkcs12 -in cert.pfx -out file.pem -noenc</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">仅将客户端证书输出到文件</span></span><br><span class="line">openssl pkcs12 -in cert.pfx -clcerts -out file.pem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打印有关PKCS#12文件的一些信息</span></span><br><span class="line">openssl pkcs12 -in cert.pfx -info -noout</span><br><span class="line">openssl pkcs12 -in cert.pfx -info -noout -legacy # 旧版模式下打印</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从PEM文件创建一个PKCS#12文件，该文件可能包含私钥和证书</span></span><br><span class="line">openssl pkcs12 -export -nokeys -in cert.pem -out cert.pfx # 仅包含证书</span><br><span class="line">openssl pkcs12 -export -nocerts -inkey privatekey.pem -out cert.pfx # 仅包含私钥</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将证书和私钥打包为pkcs12格式文件</span></span><br><span class="line">openssl pkcs12 -export -in cert.pem -inkey privatekey.pem -out cert.pfx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">包括一些额外的证书</span></span><br><span class="line">openssl pkcs12 \</span><br><span class="line">       -export \</span><br><span class="line">       -nokeys \</span><br><span class="line">       -in cert.pem \</span><br><span class="line">       -out cert.pfx \</span><br><span class="line">       -certfile cert2.pem \</span><br><span class="line">       -certfile cert3.pem</span><br></pre></td></tr></table></figure>

<h2 id="openssl-pkeyutl"><a href="#openssl-pkeyutl" class="headerlink" title="openssl-pkeyutl"></a>openssl-pkeyutl</h2><p><a target="_blank" rel="noopener" href="https://docs.openssl.org/master/man1/openssl-pkeyutl/">https://docs.openssl.org/master/man1/openssl-pkeyutl/</a></p>
<p>该命令可用于对非对称密钥（公钥或私钥）执行低级操作，支持任何兼容的算法。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">公钥加密</span></span><br><span class="line">openssl pkeyutl -encrypt -inkey publickey.pem -pubin -in test.txt -out test_enc.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">私钥解密</span></span><br><span class="line">openssl pkeyutl -decrypt -inkey privatekey.pem -in test_enc.txt -out test_dec.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">私钥签名，文件不能比密钥长</span></span><br><span class="line">openssl pkeyutl -sign -inkey privatekey.pem -in test.txt -out test_sign.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">恢复已签名的数据</span></span><br><span class="line">openssl pkeyutl -verifyrecover -inkey privatekey.pem -in test_sign.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">公钥验签</span></span><br><span class="line">openssl pkeyutl -verify -inkey publickey.pem -pubin -in test.txt -sigfile test_sign.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">私钥验签</span></span><br><span class="line">openssl pkeyutl -verify -inkey privatekey.pem -in test.txt -sigfile test_sign.txt</span><br></pre></td></tr></table></figure>

<h2 id="openssl-dgst"><a href="#openssl-dgst" class="headerlink" title="openssl-dgst"></a>openssl-dgst</h2><p><a target="_blank" rel="noopener" href="https://docs.openssl.org/master/man1/openssl-dgst/">https://docs.openssl.org/master/man1/openssl-dgst/</a></p>
<p>该命令以十六进制格式输出指定文件或多个文件的消息摘要，并使用消息摘要生成和验证数字签名。</p>
<p>通用名称 openssl dgst 可与指定算法的选项一起使用。默认摘要为 sha256。支持的摘要名称也可用作子命令名称。要查看支持的算法列表，请使用 <code>openssl list -digest-algorithms</code> 。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">openssl dgst [-算法名称] [-其他选项] inputfile</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">摘要计算，默认md5的十六进制编码</span></span><br><span class="line">openssl dgst file1.txt file2.txt file3.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">计算sha256文件消息摘要，以十六进制编码输出</span></span><br><span class="line">openssl dgst -sha256 -hex file.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用SHA-256和二进制文件输出签名文件</span></span><br><span class="line">openssl dgst -sha256 -sign privatekey.pem -out signature.sign file.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用对应的公钥和摘要算法来验证签名</span></span><br><span class="line">openssl dgst -sha256 -verify publickey.pem -signature signature.sign file.txt</span><br></pre></td></tr></table></figure>

<h1 id="Java-Keytool工具管理证书"><a href="#Java-Keytool工具管理证书" class="headerlink" title="Java Keytool工具管理证书"></a>Java Keytool工具管理证书</h1><p>推荐链接：</p>
<p> <a target="_blank" rel="noopener" href="http://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html">http://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xdp-gacl/p/3750965.html">Java制作证书的工具keytool用法总结</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.chinassl.net/ssltools/keytool-commands.html">常用的Java Keytool Keystore命令</a> </p>
<p>keytool是 Java 提供的密钥、证书和证书库管理工具。可以完成生成密钥，生成证书等各种操作。</p>
<p>keytool的子命令如下：</p>
<p>-certreq 　　　　生成证书请求<br>-changealias 　  更改条目的别名<br>-delete 　　　　 删除条目<br>-exportcert    导出证书<br>-genkeypair    生成密钥对<br>-genseckey    生成密钥<br>-gencert      根据证书请求生成证书<br>-importcert    导入证书或证书链<br>-importkeystore 从其他密钥库导入一个或所有条目<br>-keypasswd    更改条目的密钥口令<br>-list          列出密钥库中的条目<br>-printcert      打印证书内容<br>-printcertreq   打印证书请求的内容<br>-printcrl      打印 CRL 文件的内容<br>-storepasswd   更改密钥库的存储口令</p>
<p>还可以使用 keytool -<em>command_name</em> -help 查看各个子命令的帮助信息</p>
<h1 id="OpenPGP"><a href="#OpenPGP" class="headerlink" title="OpenPGP"></a>OpenPGP</h1><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/PGP#OpenPGP">OpenPGP</a> 数据加解密标准（<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4880">RFC 4880</a>）。</p>
<p><strong><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/PGP">PGP</a></strong>（英语：Pretty Good Privacy，直译：<strong>优良保密协议</strong>）是一套用于讯息加密、验证的应用程序。主要开发者<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%8F%B2%E5%B0%94%C2%B7%E9%BD%90%E9%BB%98%E6%9B%BC">菲尔·齐默曼</a>，于1991年将PGP在互联网上免费发布。PGP本身是<font color="blue"><strong>商业应用程序</strong></font>，或者说是 OpenPGP 标准的<font color="blue"><strong>闭源实现</strong></font>。PGP及其同类产品均遵守<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/PGP#OpenPGP">OpenPGP</a>数据加解密标准（<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4880">RFC 4880</a>）。</p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/GnuPG">GnuPG</a>（GPG）是一个<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%AD%A6">密码学</a>软件，用于<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8A%A0%E5%AF%86">加密</a>、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%95%B8%E4%BD%8D%E7%B0%BD%E7%AB%A0">签名</a>通信内容及管理<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86">非对称密码学</a>的密钥。GnuPG是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%87%AA%E7%94%B1%E8%BD%AF%E4%BB%B6">自由软件</a>，遵循<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91%E5%B7%A5%E7%A8%8B%E5%B7%A5%E4%BD%9C%E5%B0%8F%E7%BB%84">IETF</a>订定的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/OpenPGP">OpenPGP</a>技术标准设计，并与<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/PGP">PGP</a>保持兼容。</p>
<h2 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h2><p> <a target="_blank" rel="noopener" href="https://www.openpgp.org/software/kleopatra/">https://www.openpgp.org/software/kleopatra/</a> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/GnuPG#%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F%E6%94%AF%E6%8F%B4">GnuPG应用程序支持</a> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Gpg4win">Gpg4win</a> </p>
<h2 id="PGP"><a href="#PGP" class="headerlink" title="PGP"></a>PGP</h2><p>PGP是OpenPGP标准的闭源商业版本。pgp提供了图形化工具和命令行工具，命令行工作主要有以下几个：</p>
<ul>
<li>pgpk.exe   密钥生成和管理</li>
<li>pgpe.exe  加密</li>
<li>pgps.exe  签名</li>
<li>pgpv.exe  解密和校验</li>
<li>pgpo.exe  模拟2.6.3老版本命令行方式</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pgpk -g                                                      #交互式生产密钥</span><br><span class="line">pgpk -x  keyname [-o pubkeyfile]                             #导出公钥</span><br><span class="line">pgpk -a  pubkeyfile                                          #将密钥加入密钥环(pubring.pkr文件)</span><br><span class="line">pgpk -r  keyname                                             #从密钥环删除公钥</span><br><span class="line">pgpe -r  keyname originfile [-o encryedfile] [-a]            #加密，-a表示生成ASCII文档而不是二进制</span><br><span class="line">pgpv encrypedfile -o decryedfile                             #解密（需要密钥密码）</span><br><span class="line">pgps -u keyname originfile [-o signedfile] [-a]              #签名（需要密钥密码），-a表示生成ASCII文档而不是二进制</span><br><span class="line">pgpv signedfile                                              #签名验证并恢复原始文件</span><br><span class="line"></span><br><span class="line">pgp -ka KEYS       #导入密钥</span><br><span class="line">pgp file.asc       #验证签名</span><br></pre></td></tr></table></figure>

<h2 id="GPG"><a href="#GPG" class="headerlink" title="GPG"></a>GPG</h2><p><font color="blue"><strong>Windows版下载并安装：</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://www.gnupg.org/download/index.html">https://www.gnupg.org/download/index.html</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.gnupg.org/download/mirrors.html">https://www.gnupg.org/download/mirrors.html</a> </p>
<p><font color="blue"><strong>支持GPG的应用程序、前端及浏览器扩展：</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/GnuPG#%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F%E6%94%AF%E6%8F%B4">GnuPG - 维基百科 - 应用程序支持</a> </p>
<p><font color="blue"><strong>官方手册：</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://gnupg.org/documentation/manuals/gnupg/">https://gnupg.org/documentation/manuals/gnupg/</a> </p>
<p><font color="blue"><strong>archlinux：</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/GnuPG_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">GnuPG (简体中文)</a> </p>
<p><font color="blue"><strong>链接：</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2013/07/gpg.html">GPG 入门教程 - 阮一峰</a> </p>
<p> <a target="_blank" rel="noopener" href="https://mogeko.me/2019/068/">GPG 的正确使用姿势</a> </p>
<p> <a target="_blank" rel="noopener" href="https://linux.cn/article-9524-1.html">用 PGP 保护代码完整性（一）： 基本概念和工具</a> </p>
<p> <a target="_blank" rel="noopener" href="https://linux.cn/article-9529-1.html">用 PGP 保护代码完整性（二）：生成你的主密钥</a> </p>
<p> <a target="_blank" rel="noopener" href="https://linux.cn/article-9607-1.html">用 PGP 保护代码完整性（三）：生成 PGP 子密钥</a> </p>
<p> <a target="_blank" rel="noopener" href="https://linux.cn/article-10402-1.html">用 PGP 保护代码完整性（四）：将主密钥移到离线存储中</a> </p>
<p> <a target="_blank" rel="noopener" href="https://linux.cn/article-10415-1.html">用 PGP 保护代码完整性（五）：将子密钥移到一个硬件设备中</a> </p>
<p> <a target="_blank" rel="noopener" href="https://linux.cn/article-10421-1.html">用 PGP 保护代码完整性（六）：在 Git 上使用 PGP</a> </p>
<p><font color="blue"><strong>公钥服务器：</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://keys.openpgp.org/">https://keys.openpgp.org/</a> </p>
<p> <a target="_blank" rel="noopener" href="https://keyserver.ubuntu.com/">https://keyserver.ubuntu.com/</a> </p>
<h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">gpg --version</span><br><span class="line">gpg --help # 帮助信息</span><br><span class="line"></span><br><span class="line">Syntax: gpg [options] [files]</span><br><span class="line">Sign, check, encrypt or decrypt</span><br><span class="line">Default operation depends on the input data</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line"></span><br><span class="line"> -s, --sign                  make a signature</span><br><span class="line">     --clear-sign            make a clear text signature</span><br><span class="line"> -b, --detach-sign           make a detached signature</span><br><span class="line"> -e, --encrypt               encrypt data</span><br><span class="line"> -c, --symmetric             encryption only with symmetric cipher</span><br><span class="line"> -d, --decrypt               decrypt data (default)</span><br><span class="line">     --verify                verify a signature</span><br><span class="line"> -k, --list-keys             list keys</span><br><span class="line">     --list-signatures       list keys and signatures</span><br><span class="line">     --check-signatures      list and check key signatures</span><br><span class="line">     --fingerprint           list keys and fingerprints</span><br><span class="line"> -K, --list-secret-keys      list secret keys</span><br><span class="line">     --generate-key          generate a new key pair</span><br><span class="line">     --quick-generate-key    quickly generate a new key pair</span><br><span class="line">     --quick-add-uid         quickly add a new user-id</span><br><span class="line">     --quick-revoke-uid      quickly revoke a user-id</span><br><span class="line">     --quick-set-expire      quickly set a new expiration date</span><br><span class="line">     --full-generate-key     full featured key pair generation</span><br><span class="line">     --generate-revocation   generate a revocation certificate</span><br><span class="line">     --delete-keys           remove keys from the public keyring</span><br><span class="line">     --delete-secret-keys    remove keys from the secret keyring</span><br><span class="line">     --quick-sign-key        quickly sign a key</span><br><span class="line">     --quick-lsign-key       quickly sign a key locally</span><br><span class="line">     --quick-revoke-sig      quickly revoke a key signature</span><br><span class="line">     --sign-key              sign a key</span><br><span class="line">     --lsign-key             sign a key locally</span><br><span class="line">     --edit-key              sign or edit a key</span><br><span class="line">     --change-passphrase     change a passphrase</span><br><span class="line">     --export                export keys</span><br><span class="line">     --send-keys             export keys to a keyserver</span><br><span class="line">     --receive-keys          import keys from a keyserver</span><br><span class="line">     --search-keys           search for keys on a keyserver</span><br><span class="line">     --refresh-keys          update all keys from a keyserver</span><br><span class="line">     --import                import/merge keys</span><br><span class="line">     --card-status           print the card status</span><br><span class="line">     --edit-card             change data on a card</span><br><span class="line">     --change-pin            change a card&#x27;s PIN</span><br><span class="line">     --update-trustdb        update the trust database</span><br><span class="line">     --print-md              print message digests</span><br><span class="line">     --server                run in server mode</span><br><span class="line">     --tofu-policy VALUE     set the TOFU policy for a key</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line"></span><br><span class="line"> -a, --armor                 create ascii armored output，输出ASCII文本</span><br><span class="line"> -r, --recipient USER-ID     encrypt for USER-ID</span><br><span class="line"> -u, --local-user USER-ID    use USER-ID to sign or decrypt</span><br><span class="line"> -z N                        set compress level to N (0 disables)</span><br><span class="line">     --textmode              use canonical text mode</span><br><span class="line"> -o, --output FILE           write output to FILE</span><br><span class="line"> -v, --verbose               verbose</span><br><span class="line"> -n, --dry-run               do not make any changes</span><br><span class="line"> -i, --interactive           prompt before overwriting</span><br><span class="line">     --openpgp               use strict OpenPGP behavior</span><br><span class="line"></span><br><span class="line">(See the man page for a complete listing of all commands and options)</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line"></span><br><span class="line"> -se -r Bob [file]          sign and encrypt for user Bob</span><br><span class="line"> --clear-sign [file]        make a clear text signature</span><br><span class="line"> --detach-sign [file]       make a detached signature</span><br><span class="line"> --list-keys [names]        show keys</span><br><span class="line"> --fingerprint [names]      show fingerprints</span><br></pre></td></tr></table></figure>

<p>下文的 <code>[fpr]</code> 是指 <font color="red"><strong>密钥的完整指纹</strong></font> 或 <font color="red"><strong>密钥ID</strong></font> (指纹简短形式) 。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">密钥生成，版本不同命令有差异</span></span><br><span class="line">gpg --gen-key</span><br><span class="line">gpg --full-gen-key</span><br><span class="line">gpg --full-generate-key # 2.1.17或更高版本</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列出您拥有其公钥和私钥的GPG密钥</span></span><br><span class="line">gpg --list-secret-keys --keyid-format LONG</span><br><span class="line">gpg --list-keys [fpr] # 或者 gpg -k</span><br><span class="line">gpg --homedir=E:\work\keys\GPGkeys\gnupg-backup --list-keys</span><br><span class="line">gpg --homedir=E:\work\keys\GPGkeys\gnupg-backup --list-secret-keys --keyid-format LONG</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">吊销证书位置：C:\Users\Administrator\AppData\Roaming\gnupg\openpgp-revocs.d</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成子密钥，使用GPG选项 --edit-key + 密钥名称，然后输入GPG命令 addkey</span></span><br><span class="line">gpg --edit-key [fpr] # 进入菜单模式</span><br><span class="line"><span class="meta prompt_">gpg&gt; </span><span class="language-bash">addkey</span></span><br><span class="line"><span class="meta prompt_">gpg&gt; </span><span class="language-bash">save</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">主密钥和子密钥导出的公钥内容相同，因为公钥中包含主密钥和所有子密钥信息，子密钥越多，公钥越长</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份公钥，加上-a的参数则输出文本格式的信息，否则输出的是二进制格式信息。</span></span><br><span class="line">gpg --export --armor/-a [fpr]</span><br><span class="line">gpg -o G:\pub_gpg_key.pem --export -a [fpr]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份主密钥</span></span><br><span class="line">gpg -o G:\pvt_gpg_key.pem --export-secret-keys -a [fpr]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份子密钥</span></span><br><span class="line">gpg -o G:\pvt_gpg_key_sub.pem --export-secret-subkeys -a [fpr]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">导出吊销证书</span></span><br><span class="line">gpg --generate-revocation [fpr] # 会输出到控制台</span><br><span class="line">mv ~/.gnupg/openpgp-revocs.d/54DCC0B75E75EA5E1BF94D861DCB323919998133.rev /home/revoke.rev # Linux</span><br><span class="line">mv ~\AppData\Roaming\gnupg\openpgp-revocs.d/54DCC0B75E75EA5E1BF94D861DCB323919998133.rev G:\revoke.rev # Windows</span><br></pre></td></tr></table></figure>

<h3 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h3><p> <a target="_blank" rel="noopener" href="https://docs.github.com/cn/github/authenticating-to-github/managing-commit-signature-verification">管理提交签名验证 - github-docs</a>   <font color="red"><strong>— github docs —</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E7%AD%BE%E7%BD%B2%E5%B7%A5%E4%BD%9C">Git 工具 - 签署工作</a> </p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\WINDOWS\system32&gt; gpg <span class="literal">--full-generate-key</span> <span class="comment"># 具体步骤略</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\WINDOWS\system32&gt; gpg <span class="literal">--list-secret-keys</span> <span class="literal">--keyid-format</span> LONG</span><br><span class="line">C:/Users/Administrator/AppData/Roaming/gnupg/pubring.kbx</span><br><span class="line"><span class="literal">--------------------------------------------------------</span></span><br><span class="line">sec   rsa4096/<span class="number">470</span>D31D4158CA17A <span class="number">2021</span><span class="literal">-02-04</span> [<span class="type">SC</span>]</span><br><span class="line">      <span class="number">5</span>C7B2D23024A8256CBFE979B470D31D4158CA17A</span><br><span class="line">uid                 [<span class="type">ultimate</span>] zhaolq &lt;hello@zhaolq.com&gt;</span><br><span class="line">ssb   rsa4096/<span class="number">971</span>CEBBA067D3D05 <span class="number">2021</span><span class="literal">-02-04</span> [<span class="type">E</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\WINDOWS\system32&gt; gpg <span class="literal">--export</span> <span class="literal">--armor</span> <span class="number">470</span>D31D4158CA17A <span class="comment"># 将GPG密钥添加到GitHub帐户。</span></span><br><span class="line"><span class="literal">-----BEGIN</span> PGP PUBLIC KEY BLOCK<span class="literal">-----</span></span><br><span class="line"></span><br><span class="line">mQINBGAbjUMBEACs4TK7P7WDFWfOjNrexw1XIId3F1lRAI8GzOuY0TM2qIP7CERl</span><br><span class="line"><span class="number">6</span>Z9XaXwtTDrtM6ScuvTkFLEl5gDwvuRjDX8iDUUZUgokOG1Z2mKri+z2ZfPGZCkc</span><br><span class="line">u3WYBRCZQxZCSrjugKEb4iUYc6TlGievFjwFXsTuNqR1gPxs0s739/xGLav68sXx</span><br><span class="line">VarbkBFiDe0T9H4HiZgmkEXVI52/ZF0DzZiUaZAaHiHWZtfFRttnd+ixgxzx14zv</span><br><span class="line">cj2pQOhyBbzWzI4877yWIWFAJmL2MWWONVmrYhnlhoknngZv1QCJqHRVz/EUNocR</span><br><span class="line">RLD4XQ17j01bT0y44klxe8v5cY4HB8UrHhxyfRFDH4FGIS8Rfl3LPdKa/rt5BVJr</span><br><span class="line">l9B6REkJOGIGXLMQcNJyiHWrltgkK27Sl6cSSwTUSCIkFz6iJAqMn5rkNgAoSV1U</span><br><span class="line">lpVLLodSQx3+zCEmTMU1y9iOoqUHCqaEZKrqX3vSEo2vuAp2V1/<span class="number">8</span>OZ4g77zCx4<span class="built_in">pS</span></span><br><span class="line">cniistF1bc53P4A9HWc2mveWbu59oLWjb7PIrN7IFz9ylvefNUXAfyi4Fq1C+DJ6</span><br><span class="line">bKWCPhRb+G7M6hOHIMlVgXCZRehD/gq9fgolxF9wMD93qBB9Zkst8Ra8MZF0mRV4</span><br><span class="line"><span class="number">9</span>GZIhCbLCebcBkjsvk/nj0O0G9U5cth6K9UjSdrXPxcSPg9U2bLGcUzADwARAQAB</span><br><span class="line">tBl6aGFvbHEgPGhlbGxvQHpoYW9scS5jb20+iQJOBBMBCAA4FiEEXHstIwJKglbL</span><br><span class="line">/pebRw0x1BWMoXoFAmAbjUMCGwMFCwkIBwIGFQoJCAsCBBYCAwECHgECF4AACgkQ</span><br><span class="line">Rw0x1BWMoXpTjA/+KeSr3gi6ORLIJ8O/<span class="number">9</span>WzaEcPz0f7I/lnt3BOb9Hu0ruoc5Pxb</span><br><span class="line"><span class="number">8</span>REZVtHCpSVQdgnL5hDc2M0+Za/<span class="number">2</span>Fzyg9Q/JbawuhEgmumWtpUhj6eghjnzutbkE</span><br><span class="line">ds/xDLCU3w9tmoIDGounsraUMAAD9f3v291Lt0rIsvGdXzZuWAqHZi1jqoixJtrg</span><br><span class="line">SnSby47DY6yobqcCjD0yduVCT4qZjRVvQbVu2blZS3qY1DDn2+X/hjXuAH7ZL4ZG</span><br><span class="line">aQd4AOrhz1VO0/PhTG+P25gB1m7vJjv8/vubHvDrje4L041p0hXEUYdjle70kcHT</span><br><span class="line">UQTdN11hqycLK4KQE8OI42/d/xkHg15C2+eNxfzZRlTeiQb9m2ENA1zZ+fbeq9KH</span><br><span class="line">yedarSkiebTQbTaHW/m31odTNxhvsv3MqSuS65DgzTU2ikbCX+cs4LIgMRHolDZi</span><br><span class="line">E9u/vb9A2K03h8md0uymcdzS/RqIiZTZmzYc1ZjCNPjiqZXiAgNecMheCq/rzMQ2</span><br><span class="line"><span class="number">7</span>xxdbwdcn/ollfilfFGJAqOZ0ShQdyQu3ijliLe2ZEqKahqYc5s6AJZI8huPs+hr</span><br><span class="line">/MLquoztvj64<span class="built_in">Ii</span>+k1rqIubdjcLmp6Xnwp/VdyTb3njc3V5eX4ohKHkV0Y+FEqk2m</span><br><span class="line">/<span class="number">7</span>p+RQ/F0wiGQ7XsO15Ei6gSREcGrXlyFbsuu3iX+<span class="number">3</span>YEcdFAJaZD39Z7y4y5Ag0E</span><br><span class="line">YBuNQwEQALX4+InJrGGfnxD9GGWWfKuzW9yiVHr2RPSZYT9GFhLZIrJxsTx+qvFA</span><br><span class="line">WIb45/Ga5/N2hGhrgrRhWfjvmW/rqTzwjoMgo+Qr1VJvB4XeB+IWHc6gD8yMJz5v</span><br><span class="line">G+R6C0YYgC9cWdUzJXuJajjHWANK7aEarldr0g2wr/Mm0R3hxKWBQCyPDY3WXs+<span class="number">4</span></span><br><span class="line"><span class="number">4</span>u9Oj2OYYGDW9OOayzoYIKyzH2urPi4HrYFbiWcE5aW6lQWiysi6qF5U2lBKP14S</span><br><span class="line">ArflkUNCO/zbvvPm3ZhdVlEbeFTKVy+O5OTy3YVR07ZkDy2oq1ip3eQr/xgmSlix</span><br><span class="line"><span class="number">7</span>Mx/Besl/YLwb4T4IcNoK5bcqDjG+<span class="number">2</span>PQMDyTL+NF0MR7na1BD772/TyfpHLXLCLD</span><br><span class="line"><span class="number">0</span>LZw/S89Xm6A3fBCRN6yEqZLS9jDYMp4LZ6eL025OxwDRYAKNADujkx3xRiS62CU</span><br><span class="line">xO/JrTKlNavWwMbI/Ri3RyzFCZre7hbG3MtauwdxnLiQs3SfXVVFTbCF1OV8sAsX</span><br><span class="line"><span class="built_in">H</span>+Bsj7QgSlOHY/eZJRysWSo+nFJF7kE+ro/RHMk3zOOPRsB7lKKGIy2o0HLXwoPt</span><br><span class="line">vrjmHt3vVwe6WEwoFCsTkNuiFU7VDjM8eN+wg1mEVIXmSS6PD0gGM79cA2W02gHM</span><br><span class="line">QGNhj2YUVDwjYbAXEQTlnQlM788nrEgTBjnVdBLXmKO5tlCTTdnLABEBAAGJAjYE</span><br><span class="line">GAEIACAWIQRcey0jAkqCVsv+l5tHDTHUFYyhegUCYBuNQwIbDAAKCRBHDTHUFYyh</span><br><span class="line">elfKEACL0P9TOjxkW9rkbJIZHIVOkIWVSSRECZecSiEah1PUa9jopdqKOPizNSQM</span><br><span class="line">UQ8JvlAntunorL8a6oJXSRsJmF9W5DEqM0nPB4BoEULjbpn0iIbmEFlFvP83aHe3</span><br><span class="line">x8N5o+huxo6FBPysdPPwrKiGkNubnyuMk07QRwX8RUqnYk1tLMIXXIkLl7J+<span class="number">2</span>sLz</span><br><span class="line">I8cHraEDY5+Gre9AbcXglQoDwbhY2Gpk0zI5n9pYgeul2GqErAUzDO2LzkOHgSZB</span><br><span class="line">ZMWAleGOxTb4xQ+HrQqfse3nhjNtEduLVP3/WLKOKjKNY/ubduCdxLtWqiMQ5SEj</span><br><span class="line">m1g0syiYcA8StyDq9eOVFenMrPx2BuRCAbPJ7m5GoLr+gifmqnZFP3Vh9n4TVF08</span><br><span class="line">tfZdkYwpIIBO0eL7CXwNt2Hz3RLjn4wijhXUGA7G0suO+i1bB2geU+sEIJYB0D1w</span><br><span class="line">iK89CYUfxMQFHSb7Fz4vsebllb/NT4XsKo/tHla/uf5hfHf+q5QNe3L8jzFR56CX</span><br><span class="line">qIF37z1tFo2ghfHxxpjVDjo8e1twUtWfglGhqkdFquAGCEYZdE+GE4v9YzdoDbqJ</span><br><span class="line">qc7k4HcYCYs+aFAwvWXXA4f/ZIsQtaIJAnyNVyPmZjmRkXztwc+<span class="number">2</span>BZeP04zoSvYr</span><br><span class="line">Kbp1Iyt64eFkB4KEY9j5TiMiv+<span class="number">1</span>K0Cpds87u3i4ngFArI1bjKA==</span><br><span class="line">=VnWZ</span><br><span class="line"><span class="literal">-----END</span> PGP PUBLIC KEY BLOCK<span class="literal">-----</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> F:\blog&gt; git config <span class="literal">--local</span> user.signingkey <span class="number">470</span>D31D4158CA17A <span class="comment"># 在Git中设置GPG签名密钥</span></span><br><span class="line"><span class="built_in">PS</span> F:\blog&gt; git config <span class="literal">--local</span> commit.gpgsign true <span class="comment"># Git客户端配置为默认对本地仓库的提交签名</span></span><br><span class="line"><span class="built_in">PS</span> F:\blog&gt; git config <span class="literal">--global</span> gpg.program <span class="string">&quot;D:\Program Files (x86)\GnuPG\bin\gpg.exe&quot;</span> <span class="comment"># 配置Git的gpg程序位置</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> F:\blog&gt; git commit <span class="literal">-S</span> <span class="literal">-am</span> <span class="string">&quot;update&quot;</span> <span class="comment"># 对提交签名，S大写</span></span><br><span class="line"><span class="built_in">PS</span> F:\blog&gt; git log <span class="literal">--show-signature</span> <span class="comment"># 查看及验证这些签名</span></span><br><span class="line"><span class="built_in">PS</span> F:\blog&gt; git log <span class="literal">--pretty</span>=<span class="string">&quot;format:%h %G? %aN  %s&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> F:\blog&gt; git tag <span class="literal">-s</span> mytag <span class="comment"># 对标记签名</span></span><br><span class="line"><span class="built_in">PS</span> F:\blog&gt; git tag <span class="literal">-v</span> mytag<span class="comment"># 验证您签名的标记</span></span><br></pre></td></tr></table></figure>

<p>github 提交记录会显示 Verified :</p>
<p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20210205114905816.png" alt="image-20210205114905816"></p>
<h3 id="备份-GnuPG-目录"><a href="#备份-GnuPG-目录" class="headerlink" title="备份 GnuPG 目录"></a>备份 GnuPG 目录</h3><p>备份整个 GnuPG 目录 <code>C:\Users\Administrator\AppData\Roaming\gnupg</code> 。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp -rp ~/.gnupg [/media/disk/name]/gnupg-backup</span><br><span class="line">cp C:\Users\Administrator\AppData\Roaming\gnupg\* G:\gnupg-backup</span><br></pre></td></tr></table></figure>

<p>现在，用如下的命令去测试一下，确保它们能够正常地工作：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --homedir=[/media/disk/name]/gnupg-backup --list-keys [fpr]</span><br></pre></td></tr></table></figure>

<p><font color="red">GPG 目录位置及配置文件：</font> <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/GnuPG_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E7%9B%AE%E5%BD%95%E4%BD%8D%E7%BD%AE">archlinux</a> </p>
<h3 id="使用-GPG-密钥进行-SSH-认证"><a href="#使用-GPG-密钥进行-SSH-认证" class="headerlink" title="使用 GPG 密钥进行 SSH 认证"></a>使用 GPG 密钥进行 SSH 认证</h3><p> <a target="_blank" rel="noopener" href="https://blog.hcl.moe/archives/2463">https://blog.hcl.moe/archives/2463</a> </p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/cumj63710/article/details/107413048">https://blog.csdn.net/cumj63710/article/details/107413048</a> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建身份验证子密钥</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">gpg --list-secret-keys --keyid-format LONG</span></span><br><span class="line">C:/Users/Administrator/AppData/Roaming/gnupg/pubring.kbx</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">sec   rsa4096/589DE5E731D03D76 2021-02-05 [SC]</span><br><span class="line">      68BC86DA54D229E8E48E9B69589DE5E731D03D76</span><br><span class="line">uid                 [ultimate] zhaolq &lt;hello@zhaolq.com&gt;</span><br><span class="line">ssb   rsa4096/9F4F8FE0C5CD582E 2021-02-05 [E]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">gpg --expert --edit-key 589DE5E731D03D76 <span class="comment"># --expert专家模式</span></span></span><br><span class="line">gpg (GnuPG) 2.2.25; Copyright (C) 2020 g10 Code GmbH</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"></span><br><span class="line">Secret key is available.</span><br><span class="line"></span><br><span class="line">sec  rsa4096/589DE5E731D03D76</span><br><span class="line">     created: 2021-02-05  expires: never       usage: SC</span><br><span class="line">     trust: ultimate      validity: ultimate</span><br><span class="line">ssb  rsa4096/9F4F8FE0C5CD582E</span><br><span class="line">     created: 2021-02-05  expires: never       usage: E</span><br><span class="line">[ultimate] (1). zhaolq &lt;hello@zhaolq.com&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">gpg&gt; </span><span class="language-bash">addkey</span></span><br><span class="line">Please select what kind of key you want:</span><br><span class="line">   (3) DSA (sign only)</span><br><span class="line">   (4) RSA (sign only)</span><br><span class="line">   (5) Elgamal (encrypt only)</span><br><span class="line">   (6) RSA (encrypt only)</span><br><span class="line">   (7) DSA (set your own capabilities)</span><br><span class="line">   (8) RSA (set your own capabilities)</span><br><span class="line">  (10) ECC (sign only)</span><br><span class="line">  (11) ECC (set your own capabilities)</span><br><span class="line">  (12) ECC (encrypt only)</span><br><span class="line">  (13) Existing key</span><br><span class="line">  (14) Existing key from card</span><br><span class="line">Your selection? 8</span><br><span class="line"></span><br><span class="line">Possible actions for a RSA key: Sign Encrypt Authenticate</span><br><span class="line">Current allowed actions: Sign Encrypt # 默认包含签名、加密功能</span><br><span class="line"></span><br><span class="line">   (S) Toggle the sign capability</span><br><span class="line">   (E) Toggle the encrypt capability</span><br><span class="line">   (A) Toggle the authenticate capability</span><br><span class="line">   (Q) Finished</span><br><span class="line"></span><br><span class="line">Your selection? s # 切换签名功能</span><br><span class="line"></span><br><span class="line">Possible actions for a RSA key: Sign Encrypt Authenticate</span><br><span class="line">Current allowed actions: Encrypt # 切换后，签名功能被移除，再次切换将添加。</span><br><span class="line"></span><br><span class="line">   (S) Toggle the sign capability</span><br><span class="line">   (E) Toggle the encrypt capability</span><br><span class="line">   (A) Toggle the authenticate capability</span><br><span class="line">   (Q) Finished</span><br><span class="line"></span><br><span class="line">Your selection? e # 切换加密功能</span><br><span class="line"></span><br><span class="line">Possible actions for a RSA key: Sign Encrypt Authenticate</span><br><span class="line">Current allowed actions:</span><br><span class="line"></span><br><span class="line">   (S) Toggle the sign capability</span><br><span class="line">   (E) Toggle the encrypt capability</span><br><span class="line">   (A) Toggle the authenticate capability</span><br><span class="line">   (Q) Finished</span><br><span class="line"></span><br><span class="line">Your selection? a # 切换身份验证功能</span><br><span class="line"></span><br><span class="line">Possible actions for a RSA key: Sign Encrypt Authenticate</span><br><span class="line">Current allowed actions: Authenticate # 只保留身份验证功能</span><br><span class="line"></span><br><span class="line">   (S) Toggle the sign capability</span><br><span class="line">   (E) Toggle the encrypt capability</span><br><span class="line">   (A) Toggle the authenticate capability</span><br><span class="line">   (Q) Finished</span><br><span class="line"></span><br><span class="line">Your selection? q # 完成退出</span><br><span class="line">RSA keys may be between 1024 and 4096 bits long.</span><br><span class="line">What keysize do you want? (3072) 4096</span><br><span class="line">Requested keysize is 4096 bits</span><br><span class="line">Please specify how long the key should be valid.</span><br><span class="line">         0 = key does not expire</span><br><span class="line">      &lt;n&gt;  = key expires in n days</span><br><span class="line">      &lt;n&gt;w = key expires in n weeks</span><br><span class="line">      &lt;n&gt;m = key expires in n months</span><br><span class="line">      &lt;n&gt;y = key expires in n years</span><br><span class="line">Key is valid for? (0) 0</span><br><span class="line">Key does not expire at all</span><br><span class="line">Is this correct? (y/N) y</span><br><span class="line">Really create? (y/N) y</span><br><span class="line">We need to generate a lot of random bytes. It is a good idea to perform</span><br><span class="line">some other action (type on the keyboard, move the mouse, utilize the</span><br><span class="line">disks) during the prime generation; this gives the random number</span><br><span class="line">generator a better chance to gain enough entropy.</span><br><span class="line"></span><br><span class="line">sec  rsa4096/589DE5E731D03D76</span><br><span class="line">     created: 2021-02-05  expires: never       usage: SC</span><br><span class="line">     trust: ultimate      validity: ultimate</span><br><span class="line">ssb  rsa4096/9F4F8FE0C5CD582E</span><br><span class="line">     created: 2021-02-05  expires: never       usage: E</span><br><span class="line">ssb  rsa4096/AC4513B607AD3D19</span><br><span class="line">     created: 2021-03-01  expires: never       usage: A</span><br><span class="line">[ultimate] (1). zhaolq &lt;hello@zhaolq.com&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">gpg&gt; </span><span class="language-bash">save</span></span><br><span class="line"><span class="meta prompt_">$ </span></span><br></pre></td></tr></table></figure>

<p> <font color="green"><strong>未完待续…</strong></font> </p>
<h1 id="PuTTY工具"><a href="#PuTTY工具" class="headerlink" title="PuTTY工具"></a>PuTTY工具</h1><p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/PuTTY">PuTTY - 维基百科</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.putty.org/">https://www.putty.org/</a> </p>
<p>PuTTY 包含多个工具：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pageant.exe   # SSH认证代理，(PuTTY、PSCP、PSFTP、Plink都会用到)</span><br><span class="line">plink.exe     # PuTTY后端的命令行接口</span><br><span class="line">pscp.exe      # SCP客户端</span><br><span class="line">psftp.exe     # SFTP客户端</span><br><span class="line">putty.exe     # telnet和SSH客户端</span><br><span class="line">puttygen.exe  # RSA和DSA密钥生成转换工具</span><br></pre></td></tr></table></figure>

<p>puttygen 使用的密钥存储格式类似于 OpenSSL（密钥文件扩展名.ppk，其中同时包含公钥和私钥）。</p>
<p>公钥格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---- BEGIN SSH2 PUBLIC KEY ----</span><br><span class="line">Comment: &quot;&quot;</span><br><span class="line">AAAAB3NzaC1yc2EAAAABJQAAAEEAhqCvOfHc/GBBoTkJhSkqkqFOxCLFT9DHl/6a</span><br><span class="line">dovX5wYcgwp1RXO7QC4XScHkOo06boRRtEySR4J8nijsKFjijw==</span><br><span class="line">---- END SSH2 PUBLIC KEY ----</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 前面加 ssh-rsa 即为 OpenSSH 公钥 (用于配置SSH连接)</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAEEAhqCvOfHc/GBBoTkJhSkqkqFOxCLFT9DHl/<span class="number">6</span>adovX5wYcgwp1RXO7QC4XScHkOo06boRRtEySR4J8nijsKFjijw==</span><br></pre></td></tr></table></figure>

<p>私钥格式 (.ppk)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PuTTY-User-Key-File-2: ssh-rsa</span><br><span class="line">Encryption: none</span><br><span class="line">Comment: </span><br><span class="line">Public-Lines: 2</span><br><span class="line">AAAAB3NzaC1yc2EAAAABJQAAAEEAhqCvOfHc/GBBoTkJhSkqkqFOxCLFT9DHl/6a</span><br><span class="line">dovX5wYcgwp1RXO7QC4XScHkOo06boRRtEySR4J8nijsKFjijw==</span><br><span class="line">Private-Lines: 4</span><br><span class="line">AAAAQFr28u/M70K9lCDTgvkb0KhDemjZOTXt7qT4Iy2BFVbncROWVteOUUSKl1B8</span><br><span class="line">NBsbVpU5eo1/vMu6f7jnMgY0WfUAAAAhAO99bZ1eTv0fhGSoGRgjspEpV+JsnCWH</span><br><span class="line">vqVRGkM6Khv1AAAAIQCP6J+fDoVQF2Gz91dgQKf17XD3V4z5K9jIWh7kA7hV8wAA</span><br><span class="line">ACA+w2FZsWTlS6mhqUZunVvTUwwZtwKzDhnW40TrfWylGw==</span><br><span class="line">Private-MAC: 69c717a3b3062220562d33c5b8c3e82949be8642</span><br></pre></td></tr></table></figure>



<p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20201207180058631.png" alt="image-20201207180058631"></p>
<p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20201209172045671.png" alt="image-20201209172045671"></p>
<p> <code>Export OpenSSH key</code> 导出旧格式（以 <code>-----BEGIN RSA PRIVATE KEY-----</code> 开头）的 OpenSSH 密钥。<font color="red"><strong>多次导出的密钥总是一致的。</strong></font> </p>
<p> <code>Export OpenSSH key (force new file format)</code> 导出新格式（以 <code>-----BEGIN OPENSSH PRIVATE KEY-----</code> 开头）的 OpenSSH 密钥。<font color="red"><strong>每次导出的密钥都略有不同</strong>，多次实践后<strong>猜测：时间和工具都是导致密钥不同的因素</strong>。但是，<strong>这些的密钥都是合法的。</strong></font> </p>
<p> <code>save private key</code> 保存 PuTTY 的密钥格式 ( <code>.ppk</code> )。</p>
<p> <code>save public key</code> 保存 SSH2 公钥。程序主界面中显示的是 OpenSSH 格式公钥。</p>
<h1 id="MobaXterm工具"><a href="#MobaXterm工具" class="headerlink" title="MobaXterm工具"></a>MobaXterm工具</h1><p>SSH key generator：</p>
<p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20201208092705620.png" alt="image-20201208092705620"></p>
<h1 id="在线工具"><a href="#在线工具" class="headerlink" title="在线工具"></a>在线工具</h1><p><font color="blue"><strong>一般在线生成的公钥和私钥都是 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail">pem</a> 格式 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/PKCS_8">PKCS#8</a> 标准。</strong></font> </p>
<p> <a target="_blank" rel="noopener" href="https://www.ssleye.com/pass_double.html">https://www.ssleye.com/pass_double.html</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.devglan.com/online-tools/rsa-encryption-decryption">https://www.devglan.com/online-tools/rsa-encryption-decryption</a> </p>
<p><img src="/article/2020/12/%E5%85%AC%E7%A7%81%E9%92%A5%E5%92%8C%E8%AF%81%E4%B9%A6%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86/image-20201208141647141.png" alt="image-20201208141647141"></p>
<p>在 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/PKCS_8">PKCS#8</a> 标准的私钥开头和结尾加入 <code>-----BEGIN PRIVATE KEY-----</code> 、 <code>-----END PRIVATE KEY-----</code> 就成了 <strong>PEM 文件格式</strong> ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAI/LbpFa8A4P9uUkt3kSNysEL1MVBLnsFO16cVIfjiYpLfmwrZMN8Z6RRu0OeYTu83+0BV68ghZoHpDLUw1waWG6P74wgx7KTz1CzlR1ex3dTXhd04UGqHW5EvG7l0oxtBqeH9S2kb/3ubNJ9W3JXa8iC+mNbWM1C8AKbKH0zrkVAgMBAAECgYBYp5419BFJOkKIqIiOFtL4rI3Y9X6CerG0cOdpMJddo8n6xhleLxynHP7TrTby5LgwJfehnyu9UNh3gURlZscxSTuh3+jCAEZn5yZB3+hJLMt0T9VN+NOmPA3UBLuNIc0qJhkFB8NQ5sFKJvQB9n35AJsqImqJjTINObrzLPVGQQJBAP//o07VnH2YZJP+otYpUICN0zTAZxWKsWceDhE85LS9KNOrpnNjP68GRL2wfd0G5vL0IFcDqtYoYCjQTya8oQkCQQCPy6KiDP0Kc/c5RUChbAZtaFHTRDhFrMG5cYMOJJt1rTxAqGRwuGzIQzVSiZXAHcORYkBDS6a1XDgH+n3P7jatAkBBxaZprMxGII9Gztd7eqXqQYYQOZbCnB20Rq6Kk0CXhzokGCft4YQNLekfa2cLEKjppvtgH9sWpsz973dGlpQxAkA/WA9On7YgkrFHk1BDS9kQ/TF+hcDcQJweWvjGlC2/iw7N1OBaH4QcPC8TKvTC6tmqA8QXYQ4ROoycRyaBIIkJAkEA0+kdSBFoD8oh+yvTOQJKrgTO69h6b0TdT2o4bALo+EeNgCEAJMILK78Qa81QjMOOZ3xn9Vlw2Uo01YSzIoVh3Q==</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<h1 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h1><p><font color="blue"><strong>目前主流的密钥（或者说私钥）格式有两种：</strong></font> </p>
<ul>
<li><font color="red"> <strong>OpenSSH 的密钥格式 ( pem 或无后缀)</strong></font> : <font color="blue"> <strong>新文件格式以 <code>-----BEGIN OPENSSH PRIVATE KEY-----</code> 开头；旧文件格式以 <code>-----BEGIN RSA PRIVATE KEY-----</code> 开头，使用 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/PKCS_1">PKCS#1</a> 标准。</strong></font> </li>
<li><font color="red"> <strong>PuTTY 的密钥格式 ( ppk )</strong></font> ：<code>ppk</code> 是 PuTTY Private Key 的缩写。</li>
</ul>
<p> <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A0%87%E5%87%86">公钥密码学标准 (PKCS) - 维基百科</a> ：公开密钥密码<font color="red">编译标准</font>。</p>
<p> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/PKCS_1">PKCS 1 - 维基百科</a> ：定义了<font color="red">RSA公钥和私钥</font>必须具有的数学定义和属性（<font color="red">专为 RSA 密钥定义的</font>）。多用于JS等其它程序加解密，属于比较<font color="red">旧的</font>格式标准。</p>
<p> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/PKCS_8">PKCS 8 - 维基百科</a> ：与 PKCS#1 相比，从本质上说，PKCS#8 格式增加验证数据段，保证密钥正确性。多用于JAVA、PHP程序加解密中，为目前用的比较多的密钥、证书格式，也用于微信RSA等程序；</p>
<p>  <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/ASN.1">ASN.1 - 维基百科</a> </p>
<h2 id="PEM格式"><a href="#PEM格式" class="headerlink" title="PEM格式"></a>PEM格式</h2><p> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail">Privacy-Enhanced Mail (PEM) - 维基百科</a> ：是公私钥和证书常用的一种<font color="red"><strong>文件编码格式 (存储格式)</strong></font>。用 BEGIN 和 END 标签确定已编码消息的类型，中间存放 Base64 编码的二进制数据。</p>
<h2 id="PEM格式-PKCS-1-结构标准-老"><a href="#PEM格式-PKCS-1-结构标准-老" class="headerlink" title="PEM格式 PKCS#1 结构标准-老"></a>PEM格式 PKCS#1 结构标准-老</h2><p>PEM 格式 PKCS#1 标准：<font color="red">仅支持 <strong>RSA 私钥</strong>，以 <code>-----BEGIN RSA PRIVATE KEY-----</code> 开头，不支持密码保护。</font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">私钥</span></span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIBOAIBAAJBAISRPuae1mSLzVrxMmfvUtY1+2LLXmCn1z1Oe+MDKDR1jmqba/6V</span><br><span class="line">aXYWwW3L7KC7BAc2io7T1L/dPS6KObrLIK8CASUCQDIpHrggbMwZOPH6Zhl9JkM3</span><br><span class="line">BSxM80cqwCUI8JsV84l4B0wdaREMjV4Gf/SSdME/upFLbEQqlY3edVgi4BXf640C</span><br><span class="line">IQDqQv9SqOLhDkMqDZG9b8/PHT7MhWmnFzZ/Jptciojf5wIhAJDecvFffxLKwmnH</span><br><span class="line">kozpC+xp+Y2eZ1lD/2NV29YbBL/5AiEA0O+lczyurQy4cZ1mTwLb8BMqLAhJeVnk</span><br><span class="line">fz4b3OpCudsCIFYjZvBiS46iErtvvuwAMJpohouOnlDApbCvl3hjF5S9AiAysGca</span><br><span class="line">+E16TkxCeXu84WJ59C1PZSOE4w+cQHOO9+3xqg==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">公钥</span></span><br><span class="line">-----BEGIN RSA PUBLIC KEY-----</span><br><span class="line">MIICCgKCAgEArKlXb4I1tgh2P0fUuYzpGUHCYcxC3EkGuEdhLVWsYxmypSy5RfTb</span><br><span class="line">soolk3UlzuevW6SYB6KDdBautb9VKNx9QUWJKFG7bYFxhGXUFIF72W6CvKpzFs/G</span><br><span class="line">Uqp9GinG4EzyRhrhKVOzV3tr0C0fl2gm2azDYtIw7gGVvcVoebCrCfiQUGX7i1Hk</span><br><span class="line">BH/s2sTi9rBaBzq6/W1SKEiBrhiik+vApE80A+6e1OAljmGmagbKgmvCjDPeFJPE</span><br><span class="line">PVakiTiBlcHZ+wckXbeCzuGu7ZqA5AKExrebSb3K7kLHbKyvA9fMXiWdV/ofGnek</span><br><span class="line">EURsPzNyo5S16T/kTBnN3VMjEqelTJecru1LjsbbAyOi/Sox+HcNi0LqrHHzzj4A</span><br><span class="line">LysZhU+FyLQRUYziUjRzxHEE//tAI7b2/KObe58ENlQndoPrjmovhRVecQzQR2k4</span><br><span class="line">kVVY/xHWYymk4jtgmsw7wvGomyu8fGq6AMri1tiXOcU6VGllBxeAMFaMOpOtf20q</span><br><span class="line">mpteVKNOlVSrCGC+akVpzlLvURae7dKY85xRZHxNCO/mEbYpDzLg1B8k+qWnR2eg</span><br><span class="line">eEt8q2x8i3P9gz96QPnfTvD8lAXQQzijVKKXvvo63S/9DLG7BS4P/7CoQhFEW5TM</span><br><span class="line">EWtFyBC7vFSWordrOz0P4qmyFit2EhoKReHxpLT0PIpwG/pLKVON1A0CAwEAAQ==</span><br><span class="line">-----END RSA PUBLIC KEY-----</span><br></pre></td></tr></table></figure>

<p>OpenSSL生成的 密钥文件(.pem)、签发请求文件(.csr)、证书文件(.cer) 都是用 <strong>PEM文件格式</strong> 。</p>
<p>扩展名可能为 <code>.pem</code>、<code>.crt</code>、<code>.cer</code>、<code>.key</code>。</p>
<h2 id="PEM格式-PKCS-8-结构标准-新"><a href="#PEM格式-PKCS-8-结构标准-新" class="headerlink" title="PEM格式 PKCS#8 结构标准-新"></a>PEM格式 PKCS#8 结构标准-新</h2><p>PEM 格式 PKCS#8 标准：<font color="red">支持 <strong>任意算法私钥</strong>（如 RSA、ECDSA、ED25519 等），以 <code>-----BEGIN PRIVATE KEY-----</code> 开头，可封装为加密格式：<code>ENCRYPTED PRIVATE KEY</code>。</font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">私钥</span></span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIIBUgIBADANBgkqhkiG9w0BAQEFAASCATwwggE4AgEAAkEAhJE+5p7WZIvNWvEy</span><br><span class="line">Z+9S1jX7YsteYKfXPU574wMoNHWOaptr/pVpdhbBbcvsoLsEBzaKjtPUv909Loo5</span><br><span class="line">ussgrwIBJQJAMikeuCBszBk48fpmGX0mQzcFLEzzRyrAJQjwmxXziXgHTB1pEQyN</span><br><span class="line">XgZ/9JJ0wT+6kUtsRCqVjd51WCLgFd/rjQIhAOpC/1Ko4uEOQyoNkb1vz88dPsyF</span><br><span class="line">aacXNn8mm1yKiN/nAiEAkN5y8V9/EsrCaceSjOkL7Gn5jZ5nWUP/Y1Xb1hsEv/kC</span><br><span class="line">IQDQ76VzPK6tDLhxnWZPAtvwEyosCEl5WeR/Phvc6kK52wIgViNm8GJLjqISu2++</span><br><span class="line">7AAwmmiGi46eUMClsK+XeGMXlL0CIDKwZxr4TXpOTEJ5e7zhYnn0LU9lI4TjD5xA</span><br><span class="line">c4737fGq</span><br><span class="line">-----END PRIVATE KEY-----</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">公钥</span></span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEArKlXb4I1tgh2P0fUuYzp</span><br><span class="line">GUHCYcxC3EkGuEdhLVWsYxmypSy5RfTbsoolk3UlzuevW6SYB6KDdBautb9VKNx9</span><br><span class="line">QUWJKFG7bYFxhGXUFIF72W6CvKpzFs/GUqp9GinG4EzyRhrhKVOzV3tr0C0fl2gm</span><br><span class="line">2azDYtIw7gGVvcVoebCrCfiQUGX7i1HkBH/s2sTi9rBaBzq6/W1SKEiBrhiik+vA</span><br><span class="line">pE80A+6e1OAljmGmagbKgmvCjDPeFJPEPVakiTiBlcHZ+wckXbeCzuGu7ZqA5AKE</span><br><span class="line">xrebSb3K7kLHbKyvA9fMXiWdV/ofGnekEURsPzNyo5S16T/kTBnN3VMjEqelTJec</span><br><span class="line">ru1LjsbbAyOi/Sox+HcNi0LqrHHzzj4ALysZhU+FyLQRUYziUjRzxHEE//tAI7b2</span><br><span class="line">/KObe58ENlQndoPrjmovhRVecQzQR2k4kVVY/xHWYymk4jtgmsw7wvGomyu8fGq6</span><br><span class="line">AMri1tiXOcU6VGllBxeAMFaMOpOtf20qmpteVKNOlVSrCGC+akVpzlLvURae7dKY</span><br><span class="line">85xRZHxNCO/mEbYpDzLg1B8k+qWnR2egeEt8q2x8i3P9gz96QPnfTvD8lAXQQzij</span><br><span class="line">VKKXvvo63S/9DLG7BS4P/7CoQhFEW5TMEWtFyBC7vFSWordrOz0P4qmyFit2EhoK</span><br><span class="line">ReHxpLT0PIpwG/pLKVON1A0CAwEAAQ==</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>

<h2 id="OpenSSH公钥"><a href="#OpenSSH公钥" class="headerlink" title="OpenSSH公钥"></a>OpenSSH公钥</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDNk6kAECG4G4Ukpvqgew2ihAfRqueAlGu/jIBVndFnhseiLXeK0SPS7IIvH45AeTYE3eViqj1ehUHJC6pA5CLNraSK7GV3lG6F3IihWv702ucT5/jp1jm5z5qHHyZqC2OYgOkJJZ3/2HfuF+Dxpw29MSH6v/qKBs0KSwV0Dyfhqw== hello@zhaolq.com</span><br></pre></td></tr></table></figure>

<h2 id="SSH2公钥"><a href="#SSH2公钥" class="headerlink" title="SSH2公钥"></a>SSH2公钥</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---- BEGIN SSH2 PUBLIC KEY ----</span><br><span class="line">Comment: &quot;1024-bit RSA, converted by root@zlq from OpenSSH&quot;</span><br><span class="line">AAAAB3NzaC1yc2EAAAADAQABAAAAgQC90f/TqKJEeHfZtTOWzUw8oi7m8VnXFyCfT4oQkN</span><br><span class="line">Z35376K19zvHtGQPv2JZPTgRJ9GHoP454MBBMbAbDBeh4V1Wgzu1U63vLH2xGekSXpr0+4</span><br><span class="line">K0fg/04PD5aU5xnDuTVtdydDP6wfs0phdddyPaakBCo/JuFpgUxQJxFCO/a4sQ==</span><br><span class="line">---- END SSH2 PUBLIC KEY ----</span><br></pre></td></tr></table></figure>

<h2 id="DER格式"><a href="#DER格式" class="headerlink" title="DER格式"></a>DER格式</h2><p>所有类型的证书和私钥都能用 DER 格式存放。文件中直接存储二进制数据，未进行Base64编码，无可读性的描述文字。</p>
<p>Java 和 Windows 服务器偏向于使用这种编码格式.</p>
<p>扩展名可能为 <code>.der</code>、<code>.cer</code>、<code>crt</code>。</p>
<h2 id="P7B-PKCS-7文件-PEM"><a href="#P7B-PKCS-7文件-PEM" class="headerlink" title="P7B&#x2F;PKCS#7文件 (PEM)"></a>P7B&#x2F;PKCS#7文件 (PEM)</h2><p>包含 <code>-----BEGIN PKCS-----</code> 、 <code>-----END PKCS7-----</code> 字符串，只能存储证书和链证书，不能存放私钥。可以包含多个证书。内容经过 Base64 编码。</p>
<p>扩展名可能为 <code>.p7b</code>、<code>.p7c</code>。</p>
<h2 id="PFX-PKCS-12文件-PEM"><a href="#PFX-PKCS-12文件-PEM" class="headerlink" title="PFX&#x2F;PKCS#12文件 (PEM)"></a>PFX&#x2F;PKCS#12文件 (PEM)</h2><p>可以加密的文件，可在一个文件中存放多个证书或密钥，主要用于证书和私钥的导入导出。</p>
<p>扩展名一般为 <code>.pfx</code>、<code>.p12</code>。</p>
<h1 id="格式转换"><a href="#格式转换" class="headerlink" title="格式转换"></a>格式转换</h1><h2 id="PKCS-1与PKCS-8转换"><a href="#PKCS-1与PKCS-8转换" class="headerlink" title="PKCS#1与PKCS#8转换"></a>PKCS#1与PKCS#8转换</h2><p>利用在线工具： <a target="_blank" rel="noopener" href="https://www.ssleye.com/pkcs.html">https://www.ssleye.com/pkcs.html</a> </p>
<p>支持公钥、私钥的PKCS1与PKCS8之间的相互转换，及PEM格式输出：</p>
<h2 id="SSH2公钥与OpenSSH公钥转换"><a href="#SSH2公钥与OpenSSH公钥转换" class="headerlink" title="SSH2公钥与OpenSSH公钥转换"></a>SSH2公钥与OpenSSH公钥转换</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -e -f openssh.pub &gt; ssh2.pub <span class="comment"># OpenSSH公钥转换为SSH2公钥</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -i -f ssh2.pub &gt; openssh.pub <span class="comment"># SSH2公钥转换为OpenSSH公钥</span></span></span><br></pre></td></tr></table></figure>

<p>SSH2公钥：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---- BEGIN SSH2 PUBLIC KEY ----</span><br><span class="line">Comment: &quot;&quot;</span><br><span class="line">AAAAB3NzaC1yc2EAAAABJQAAAEEAhqCvOfHc/GBBoTkJhSkqkqFOxCLFT9DHl/6a</span><br><span class="line">dovX5wYcgwp1RXO7QC4XScHkOo06boRRtEySR4J8nijsKFjijw==</span><br><span class="line">---- END SSH2 PUBLIC KEY ----</span><br></pre></td></tr></table></figure>

<p>OpenSSH公钥 (用于配置SSH连接)：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAEEAhqCvOfHc/GBBoTkJhSkqkqFOxCLFT9DHl/<span class="number">6</span>adovX5wYcgwp1RXO7QC4XScHkOo06boRRtEySR4J8nijsKFjijw==</span><br></pre></td></tr></table></figure>

<h2 id="ppk与pem-PKCS-1-转换"><a href="#ppk与pem-PKCS-1-转换" class="headerlink" title="ppk与pem(PKCS#1)转换"></a>ppk与pem(PKCS#1)转换</h2><p>利用putty工具</p>
<h2 id="PEM转DER"><a href="#PEM转DER" class="headerlink" title="PEM转DER"></a>PEM转DER</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">转换私钥格式(PEM-&gt;DER)</span></span><br><span class="line">openssl pkey -in key.pem -outform DER -out keyout.der</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将证书从PEM转换为DER格式</span></span><br><span class="line">openssl x509 -in cert.pem -inform PEM -out cert.der -outform DER</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将CRL文件从PEM转换为DER</span></span><br><span class="line">openssl crl -in /home/crl.pem -outform DER -out /home/crl.der</span><br></pre></td></tr></table></figure>

<h2 id="DER转PEM"><a href="#DER转PEM" class="headerlink" title="DER转PEM"></a>DER转PEM</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">转换私钥格式(DER-&gt;PEM)</span></span><br><span class="line">openssl pkey -in key.der -inform der -out keyout.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将证书从DER转换为PEM格式</span></span><br><span class="line">openssl x509 -in cert.der -inform DER -out cert2.pem -outform PEM</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将CRL文件从DER转换为PEM</span></span><br><span class="line">openssl crl -inform DER -in /home/crl.der -out /home/crl2.pem</span><br></pre></td></tr></table></figure>

<h2 id="PEM证书格式转P7B"><a href="#PEM证书格式转P7B" class="headerlink" title="PEM证书格式转P7B"></a>PEM证书格式转P7B</h2><p>openssl-crl2pkcs7 命令</p>
<h2 id="P7B证书格式转PEM"><a href="#P7B证书格式转PEM" class="headerlink" title="P7B证书格式转PEM"></a>P7B证书格式转PEM</h2><p>openssl-pkcs7 命令</p>
<h2 id="PEM证书格式转PFX"><a href="#PEM证书格式转PFX" class="headerlink" title="PEM证书格式转PFX"></a>PEM证书格式转PFX</h2><p>openssl-pkcs12 命令</p>
<h2 id="PFX证书格式转PEM"><a href="#PFX证书格式转PEM" class="headerlink" title="PFX证书格式转PEM"></a>PFX证书格式转PEM</h2><p>openssl-pkcs12 命令</p>
<h2 id="P7B证书格式转PFX-先转成PEM"><a href="#P7B证书格式转PFX-先转成PEM" class="headerlink" title="P7B证书格式转PFX (先转成PEM)"></a>P7B证书格式转PFX (先转成PEM)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs7 -print_certs -inform PEM -in p7b.pem -out cert.pem</span><br><span class="line">openssl pkcs12 -export -in cert.pem -inkey privatekey.pem -out cert.pfx -certfile cert2.pem</span><br></pre></td></tr></table></figure>



    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="zhaolq 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="zhaolq 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/article/2020/12/07-%E8%A1%A5%E5%85%852%EF%BC%9A%E4%BD%BF%E7%94%A8OQL%E8%AF%AD%E8%A8%80%E6%9F%A5%E8%AF%A2%E5%AF%B9%E8%B1%A1%E4%BF%A1%E6%81%AF/" rel="prev" title="07-补充2：使用OQL语言查询对象信息">
                  <i class="fa fa-angle-left"></i> 07-补充2：使用OQL语言查询对象信息
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/article/2020/12/%E4%BD%BF%E7%94%A8OpenSSL%E6%9E%84%E5%BB%BA%E7%A7%81%E6%9C%89CA/" rel="next" title="使用OpenSSL构建私有CA">
                  使用OpenSSL构建私有CA <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">zhaolq</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
