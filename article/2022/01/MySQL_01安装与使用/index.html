<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.zhaolq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"androidstudio","dark":"androidstudio"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":true,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="了解几种安装方式：  dnf&#x2F;apt：傻瓜式，安装后文件分散 rpm&#x2F;deb包：掌握，安装后文件分散 通用二进制文件：二进制GLIBC。掌握，无需编译，推荐 源码编译：了解">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL_01安装与使用">
<meta property="og:url" content="https://blog.zhaolq.com/article/2022/01/MySQL_01%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="洋蔥">
<meta property="og:description" content="了解几种安装方式：  dnf&#x2F;apt：傻瓜式，安装后文件分散 rpm&#x2F;deb包：掌握，安装后文件分散 通用二进制文件：二进制GLIBC。掌握，无需编译，推荐 源码编译：了解">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.zhaolq.com/article/2022/01/MySQL_01%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/image-20240927194202683.png">
<meta property="article:published_time" content="2022-01-01T01:00:00.000Z">
<meta property="article:modified_time" content="2022-01-01T01:00:00.000Z">
<meta property="article:author" content="zhaolq">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.zhaolq.com/article/2022/01/MySQL_01%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/image-20240927194202683.png">


<link rel="canonical" href="https://blog.zhaolq.com/article/2022/01/MySQL_01%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.zhaolq.com/article/2022/01/MySQL_01%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/","path":"article/2022/01/MySQL_01安装与使用/","title":"MySQL_01安装与使用"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MySQL_01安装与使用 | 洋蔥</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>



  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">洋蔥</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">贪婪，找不到比这更好的词了，是件好事。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%89%8D"><span class="nav-number">1.</span> <span class="nav-text">安装前</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">1.1.</span> <span class="nav-text">关闭防火墙</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CentOS%E7%A6%81%E7%94%A8SELinux"><span class="nav-number">1.2.</span> <span class="nav-text">CentOS禁用SELinux</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A6%81%E7%94%A8swap%E5%88%86%E5%8C%BA"><span class="nav-number">1.3.</span> <span class="nav-text">禁用swap分区</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8RPM%E5%8C%85%E5%AE%89%E8%A3%85"><span class="nav-number">2.</span> <span class="nav-text">使用RPM包安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%80%9A%E7%94%A8%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AE%89%E8%A3%85%EF%BC%88%E4%BD%BF%E7%94%A8%E4%B8%AD%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">使用通用二进制文件安装（使用中）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD"><span class="nav-number">3.1.</span> <span class="nav-text">下载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%B8%E8%BD%BD%E6%97%A7%E7%89%88%E6%9C%AC"><span class="nav-number">3.2.</span> <span class="nav-text">卸载旧版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="nav-number">3.3.</span> <span class="nav-text">安装依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E5%8E%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8C%85"><span class="nav-number">3.4.</span> <span class="nav-text">解压二进制包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E7%9B%AE%E5%BD%95"><span class="nav-number">3.5.</span> <span class="nav-text">创建数据目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E5%B9%B6%E8%B5%8B%E4%BA%88%E6%9D%83%E9%99%90"><span class="nav-number">3.6.</span> <span class="nav-text">创建用户并赋予权限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">3.7.</span> <span class="nav-text">创建配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE%E7%9B%AE%E5%BD%95"><span class="nav-number">3.8.</span> <span class="nav-text">初始化数据目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8"><span class="nav-number">3.9.</span> <span class="nav-text">启动</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%AE%9E%E4%BE%8B"><span class="nav-number">3.9.1.</span> <span class="nav-text">单实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%AE%9E%E4%BE%8B"><span class="nav-number">3.9.2.</span> <span class="nav-text">多实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A6%96%E6%AC%A1%E7%99%BB%E5%BD%95-%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE-%E5%AF%86%E7%A0%81%E8%AE%BE%E7%BD%AE"><span class="nav-number">3.10.</span> <span class="nav-text">首次登录&#x2F;远程访问&#x2F;密码设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E7%BD%AERoot%E5%AF%86%E7%A0%81"><span class="nav-number">3.11.</span> <span class="nav-text">重置Root密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E5%90%AF%E5%81%9C%EF%BC%88%E5%A4%9A%E5%AE%9E%E4%BE%8B%EF%BC%89"><span class="nav-number">3.12.</span> <span class="nav-text">自动启停（多实例）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#systemd"><span class="nav-number">3.12.1.</span> <span class="nav-text">systemd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#service"><span class="nav-number">3.12.2.</span> <span class="nav-text">service</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E8%87%AA%E5%90%AF%E5%8A%A8%E5%8C%BA%E5%88%AB"><span class="nav-number">3.12.3.</span> <span class="nav-text">两种自启动区别</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhaolq"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">zhaolq</p>
  <div class="site-description" itemprop="description">有用、有趣、有情义！</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">554</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hellozhaolq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hellozhaolq" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hello.zhaolq@qq.com" title="E-Mail → mailto:hello.zhaolq@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaolq.com/article/2022/01/MySQL_01%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zhaolq">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洋蔥">
      <meta itemprop="description" content="有用、有趣、有情义！">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MySQL_01安装与使用 | 洋蔥">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL_01安装与使用
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-01-01 09:00:00" itemprop="dateCreated datePublished" datetime="2022-01-01T09:00:00+08:00">2022-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Database/" itemprop="url" rel="index"><span itemprop="name">Database</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>了解几种安装方式：</p>
<ul>
<li>dnf&#x2F;apt：傻瓜式，安装后文件分散</li>
<li>rpm&#x2F;deb包：掌握，安装后文件分散</li>
<li>通用二进制文件：二进制GLIBC。掌握，无需编译，<font color="red"><strong>推荐</strong></font></li>
<li>源码编译：了解</li>
</ul>
<span id="more"></span>

<h1 id="安装前"><a href="#安装前" class="headerlink" title="安装前"></a>安装前</h1><h2 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">centos</span></span><br><span class="line">firewall-cmd --state</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ubuntu</span></span><br><span class="line">ufw status</span><br><span class="line">ufw disable # 临时关闭</span><br><span class="line">systemctl stop ufw</span><br><span class="line">systemctl disable ufw</span><br></pre></td></tr></table></figure>

<h2 id="CentOS禁用SELinux"><a href="#CentOS禁用SELinux" class="headerlink" title="CentOS禁用SELinux"></a>CentOS禁用SELinux</h2><p>编辑 <code>vim /etc/selinux/config</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SELINUX=permissive # 设置 secure Linux 为宽松</span></span><br><span class="line"><span class="attr">SELINUX</span>=<span class="string">disabled # 禁用</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 更改完成后，请重新启动服务器或运行以下命令。</span></span><br><span class="line"><span class="attr">setenforce</span> <span class="string">Permissive</span></span><br></pre></td></tr></table></figure>

<h2 id="禁用swap分区"><a href="#禁用swap分区" class="headerlink" title="禁用swap分区"></a>禁用swap分区</h2><p><font color="red"><strong>请禁用交换分区</strong></font> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -m -s 5 # -m 以MB为单位显示内存使用情况；-s&lt;间隔秒数&gt; 　持续观察内存使用状况。</span><br></pre></td></tr></table></figure>

<h1 id="使用RPM包安装"><a href="#使用RPM包安装" class="headerlink" title="使用RPM包安装"></a>使用<code>RPM包</code>安装</h1><p><font color="red"><strong>官方doc：</strong></font> <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/linux-installation.html">https://dev.mysql.com/doc/refman/8.4/en/linux-installation.html</a></p>
<p>安装文件布局请参阅： <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/linux-installation-rpm.html">https://dev.mysql.com/doc/refman/8.4/en/linux-installation-rpm.html</a> </p>
<p><strong>RPM Bundle</strong>：<code>mysql-8.4.6-1.el8.x86_64.rpm-bundle.tar</code>，包含MySQL所有组件。</p>
<h1 id="使用通用二进制文件安装（使用中）"><a href="#使用通用二进制文件安装（使用中）" class="headerlink" title="使用通用二进制文件安装（使用中）"></a>使用<code>通用二进制文件</code>安装（<font color="red"><strong>使用中</strong></font>）</h1><p><font color="red"><strong>官方doc：</strong></font> <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/binary-installation.html">https://dev.mysql.com/doc/refman/8.4/en/binary-installation.html</a> </p>
<h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>官网下载 <strong>MySQL Community Server</strong>：<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/">https://dev.mysql.com/downloads/</a></p>
<p><strong>Compressed TAR Archive</strong>：<code>mysql-8.4.6-linux-glibc2.28-x86_64.tar.xz</code>，常规二进制发行版。<font color="red"><strong>本文使用</strong></font></p>
<p><strong>Compressed TAR Archive, Minimal Install</strong>：<code>mysql-8.4.6-linux-glibc2.28-x86_64-minimal.tar.xz</code> ，最小安装，不包括调试二进制文件，并去掉了调试符号。</p>
<p><strong>TAR</strong>：<code>mysql-8.4.6-linux-glibc2.28-x86_64.tar</code>。</p>
<p>查看操作系统 glibc 版本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Linux发行版通用</span></span><br><span class="line">ldd --version</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">centos</span></span><br><span class="line">rpm -qa | grep glibc</span><br></pre></td></tr></table></figure>

<p><img src="/article/2022/01/MySQL_01%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/image-20240927194202683.png" alt="image-20240927194202683"></p>
<h2 id="卸载旧版本"><a href="#卸载旧版本" class="headerlink" title="卸载旧版本"></a>卸载旧版本</h2><p>如果您之前曾通过操作系统自带的包管理工具（如dnf或apt）安装过MySQL，那么在使用原生二进制文件进行安装时可能会遇到问题。请确保之前安装的 MySQL 已被完全卸载（使用包管理系统），并且任何额外的文件（如旧版本的数据文件）也已删除。您还应检查配置文件（如 &#x2F;etc&#x2F;my.cnf 或 &#x2F;etc&#x2F;mysql 目录）并将其删除。</p>
<p>centos</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rpm -qa，列出系统中所有已安装的 RPM 包。-q → query（查询）；-a → all（所有包）；</span></span><br><span class="line">rpm -qa | grep -iE &#x27;mysql|mariadb&#x27; # grep -iE，-i 忽略大小写；-E 启用扩展正则表达式</span><br><span class="line">dnf list installed | grep mysql # 列出已安装的安装包</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">rpm -e xxx xxx xxx <span class="comment"># -e 删除指定组件。删除上述输出组件。rpm不会自行解决依赖，可以通过错误信息找到依赖项，指定多个要删除的组件</span></span></span><br><span class="line">dnf remove \</span><br><span class="line">            mysql-community-server-8.4.6-1.el8.x86_64         \</span><br><span class="line">            mysql-community-client-8.4.6-1.el8.x86_64         \</span><br><span class="line">            mysql-community-libs-8.4.6-1.el8.x86_64           \</span><br><span class="line">            mysql-community-common-8.4.6-1.el8.x86_64         \</span><br><span class="line">            mysql-community-client-plugins-8.4.6-1.el8.x86_64 \</span><br><span class="line">            mysql-community-icu-data-files-8.4.6-1.el8.x86_64 \</span><br><span class="line">            mariadb-connector-c-3.1.11-2.el8_3.x86_64 \</span><br><span class="line">            mariadb-connector-c-config-3.1.11-2.el8_3.noarch # 卸载数据库安装程序</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找残余文件</span></span><br><span class="line">find / -name mysql # 按文件名查找</span><br><span class="line">find / | grep .*mysql.*</span><br><span class="line">find / -name my.cnf # 查找mysql配置文件</span><br></pre></td></tr></table></figure>

<p>ubuntu</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查询已安装的 MySQL 相关包</span></span><br><span class="line">dpkg -l | grep -iE &#x27;mysql|mariadb&#x27; # grep -iE，-i 忽略大小写；-E 启用扩展正则表达式</span><br><span class="line">apt list --installed | grep mysql # 列出已安装的安装包</span><br><span class="line"></span><br><span class="line">apt remove --purge \</span><br><span class="line">            mysql-community-server \</span><br><span class="line">            mysql-community-client \</span><br><span class="line">            mysql-community-libs \</span><br><span class="line">            mysql-community-common \</span><br><span class="line">            mysql-community-client-plugins \</span><br><span class="line">            mysql-community-icu-data-files # 卸载数据库安装程序</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找残余文件</span></span><br><span class="line">find / -name mysql # 按文件名查找</span><br><span class="line">find / | grep .*mysql.*</span><br><span class="line">find / -name my.cnf # 查找mysql配置文件</span><br></pre></td></tr></table></figure>

<h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h2><p>MySQL 依赖于 libaio 库。如果该库未在本地安装，数据目录初始化和后续服务器启动步骤将失败。如有必要，请使用适当的包管理器进行安装。</p>
<p>ubuntu</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dpkg -l | grep -iE &#x27;libaio1t64&#x27;</span><br><span class="line">apt list --installed | grep -iE &#x27;libaio1t64&#x27;</span><br><span class="line"></span><br><span class="line">apt-get update</span><br><span class="line">apt-cache search &#x27;libaio1t64&#x27;</span><br><span class="line">apt-get install libaio1t64</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ubuntu 24.04 软件包名为 libaio1t64，而 MySQL 依赖 libaio.so.1 (未更新)，创建符号链接如下</span></span><br><span class="line">ln -s /usr/lib/x86_64-linux-gnu/libaio.so.1t64 /usr/lib/x86_64-linux-gnu/libaio.so.1</span><br></pre></td></tr></table></figure>

<p>centos</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rpm -q libaio</span><br><span class="line">dnf list installed | grep -iE &#x27;libaio&#x27;</span><br><span class="line"></span><br><span class="line">dnf makecache # 生成或更新本地的 仓库缓存 / 元数据</span><br><span class="line">dnf search libaio # 从系统的 YUM 仓库（Repository） 中搜索包含关键词的软件包信息。</span><br><span class="line">dnf install libaio</span><br></pre></td></tr></table></figure>

<p>Oracle Linux 8 &#x2F; Red Hat 8 (EL8)： 这些平台默认不会安装文件 &#x2F;lib64&#x2F;libtinfo.so.5，而该文件是 MySQL 客户端 bin&#x2F;mysql 运行 mysql-VERSION-el7-x86_64.tar.gz 和 mysql-VERSION-linux-glibc2.28-x86_64.tar.xz 包时所需的。为解决此问题，请安装 ncurses-compat-libs 包。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ubuntu</span></span><br><span class="line">dpkg -l | grep libncurses</span><br><span class="line">apt-cache search libncurses</span><br><span class="line">apt-get install ...</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">centos</span></span><br><span class="line">rpm -q ncurses</span><br><span class="line">dnf search ncurses</span><br><span class="line">dnf install ...</span><br></pre></td></tr></table></figure>

<h2 id="解压二进制包"><a href="#解压二进制包" class="headerlink" title="解压二进制包"></a>解压二进制包</h2><p>表 2.3 通用 Unix&#x2F;Linux 二进制包的 MySQL 安装布局</p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/binary-installation.html#binary-installation-layout">https://dev.mysql.com/doc/refman/8.4/en/binary-installation.html#binary-installation-layout</a></p>
<table>
<thead>
<tr>
<th align="left">目录</th>
<th align="left">目录内容</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>bin</code></td>
<td align="left">MySQL 服务器（mysqld）、客户端和实用程序程序</td>
</tr>
<tr>
<td align="left"><code>docs</code></td>
<td align="left">MySQL 手册（Info 格式）</td>
</tr>
<tr>
<td align="left"><code>man</code></td>
<td align="left">Unix 手册页</td>
</tr>
<tr>
<td align="left"><code>include</code></td>
<td align="left">Include (header) files</td>
</tr>
<tr>
<td align="left"><code>lib</code></td>
<td align="left">Libraries</td>
</tr>
<tr>
<td align="left"><code>share</code></td>
<td align="left">错误信息、词典和数据库安装的SQL语句</td>
</tr>
<tr>
<td align="left"><code>support-files</code></td>
<td align="left">其他支持文件</td>
</tr>
</tbody></table>
<p>解压</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/local &amp;&amp; cd /data/local/</span><br><span class="line">tar -xvf mysql-8.4.6-linux-glibc2.28-x86_64.tar.xz</span><br><span class="line">mv ./mysql-8.4.6-linux-glibc2.28-x86_64 ./mysql</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建指向安装目录的符号链接（软链接），这样可以轻松地将其引用为 /data/local/mysql</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">ln</span> -s mysql-8.4.6-linux-glibc2.28-x86_64 mysql</span></span><br></pre></td></tr></table></figure>

<p><font color="red"> 为了让mysqld命令可以在任何位置执行，需配置环境变量</font>，参考：<font color="red">**<a href="/article/2019/07/ChildShell%E3%80%81SubShell%E3%80%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%8C%81%E4%B9%85%E5%8C%96">环境变量持久化</a> **</font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">grep -qxF &#x27;export PATH=/data/local/mysql/bin:$PATH&#x27; /etc/profile || \</span><br><span class="line">echo &#x27;export PATH=/data/local/mysql/bin:$PATH&#x27; &gt;&gt; /etc/profile</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">vim /etc/profile</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/data/local/mysql/bin</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使环境变量生效</span></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<h2 id="创建数据目录"><a href="#创建数据目录" class="headerlink" title="创建数据目录"></a>创建数据目录</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd /data/local/mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建各实例数据存放目录</span></span><br><span class="line">mkdir -p /data/local/mysql/3306/&#123;data,log,mysql-files&#125;</span><br><span class="line">mkdir -p /data/local/mysql/8306/&#123;data,log,mysql-files&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建各实例error日志，可省略，会自动创建</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">touch</span> /data/local/mysql/3306/log/error.log</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">touch</span> /data/local/mysql/8306/log/error.log</span></span><br><span class="line">tree -d /data/local/mysql # 以树状图列出目录的内容。-d 显示目录名称而非内容。</span><br></pre></td></tr></table></figure>

<h2 id="创建用户并赋予权限"><a href="#创建用户并赋予权限" class="headerlink" title="创建用户并赋予权限"></a>创建用户并赋予权限</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">groupadd mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-r 创建一个 系统用户（UID &lt; 1000，一般不用于登录）；</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-g mysql 指定用户所属的主组为 mysql（该组必须已存在）</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-s /bin/false 指定用户的 shell 为 /bin/false，禁止该用户登录系统</span></span><br><span class="line">useradd -r -g mysql -s /bin/false mysql # 创建一个用于运行 MySQL 服务的系统用户，该用户属于 mysql 用户组，且禁止用户登录。</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将指定文件的拥有者改为指定的用户或组。<span class="built_in">chown</span> [-cfhvR] [--<span class="built_in">help</span>] [--version] user[:group] file...</span></span><br><span class="line">chown -R mysql:mysql /data/local/mysql # -R 处理指定目录以及其子目录下的所有文件。</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">chmod</span> 750 /data/local/mysql <span class="comment"># 权限分为三级 : 文件所有者（Owner）、用户组（Group）、其它用户（Other Users）。</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看所有用户组</span></span><br><span class="line">cat /etc/group</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看所有用户（系统 + 登录用户）</span></span><br><span class="line">cat /etc/passwd</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看某个用户所属的所有组</span></span><br><span class="line">groups mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看指定用户详细信息（包括主组）</span></span><br><span class="line">id mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">userdel -r mysql <span class="comment"># 删除名为 mysql 的 Linux 用户。-r 删除用户登入目录以及目录中所有文件</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">groupdel mysql <span class="comment"># 必须先删除群组下的用户</span></span></span><br></pre></td></tr></table></figure>

<h2 id="创建配置文件"><a href="#创建配置文件" class="headerlink" title="创建配置文件"></a>创建配置文件</h2><p>新建配置文件 <code>vim /data/local/mysql/my.cnf</code> ，修改如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line"><span class="comment">#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ 服务器程序的配置 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line"><span class="comment">#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 部分MySQL服务器程序的通用配置（所有数据库实例）。仅适用于 mysqld、mysqld_safe。</span></span><br><span class="line"><span class="comment"># 通常把服务端选项放在[mysqld]段，名字更直观。[server]段可以作为一种 “额外/兼容” 的方式。个人习惯：[server]存放过时的配置</span></span><br><span class="line"><span class="attr">[server]</span></span><br><span class="line"><span class="comment">#mysql-native-password               = ON                                    # 8.4中默认禁用，9.0.0开始被删除</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 服务器程序 mysqld 的专用配置（所有数据库实例）。也适用于 mysqld_safe。</span></span><br><span class="line"><span class="attr">[mysqld]</span></span><br><span class="line"><span class="comment">####################################################################################################################################################################################################</span></span><br><span class="line"><span class="attr">skip_name_resolve</span>                   = <span class="string">ON                                    # 默认值OFF。控制服务器在处理客户端连接时是否进行DNS反向解析（使用PTR记录）。禁用它可以加速连接验证，但代价是要求授权表（mysql.user等）必须使用IP地址来定义连接来源。</span></span><br><span class="line"><span class="attr">user</span>                                = <span class="string">mysql                                 # 以 mysql 用户运行 mysqld 服务器（此处的 &quot;用户 &quot;是指操作系统用户，而不是授权表中列出的MySQL数据库的账号）。</span></span><br><span class="line"><span class="attr">bind_address</span>                        = <span class="string">*                                     # 当绑定多个值时，不允许通配符。不支持正则。IP地址必须存在。</span></span><br><span class="line"><span class="attr">basedir</span>                             = <span class="string">/data/local/mysql                     # MySQL基本安装目录。服务器可执行文件在启动时确定自己的完整路径名，并使用其所在目录的父目录作为默认basedir值。</span></span><br><span class="line"><span class="attr">local_infile</span>                        = <span class="string">OFF                                   # 此变量控制服务器端对 LOAD DATA 语句的 LOCAL 功能。根据 local_infile 设置，服务器会拒绝或允许客户端在客户端启用 LOCAL 功能时进行本地数据加载。</span></span><br><span class="line"><span class="attr">mysqlx</span>                              = <span class="string">OFF                                   #</span></span><br><span class="line"><span class="attr">lc_messages_dir</span>                     = <span class="string">/data/local/mysql/share               #</span></span><br><span class="line"><span class="attr">lc_messages</span>                         = <span class="string">en_US                                 # 在这种情况下，mysqld将区域设置en_US映射到语言english，并在/data/local/mysql/share/english目录中查找错误文件</span></span><br><span class="line"><span class="attr">default_password_lifetime</span>           = <span class="string">0                                     # 全局自动密码过期策略。默认值0表示禁用自动密码过期功能；正整数N表示允许的密码有效期，密码必须每N天更改一次。</span></span><br><span class="line"><span class="attr">max_connections</span>                     = <span class="string">151                                   # 允许同时连接的最大客户端数量，默认151，最小1，最大100000。最大有效值为 (open_files_limit 的有效值 - 810) 与 max_connections 实际设置的值中的较小者。状态变量 connection_errors_max_connections：由于达到服务器 max_connections 限制，因此拒绝的连接数。</span></span><br><span class="line"><span class="comment">#back_log                            = -1                                    # MySQL 可拥有的未处理连接请求数。当 MySQL 主线程在很短的时间内收到很多连接请求时，这一点就会发挥作用。这时，主线程需要一些时间（虽然很少）来检查连接并启动一个新线程。back_log 值表示在 MySQL 暂时停止应答新请求之前，在这短时间内可以堆叠多少个请求。只有在预计短时间内会有大量连接的情况下，才需要增加该值。换句话说，该值是用于接收 TCP/IP 连接的监听队列的大小。操作系统对该队列的大小有自己的限制。Unix listen() 系统调用的手册页面应该有更多详细信息。请查阅操作系统文档，了解该变量的最大值。默认值为 max_connections（最大连接数）的值，该值可使允许积压的连接数调整到最大允许连接数。</span></span><br><span class="line"><span class="attr">max_connect_errors</span>                  = <span class="string">100                                   # 当主机的 max_connect_errors 次连续连接请求被中断且未成功连接时，服务器将阻止该主机继续连接。</span></span><br><span class="line"><span class="attr">character_set_server</span>                = <span class="string">utf8mb4                               # 服务默认字符集</span></span><br><span class="line"><span class="attr">lower_case_table_names</span>              = <span class="string">1                                     # 此选项适用于数据库名称和表名称。0:存储区分大小写，比较区分大小写; 1:存储小写，比较不区分大小写; 2:存储区分大小写，比较小写</span></span><br><span class="line"><span class="attr">default-time-zone</span>                   = <span class="string">&#x27;+08:00&#x27;                              # 设置服务器默认时区，若未指定则与系统时区相同</span></span><br><span class="line"><span class="attr">skip-grant-tables</span>                   = <span class="string">OFF                                   # 需重启。该配置使所有用户登录当前数据库都免密，修改密码后立即去掉。</span></span><br><span class="line"><span class="attr">activate_all_roles_on_login</span>         = <span class="string">OFF                                   #</span></span><br><span class="line"><span class="attr">default_storage_engine</span>              = <span class="string">InnoDB                                # 为永久表设置存储引擎</span></span><br><span class="line"><span class="attr">default_tmp_storage_engine</span>          = <span class="string">InnoDB                                # 临时表的默认存储引擎</span></span><br><span class="line"><span class="attr">log_timestamps</span>                      = <span class="string">SYSTEM</span></span><br><span class="line"><span class="attr">transaction_isolation</span>               = <span class="string">REPEATABLE-READ                       # 设置默认事务隔离级别</span></span><br><span class="line"><span class="attr">max_allowed_packet</span>                  = <span class="string">67108864                              # 默认67108864(64MB)，最小1024。</span></span><br><span class="line"><span class="attr">tmp_table_size</span>                      = <span class="string">16777216                              # 默认16777216(16MB)，最小1024，</span></span><br><span class="line"><span class="attr">max_heap_table_size</span>                 = <span class="string">16777216                              # 默认16777216(16MB)，最小16384(16KB)</span></span><br><span class="line"><span class="comment">#init_connect                        = &#x27;SET NAMES utf8mb4;&#x27;                  # 服务器为每个连接的客户端执行的字符串。该字符串由一个或多个SQL语句组成，各语句之间以分号分隔。 </span></span><br><span class="line"><span class="attr">secure_file_priv</span>                    = <span class="string">NULL                                  # 默认值因系统和安装方式而异。此变量用于限制数据导入和导出操作的影响，例如由LOAD DATA和SELECT ... INTO OUTFILE语句以及LOAD_FILE()函数执行的操作。这些操作仅允许具有FILE权限的用户执行。如果设置为 NULL，服务器将禁用导入和导出操作。</span></span><br><span class="line"><span class="attr">require_secure_transport</span>            = <span class="string">OFF                                   # 客户端连接到服务器时是否需要使用某种形式的加密传输。当此变量启用时，服务器仅允许使用TLS/SSL加密的TCP/IP连接，或使用套接字文件（在Unix系统上）或共享内存（在Windows系统上）的连接。服务器将拒绝不安全的连接尝试，这些尝试将以ER_SECURE_TRANSPORT_REQUIRED错误失败。简言之，OFF 表示服务器不强制客户端必须使用加密连接，可以使用 mysql --ssl-mode=disable。</span></span><br><span class="line"><span class="comment">#################################### 线程 ###################################</span></span><br><span class="line"><span class="attr">thread_cache_size</span>                   = <span class="string">0                                     # 服务器应缓存多少线程以供重用。当客户端断开连接时，如果缓存中的线程少于线程_缓存_大小，客户端的线程就会被放入缓存。如果可能，会通过重用缓存中的线程来满足对线程的请求，只有当缓存为空时，才会创建新的线程。如果有大量新连接，可以增加这个变量来提高性能。通常情况下，如果你的线程实现得很好，这并不会显著提高性能。不过，如果服务器每秒有数百个连接，通常应将 thread_cache_size 设置得足够高，以便大多数新连接都使用缓存线程。通过查看 Connections 和 Threads_created 状态变量之间的差异，可以了解线程缓存的效率如何。详情请参阅第 7.1.10 节 &quot;服务器状态变量&quot;。默认值基于以下公式，上限为 100：8 + (max_connections / 100)</span></span><br><span class="line"><span class="attr">thread_stack</span>                        = <span class="string">1048576                               # 每个线程的堆栈大小。默认值对于正常操作来说足够大。如果线程堆栈大小太小，则会限制服务器可以处理的SQL语句的复杂性、存储过程的递归深度以及其他消耗内存的操作。默认1048576(1MB)，最小131072(128KB)。</span></span><br><span class="line"><span class="attr">wait_timeout</span>                        = <span class="string">28800                                 # 默认28800。服务器在关闭 非交互式连接 之前等待该连接活动的秒数。在线程启动时，会话 wait_timeout 值从全局 wait_timeout 值或全局 interactive_timeout 值初始化，取决于客户端的类型（由 mysql_real_connect() 的 CLIENT_INTERACTIVE 连接选项定义）。</span></span><br><span class="line"><span class="attr">interactive_timeout</span>                 = <span class="string">28800                                 # 默认28800。服务器在关闭   交互式连接 之前等待该连接活动的秒数。交互式客户端定义为使用 mysql_real_connect() 的 CLIENT_INTERACTIVE 选项的客户端。另请参阅 wait_timeout。</span></span><br><span class="line"><span class="comment">#################################### 用户进程分配到的内存 #####################</span></span><br><span class="line"><span class="attr">sort_buffer_size</span>                    = <span class="string">262144                                # 每个必须执行排序的会话都会分配一个该大小的缓冲区。不特定于任何存储引擎，并且以通用方式应用以进行优化。值必须足够大，以便在排序缓冲区中容纳十五个元组。增加 max_sort_length 的值可能需要增加 sort_buffer_size 的值。如果您在 SHOW GLOBAL STATUS 输出中看到每秒有许多 Sort_merge_passes，则可以考虑增加 sort_buffer_size 值以加快无法通过查询优化或改进索引来改进的 ORDER BY 或 GROUP BY 操作。默认262144(256KB)，最小32768(32KB)。</span></span><br><span class="line"><span class="attr">join_buffer_size</span>                    = <span class="string">262144                                # 用于普通索引扫描、范围索引扫描和不使用索引从而执行全表扫描的连接所使用的缓冲区的大小。默认262144(256KB)，最小128。</span></span><br><span class="line"><span class="attr">read_buffer_size</span>                    = <span class="string">131072                                # 对MyISAM表进行顺序扫描的每个线程都会为其扫描的每个表分配一个此大小（以字节为单位）的缓冲区。如果执行多次顺序扫描，您可能需要增加该值，默认131072(128KB)，最小8192(8KB)。</span></span><br><span class="line"><span class="attr">binlog_cache_size</span>                   = <span class="string">32768                                 # 当服务器上启用二进制日志记录时，如果服务器支持任何事务存储引擎，则为每个客户端分配一个二进制日志缓存。如果事务的数据超出了内存缓冲区的空间，则超出的数据将存储在临时文件中。默认32768(32KB)，最小4096。</span></span><br><span class="line"><span class="attr">max_binlog_cache_size</span>               = <span class="string">18446744073709547520                  # 如果事务需要超过这么多字节，服务器会生成多语句事务需要超过“max_binlog_cache_size”字节的存储错误。当gtid_mode不为ON时，最大推荐值为4GB，因为在这种情况下，MySQL无法使用大于4GB的二进制日志位置；该选项仅设置事务缓存的大小；语句缓存的上限由 max_binlog_stmt_cache_size 系统变量控制。最小4096。</span></span><br><span class="line"><span class="attr">key_buffer_size</span>                     = <span class="string">8388608                               # MyISAM 表的索引块被缓冲并由所有线程共享。该选项是用于索引块的缓冲区的大小。密钥缓冲区也称为密钥缓存。默认8388608(8MB)，最小0。</span></span><br><span class="line"><span class="comment">#################################### Innodb #################################</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span>             = <span class="string">134217728                             # 缓冲池的大小（以字节为单位），InnoDB 缓存表和索引数据的内存区域。默认134217728(128MB)，最小5242880(5MB)。</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_instances</span>        = <span class="string">1                                     # InnoDB缓冲池划分的区域数。对于缓冲池大小在几GB范围内的系统，将缓冲池划分为单独的实例可以提高并发性，因为不同线程读取和写入缓存页面时会减少争用。使用哈希函数将存储在缓冲池中或从缓冲池读取的每个页面随机分配给其中一个缓冲池实例。每个缓冲池管理自己的空闲列表、刷新列表、LRU 以及连接到缓冲池的所有其他数据结构，并受自己的缓冲池互斥锁保护。\n 总缓冲池大小在所有缓冲池之间分配。为了获得最佳效率，请指定 innodb_buffer_pool_instances 和 innodb_buffer_pool_size 的组合，以便每个缓冲池实例至少为 1GB。</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_dump_pct</span>         = <span class="string">25                                    # 指定每个缓冲池要读出并转储的最近使用的页面的百分比。范围是 1 到 100。默认值为 25。例如，如果有 4 个缓冲池，每个缓冲池有 100 个页面，并且 innodb_buffer_pool_dump_pct 设置为 25，则会转储每个缓冲池中最近使用的 25 个页面。人话：MySQL正常关闭时把buffer中页信息保存到磁盘，启动后再从磁盘加载到buffer，实现服务器快速预热。</span></span><br><span class="line"><span class="attr">innodb_data_file_path</span>               = <span class="string">ibdata1:12M:autoextend                # 定义InnoDB系统表空间数据文件的名称、大小和属性。file_name:file_size[:autoextend[:max:max_file_size]]</span></span><br><span class="line"><span class="attr">innodb_file_per_table</span>               = <span class="string">ON                                    # 当启用 innodb_file_per_table 时，表默认创建在按表分文件的表空间中。当禁用时，表默认创建在系统表空间中。</span></span><br><span class="line"><span class="comment">#innodb_flush_method                 = 0                                     # 定义用于将数据写入InnoDB数据文件和日志文件的方法，这可能会影响I/O吞吐量。在类Unix系统上，如果支持O_DIRECT，则默认值为O_DIRECT，否则默认值为fsync。在Windows上，默认值为unbuffered。</span></span><br><span class="line"><span class="attr">innodb_default_row_format</span>           = <span class="string">DYNAMIC                               # 该选项用于定义 InnoDB 表和用户创建的临时表的默认行格式。默认设置为 DYNAMIC。其他允许的值包括 COMPACT 和 REDUNDANT。COMPRESSED 行格式（不支持在系统表空间中使用）不能被定义为默认值。新创建的表在未显式指定 ROW_FORMAT 选项或使用 ROW_FORMAT=DEFAULT 时，将使用 innodb_default_row_format 定义的行格式。服务器为处理查询而创建的内部 InnoDB 临时表使用 DYNAMIC 行格式，无论 innodb_default_row_format 设置如何。</span></span><br><span class="line"><span class="attr">innodb_page_size</span>                    = <span class="string">16384                                 # 默认16384(16KB)。指定InnoDB表空间的页面大小。值可以以字节或千字节为单位指定。例如，16千字节的页面大小值可以指定为16384、16KB或16k。</span></span><br><span class="line"><span class="attr">innodb_redo_log_archive_dirs</span>        = <span class="string">NULL                                  # 定义可创建重做日志存档文件的带标签目录。您可以在以分号分隔的列表中定义多个带标签目录。默认值为NULL，不允许激活重做日志归档。</span></span><br><span class="line"><span class="attr">innodb_redo_log_capacity</span>            = <span class="string">104857600                             # 默认104857600(100MB)。定义重做日志文件占用的磁盘空间量。已经取代 innodb_log_file_size 和 innodb_log_files_in_group。总共的redo日志文件大小其实就是： innodb_log_file_size * innodb_log_files_in_group。</span></span><br><span class="line"><span class="attr">innodb_log_buffer_size</span>              = <span class="string">67108864                              # redo log bufer。默认67108864(64MB)，最小1048576(1MB)。InnoDB用于写入磁盘日志文件的缓冲区大小。较大的日志缓冲区使得大型事务能够运行，而无需在事务提交之前将日志写入磁盘。因此，如果您有更新、插入或删除多行的事务，则增大日志缓冲区可以节省磁盘 I/O。尚硅谷：为了提高性能，也是先将信息写入 Innodb Log Buffer 中，当满足 innodb_flush_log_trx_commit 参数所设置的相应条件（或者日志缓冲区写满）之后，才会将日志写到文件（或者同步到磁盘）中。</span></span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span>      = <span class="string">1                                     # 从redo log bufer刷盘到redo log file的策略。为了在使用事务的复制设置中实现持久性和一致性InnoDB，始终设置 innodb_flush_log_at_trx_commit=1 (完全符合 ACID 要求，默认设置 1。每次提交事务时，日志都会写入并刷新到磁盘)。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_undo_tablespaces</span>             = <span class="string">2                                     # 定义InnoDB使用的undo表空间的数量。默认值和最小值为2，最大值127。</span></span><br><span class="line"><span class="attr">innodb_undo_log_truncate</span>            = <span class="string">ON                                    # 启用后，超过 innodb_max_undo_log_size 定义的阈值的undo表空间将被标记为截断。只有undo表空间才能被截断。不支持截断驻留在系统表空间中的undo日志。要进行截断，必须至少有两个undo表空间。</span></span><br><span class="line"><span class="attr">innodb_max_undo_log_size</span>            = <span class="string">1073741824                            # 定义undo表空间的阈值大小。如果undo表空间超出阈值，则在启用 innodb_undo_log_truncate 时可以将其标记为截断。默认1073741824(1GB)，最小10485760(10MB)。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_print_all_deadlocks</span>          = <span class="string">OFF                                   # 当启用此选项时，有关 InnoDB 用户事务中的所有死锁的信息都将记录在 mysqld 错误日志中。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_flush_sync</span>                   = <span class="string">ON                                    # 默认启用，在检查点发生 I/O 活动突发期间，会忽略 innodb_io_capacity 和 innodb_io_capacity_max 配置。为了遵守 innodb_io_capacity 和 innodb_io_capacity_max 定义的 I/O 速率，请禁用 innodb_flush_sync。</span></span><br><span class="line"><span class="attr">innodb_io_capacity</span>                  = <span class="string">200                                   # 默认值10000。定义InnoDB后台任务可用的每秒 I/O 操作数 (IOPS)，例如从缓冲池刷新页面和从更改缓冲区合并数据。人话：缓冲区刷新到磁盘时，每秒刷新的脏页数量；</span></span><br><span class="line"><span class="attr">innodb_io_capacity_max</span>              = <span class="string">400                                   # 默认 2 * innodb_io_capacity。</span></span><br><span class="line"><span class="attr">innodb_read_io_threads</span>              = <span class="string">4                                     # 默认值为 CPUCore / 2。 InnoDB 中用于读取操作的 I/O 线程数。写入线程的对应项是 innodb_write_io_threads。</span></span><br><span class="line"><span class="attr">innodb_write_io_threads</span>             = <span class="string">4                                     # 默认值为 4。           InnoDB 中用于写入操作的 I/O 线程数。读取线程的对应项是 innodb_read_io_threads。</span></span><br><span class="line"><span class="attr">innodb_lock_wait_timeout</span>            = <span class="string">50                                    # InnoDB 事务在放弃之前等待行锁的时间长度（以秒为单位）。默认值为 50 秒。</span></span><br><span class="line"><span class="comment">#################################### Table ##################################</span></span><br><span class="line"><span class="attr">table_open_cache</span>                    = <span class="string">4000                                  # 所有线程打开的表的数量。增加此值会增加 mysqld 所需的文件描述符的数量。默认 4000 = MAX((open_files_limit - 10 - max_connections) / 2, 400)，最大524288。</span></span><br><span class="line"><span class="attr">table_definition_cache</span>              = <span class="string">2000                                  # 范围 400 ~ 524288。默认值-1（表示自动调整大小；不要分配该文字值）。可存储在表定义缓存中的表定义数量。如果使用的表数量较多，可以创建一个较大的表定义缓存，以加快表的打开速度。与正常的表缓存不同，表定义缓存占用空间较小，且不使用文件描述符。最小值为 400。默认值基于以下公式，上限为 2000：MIN(400 + table_open_cache / 2, 2000)</span></span><br><span class="line"><span class="comment">#################################### Open ###################################</span></span><br><span class="line"><span class="attr">open_files_limit</span>                    = <span class="string">8161                                  # 操作系统中 mysqld 可用的文件描述符数量。默认 8161 = 10 + max_connections + (table_open_cache * 2)，该值是从三种计算方式中取的最大值，详见官网。</span></span><br><span class="line"><span class="comment">#################################### 主从复制 ################################</span></span><br><span class="line"><span class="comment">#log-bin=mysql-bin</span></span><br><span class="line"><span class="comment">#master_info_repository</span></span><br><span class="line"><span class="comment">#relay_log_info_repository</span></span><br><span class="line"><span class="comment">#log_slave_updates</span></span><br><span class="line"><span class="comment">#relay_log_recovery</span></span><br><span class="line"><span class="comment">#slave_skip_errors</span></span><br><span class="line"><span class="comment">#################################### 日志相关 ################################</span></span><br><span class="line"><span class="comment"># flush logs 语句，关闭并重新打开服务器正在写入的任何日志文件。https://dev.mysql.com/doc/refman/8.4/en/flush.html</span></span><br><span class="line"><span class="attr">log_output</span>                          = <span class="string">FILE                                  # 默认值 FILE。通用查询日志和慢查询日志的输出目标。该值是一个由TABLE、FILE和NONE组成的一个或多个以逗号分隔的单词列表。TABLE选择将日志记录到mysql系统模式中的general_log和slow_log表中。FILE选择将日志记录到日志文件中。NONE禁用日志记录。如果值中包含NONE，则它将优先于其他任何存在的单词。TABLE 和 FILE 可以同时指定以选择两个日志输出目标。此变量用于选择日志输出目标，但不会启用日志输出。要启用日志输出，需启用 general_log 和 slow_query_log 系统变量。对于 FILE 日志记录，general_log_file 和 slow_query_log_file 系统变量确定日志文件的位置。有关更多信息，请参阅第 7.4.1 节“选择通用查询日志和慢查询日志输出目标”。</span></span><br><span class="line"><span class="comment">########## 通用查询日志，记录用户的所有操作 ##########</span></span><br><span class="line"><span class="attr">general_log</span>                         = <span class="string">OFF                                   # 是否启用通用查询日志。日志输出的目标由 log_output 系统变量控制；如果该值为 NONE，则即使启用了日志也不会写入任何日志条目。默认OFF。</span></span><br><span class="line"><span class="attr">general_log_file</span>                    = <span class="string">localhost.log                         # 默认值 host_name.log。通用查询日志文件的名称。</span></span><br><span class="line"><span class="comment">########## 慢查询日志 ##########</span></span><br><span class="line"><span class="attr">long_query_time</span>                     = <span class="string">2                                     # 如果查询耗时超过指定秒数，服务器会将 Slow_queries 状态变量加一。如果启用了慢查询日志，该查询会被记录到慢查询日志文件中。默认值10秒，最小0秒。</span></span><br><span class="line"><span class="attr">slow_query_log</span>                      = <span class="string">ON                                    # 是否启用慢查询日志。日志输出的目的地由log_output系统变量控制；如果该值为 NONE，则即使启用了日志也不会写入任何日志条目。“慢”由 long_query_time 变量的值决定。默认OFF。</span></span><br><span class="line"><span class="attr">slow_query_log_file</span>                 = <span class="string">localhost-slow.log                    # 默认值 host_name-slow.log。慢查询日志文件的名称。</span></span><br><span class="line"><span class="attr">log_queries_not_using_indexes</span>       = <span class="string">ON                                    # 如果在启用慢查询日志的情况下启用此变量，则会记录预期检索所有行的查询。此选项并不一定意味着不使用索引。例如，使用完整索引扫描的查询使用索引，但会被记录，因为索引不会限制行数。默认OFF。</span></span><br><span class="line"><span class="attr">log_throttle_queries_not_using_indexes</span> = <span class="string">0                                  # 如果启用了 log_queries_not_using_indexes，则 log_throttle_queries_not_using_indexes 变量会限制每分钟可写入慢查询日志的此类查询的数量。默认值0，表示“无限制”。</span></span><br><span class="line"><span class="attr">min_examined_row_limit</span>              = <span class="string">0                                     # 检查少于此行数的查询将不会记录到慢查询日志中。设置此系统变量的会话值是一项受限制的操作。会话用户必须具有足够的权限才能设置受限制的会话变量。默认值0。</span></span><br><span class="line"><span class="attr">log_slow_replica_statements</span>         = <span class="string">ON                                    # 开启 从服务器 的慢查询日志。请查阅官网...</span></span><br><span class="line"><span class="comment">########## Performance_schema ##########</span></span><br><span class="line"><span class="attr">performance_schema</span>                  = <span class="string">ON                                    # 默认值ON。用于指示性能模式是否启用。</span></span><br><span class="line"><span class="attr">performance_schema_events_statements_history_long_size</span>   = <span class="string">10000            # 默认-1（表示自动调整大小；请勿直接赋值此字面量）。</span></span><br><span class="line"><span class="attr">performance_schema_events_stages_history_long_size</span>       = <span class="string">10000</span></span><br><span class="line"><span class="attr">performance_schema_events_waits_history_long_size</span>        = <span class="string">10000</span></span><br><span class="line"><span class="attr">performance_schema_events_transactions_history_long_size</span> = <span class="string">10000</span></span><br><span class="line"><span class="comment">########## 二进制日志，变更日志 ##########</span></span><br><span class="line"><span class="attr">log-bin</span>                             = <span class="string">binlog                                # 二进制日志文件名称，也可以加上路径 /data/local/mysql/3306/data/binlog。数据库文件最好不要与日志文件放在同一个磁盘上，当数据库文件所在的磁盘发生故障时，可以使用日志文件恢复数据。</span></span><br><span class="line"><span class="attr">binlog_expire_logs_seconds</span>          = <span class="string">2592000                               # 设置二进制日志的有效期（以秒为单位）。有效期结束后，二进制日志文件可以被自动删除。可能的删除发生在启动时以及二进制日志刷新时。可以通过将 binlog_expire_logs_auto_purge 系统变量设置为 OFF 来禁用二进制日志的自动清除。此设置优先于 binlog_expire_logs_seconds 的任何设置。要手动删除二进制日志文件，请使用 PURGE BINARY LOGS 语句。默认2592000秒(30天)。</span></span><br><span class="line"><span class="attr">binlog_expire_logs_auto_purge</span>       = <span class="string">ON                                    # 启用或禁用二进制日志文件的自动清除。清除之前等待的间隔由 binlog_expire_logs_seconds 控制。即使 binlog_expire_logs_auto_purge 处于 ON 状态，将 binlog_expire_logs_seconds 设置为 0 也会停止自动清除。此变量对 PURGE BINARY LOGS 没有影响。默认值ON。</span></span><br><span class="line"><span class="attr">max_binlog_size</span>                     = <span class="string">200M                                  # 每次重启会新建。事务以一个块的形式写入二进制日志，因此它永远不会被拆分到多个二进制日志中。因此，如果您有大型事务，您可能会看到二进制日志文件大于 max_binlog_size。如果 max_relay_log_size 为 0，则 max_binlog_size 的值也适用于中继日志。最大值和默认值为1073741824(1GB)。</span></span><br><span class="line"><span class="attr">log_bin_trust_function_creators</span>     = <span class="string">OFF                                   # 此变量在启用二进制日志记录时适用。限制存储过程，因为二进制日志的一个重要功能是用于主从复制，而存储函数（now()）有可能导致主从的数据不一致。所以当开启二进制日志后，需要限制存储函数的创建、修改、调用。</span></span><br><span class="line"><span class="attr">binlog_format</span>                       = <span class="string">ROW                                   # binlog_format 已被弃用，并将在未来的 MySQL 版本中删除。这意味着对基于行的记录格式以外的记录格式的支持也将在未来版本中删除。因此，任何新的 MySQL 复制设置都只能使用基于行的日志记录。</span></span><br><span class="line"><span class="attr">binlog_row_image</span>                    = <span class="string">full                                  #</span></span><br><span class="line"><span class="attr">binlog-ignore-db</span>                    = <span class="string">test                                  # 不要复制的数据库</span></span><br><span class="line"><span class="attr">binlog-do-db</span>                        = <span class="string">basedb                                # 需要复制的数据库</span></span><br><span class="line"><span class="attr">sync_binlog</span>                         = <span class="string">1                                     # 为了在使用事务的复制设置中实现持久性和一致性InnoDB，如果启用了二进制日志记录，请设置 sync_binlog=1。</span></span><br><span class="line"><span class="comment">########## 中继日志，从库 ##########</span></span><br><span class="line"><span class="attr">relay_log</span>                           = <span class="string">relaylog                              # 中继日志文件名称</span></span><br><span class="line"><span class="comment">#################################### 其他 ###################################</span></span><br><span class="line"><span class="attr">max_execution_time</span>                  = <span class="string">0                                     # SELECT 语句的执行超时时间（会中断超时 SQL，返回错误），单位为毫秒。默认值0，表示不启用超时。对于存储程序中的 SELECT 语句，max_execution_time 将被忽略。</span></span><br><span class="line"><span class="attr">read_only</span>                           = <span class="string">OFF</span></span><br><span class="line"><span class="comment">####################################################################################################################################################################################################</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 服务器程序 mysqld 的专用配置（3306 数据库实例）。选项组读取顺序：[server] -&gt; [mysqld] -&gt; [mysqld3306]</span></span><br><span class="line"><span class="attr">[mysqld3306]</span></span><br><span class="line"><span class="attr">server_id</span>                           = <span class="string">3306                                  # 用于主从复制</span></span><br><span class="line"><span class="attr">port</span>                                = <span class="string">3306</span></span><br><span class="line"><span class="attr">socket</span>                              = <span class="string">/tmp/mysql_3306.sock</span></span><br><span class="line"><span class="attr">basedir</span>                             = <span class="string">/data/local/mysql                     # MySQL安装基目录的路径</span></span><br><span class="line"><span class="attr">datadir</span>                             = <span class="string">/data/local/mysql/3306/data           # MySQL服务器数据目录的路径</span></span><br><span class="line"><span class="attr">log_error</span>                           = <span class="string">/data/local/mysql/3306/log/error.log  # 将默认错误日志目标设置为指定的文件。默认错误日志目标是数据目录中名为 host_name.err 的文件。</span></span><br><span class="line"><span class="attr">pid_file</span>                            = <span class="string">/data/local/mysql/3306/mysql.pid      # 5.7建议两层目录，否则启动时可能会卡住</span></span><br><span class="line"><span class="comment">#secure_file_priv                    = /data/local/mysql/3306/mysql-files</span></span><br><span class="line"><span class="comment">#mysqlx_port                         = 13306                                 # 从8.0开始。MySQL X Protocol 是一种为了让 MySQL 更好地支持 NoSQL 文档操作、提升性能和现代化连接体验而推出的新标准。它让 MySQL 不仅仅是一个关系型数据库，也成为了一个灵活的文档存储平台。</span></span><br><span class="line"><span class="comment">#mysqlx_socket                       = /tmp/mysqlx_13306.sock</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 服务器程序 mysqld 的专用配置（8306 数据库实例）</span></span><br><span class="line"><span class="attr">[mysqld8306]</span></span><br><span class="line"><span class="attr">server_id</span>                           = <span class="string">8306</span></span><br><span class="line"><span class="attr">port</span>                                = <span class="string">8306</span></span><br><span class="line"><span class="attr">socket</span>                              = <span class="string">/tmp/mysql_8306.sock</span></span><br><span class="line"><span class="attr">basedir</span>                             = <span class="string">/data/local/mysql</span></span><br><span class="line"><span class="attr">datadir</span>                             = <span class="string">/data/local/mysql/8306/data</span></span><br><span class="line"><span class="attr">log_error</span>                           = <span class="string">/data/local/mysql/8306/log/error.log</span></span><br><span class="line"><span class="attr">pid_file</span>                            = <span class="string">/data/local/mysql/8306/mysql.pid</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 服务器程序 mysqld_multi 的专用配置，可管理多数据库实例</span></span><br><span class="line"><span class="attr">[mysqld_multi]</span></span><br><span class="line"><span class="attr">user</span>                                = <span class="string">root                                  # 调用 mysqladmin 时使用的 MySQL 数据库的账号</span></span><br><span class="line"><span class="attr">pass</span>                                = <span class="string">123456789                             # 调用 mysqladmin 时使用的 MySQL 数据库的密码</span></span><br><span class="line"><span class="attr">mysqld</span>                              = <span class="string">/data/local/mysql/bin/mysqld_safe     # 要使用的mysqld二进制文件。mysqld_safe是启动Unix上的 mysqld服务器的推荐方法。mysqld_safe添加了一些安全功能，例如在发生错误时重新启动服务器以及将运行时信息记录到错误日志中。</span></span><br><span class="line"><span class="attr">mysqladmin</span>                          = <span class="string">/data/local/mysql/bin/mysqladmin      # 用于停止服务器的mysqladmin二进制文件</span></span><br><span class="line"><span class="attr">log</span>                                 = <span class="string">/data/local/mysql/mysqld_multi.log</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line"><span class="comment">#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ 客户端程序的配置 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line"><span class="comment">#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 所有MySQL客户端程序的通用配置（所有数据库实例）。适用于 mysql、mysqladmin、mysqldump、mysqlimport、mysqlshow 等。</span></span><br><span class="line"><span class="attr">[client]</span></span><br><span class="line"><span class="attr">default-character-set</span>               = <span class="string">utf8mb4</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 所有MySQL客户端程序的通用配置（3306数据库实例）</span></span><br><span class="line"><span class="attr">[client_3306]</span></span><br><span class="line"><span class="attr">socket</span>                              = <span class="string">/tmp/mysql_3306.sock</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 所有MySQL客户端程序的通用配置（8306数据库实例）</span></span><br><span class="line"><span class="attr">[client_8306]</span></span><br><span class="line"><span class="attr">socket</span>                              = <span class="string">/tmp/mysql_8306.sock</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 客户端程序 mysql 的专用配置</span></span><br><span class="line"><span class="attr">[mysql]</span></span><br><span class="line"><span class="attr">ssl-mode</span>                            = <span class="string">DISABLED                              # 此选项用于指定与服务器连接时所需的安全状态。</span></span><br><span class="line"><span class="comment"># DISABLED：建立未加密的连接。</span></span><br><span class="line"><span class="comment"># PREFERRED：如果服务器支持加密连接，则建立加密连接；如果无法建立加密连接，则回退到未加密连接。如果未指定 --ssl-mode，则此为默认值。</span></span><br><span class="line"><span class="comment"># 通过 Unix 套接字文件建立的连接在 PREFERRED 模式下不会加密。若要强制对 Unix 套接字文件连接进行加密，请使用 REQUIRED 或更严格的模式。（然而，套接字文件传输默认是安全的，因此加密套接字文件连接并不会使其更安全，反而会增加 CPU 负载。）</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 客户端程序 mysqladmin 的专用配置</span></span><br><span class="line"><span class="attr">[mysqladmin]</span></span><br><span class="line"><span class="attr">user</span>                                = <span class="string">root                                  # 连接 MySQL 服务器时使用的 MySQL 用户名</span></span><br><span class="line"><span class="attr">password</span>                            = <span class="string">123456789</span></span><br></pre></td></tr></table></figure>

<h2 id="初始化数据目录"><a href="#初始化数据目录" class="headerlink" title="初始化数据目录"></a>初始化数据目录</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/data-directory-initialization.html">https://dev.mysql.com/doc/refman/8.4/en/data-directory-initialization.html</a></p>
<p><code>--defaults-group-suffix</code> ：不仅读取常规的选项组，还读取具有常规名称并带有 str 后缀的组。例如，MySQL 客户端通常读取 [client] 和 [mysql] 组。<strong>如果将此选项设置为 –defaults-group-suffix&#x3D;_other，MySQL 还会读取 [client_other] 和 [mysql_other] 组。</strong></p>
<p><code>--defaults-file</code> ：仅读取指定的选项文件，默认读取 <code>/etc/my.cnf</code> 或 <code>~/.my.cnf</code> 。例外情况：即使使用了 –defaults-file 选项，mysqld 仍会读取 mysqld-auto.cnf 文件，而客户端程序会读取 .mylogin.cnf 文件。</p>
<p>初始化数据目录，请使用 <code>--initialize</code> 或 <code>--initialize-insecure</code> 选项调用 mysqld，具体取决于您是否希望服务器为 ‘root‘@’localhost’ 账户生成一个随机的初始密码，还是创建该账户时不设置密码：</p>
<ul>
<li><p>使用 <code>--initialize</code> 选项进行“默认安全”安装（即包括生成随机初始 root 密码）。在此情况下，密码会被标记为过期，您必须选择一个新密码。</p>
</li>
<li><p>使用 <code>--initialize-insecure</code> 选项时，不会生成 root 密码。这不安全；假设您计划在将服务器投入生产使用前及时为该账户分配密码。</p>
</li>
</ul>
<p><font color="red"><code>--user</code> ：<strong>在 Unix 和类 Unix 系统上，确保数据库目录和文件属于哪个 Linux 系统用户是非常重要的</strong>，以便日后运行 <code>mysqld</code> 时，服务进程能正常读写这些文件。</font>为了实现这一点，你应该用 Linux 系统的 <strong>root</strong> 用户启动 <code>mysqld</code>（初始化命令），并加上 <code>--user=mysql</code> 参数，以确保最终生成的文件归属 Linux 操作系统的 <code>mysql</code> 用户。<font color="red"><strong>见选项文件的 [mysqld] 组。</strong></font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不会生成 root 密码</span></span><br><span class="line">mysqld --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=3306 --initialize-insecure --user=mysql</span><br><span class="line">mysqld --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=8306 --initialize-insecure --user=mysql</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成随机初始 root 密码，密码会被标记为过期</span></span><br><span class="line">mysqld --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=8306 --initialize --user=mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">cat</span> /var/log/mysqld.log <span class="comment"># 查看密码，root@localhost: 后面就是初始化的密码</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">grep <span class="string">&#x27;temporary password&#x27;</span> /var/log/mysqld.log <span class="comment"># 在/var/log/mysqld.log中查找临时密码，并打印匹配的行</span></span></span><br></pre></td></tr></table></figure>

<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><h3 id="单实例"><a href="#单实例" class="headerlink" title="单实例"></a>单实例</h3><p><font color="red"><code>mysqld --user</code> ：以哪个 Linux 系统用户运行 mysqld 服务器。<strong>见选项文件的 [mysqld] 组。</strong></font></p>
<p><font color="red"><code>mysqladmin --user</code> ：连接 MySQL 服务器时使用的 MySQL 用户名。<strong>见选项文件的 [mysqladmin] 组。</strong></font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打印程序名称及其从选项文件获取的所有选项。密码值将被屏蔽。若使用此选项，它必须是命令行中的第一个选项，但允许紧接在 --defaults-file 或 --defaults-extra-file 之后使用。</span></span><br><span class="line">mysqld --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=3306 --print-defaults</span><br><span class="line">mysqladmin --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=_3306 --print-defaults</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动</span></span><br><span class="line">mysqld --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=3306 &amp;</span><br><span class="line">mysqld --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=8306 &amp;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">关闭</span></span><br><span class="line">mysqladmin --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=_3306 shutdown</span><br><span class="line">mysqladmin --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=_8306 shutdown</span><br></pre></td></tr></table></figure>

<h3 id="多实例"><a href="#多实例" class="headerlink" title="多实例"></a>多实例</h3><p>mysqld_multi 用于管理（启动、停止、查看状态）<strong>多个 MySQL 实例</strong>。<font color="red">仅搜索名为 <strong>[mysqldN]</strong> 的选项组。</font></p>
<p><font color="red"><code>mysqld_multi --user</code> ：调用 mysqladmin 时使用的 MySQL 数据库的账号。<strong>见选项文件的 [mysqld_multi] 组。</strong></font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysqld_multi [options] &#123;start|stop|reload|report&#125; [GNR[,GNR] ...]    多实例启动</span></span><br><span class="line">mysqld_multi --defaults-file=/data/local/mysql/my.cnf report # 查看mysql服务</span><br><span class="line">mysqld_multi --defaults-file=/data/local/mysql/my.cnf start # 启动所有组</span><br><span class="line">mysqld_multi --defaults-file=/data/local/mysql/my.cnf start 3306,8306</span><br><span class="line">mysqld_multi --defaults-file=/data/local/mysql/my.cnf stop  # 关闭所有组</span><br><span class="line">mysqld_multi --defaults-file=/data/local/mysql/my.cnf stop 3306,8306</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">若启动失败，请查看 mysqld_multi.log 或 各实例的错误日志</span></span><br><span class="line">cat -n /data/local/mysql/mysqld_multi.log | tail -n 20 # 显示文件的最后 10 行。</span><br><span class="line">cat -n /data/local/mysql/3306/log/error.log | tail -n 20</span><br><span class="line">cat -n /data/local/mysql/3307/log/error.log | tail -n 20</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">清空日志文件</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">/data/local/mysql/mysqld_multi.log</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">/data/local/mysql/3306/log/error.log</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">/data/local/mysql/3307/log/error.log</span></span><br></pre></td></tr></table></figure>

<h2 id="首次登录-远程访问-密码设置"><a href="#首次登录-远程访问-密码设置" class="headerlink" title="首次登录&#x2F;远程访问&#x2F;密码设置"></a>首次登录&#x2F;远程访问&#x2F;密码设置</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用 --initialize-insecure 初始化后的登录方式</span></span><br><span class="line">mysql -u root --skip-password -S /tmp/mysql_3306.sock</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用 --initialize 初始化后的登录方式</span></span><br><span class="line">mysql -u root -p -S /tmp/mysql_3306.sock</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置root远程访问</span></span><br><span class="line">use mysql;</span><br><span class="line">select host, user, plugin from mysql.user;</span><br><span class="line">update mysql.user set host=&#x27;%&#x27; where user=&#x27;root&#x27;;</span><br><span class="line">flush privileges;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改密码/设置密码</span></span><br><span class="line">alter user &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;123456789&#x27;;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改身份验证插件，并永久修改密码。8.0之后默认的身份验证插件是 caching_sha2_password</span></span><br><span class="line">alter user &#x27;root&#x27;@&#x27;%&#x27; identified with caching_sha2_password by &#x27;123456789&#x27; password expire never;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">alter user <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified with mysql_native_password by <span class="string">&#x27;123456789&#x27;</span> password expire never;</span></span><br><span class="line"></span><br><span class="line">quit/exit # 退出当前会话</span><br></pre></td></tr></table></figure>

<h2 id="重置Root密码"><a href="#重置Root密码" class="headerlink" title="重置Root密码"></a>重置Root密码</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/resetting-permissions.html">https://dev.mysql.com/doc/refman/8.4/en/resetting-permissions.html</a></p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/server-options.html#option_mysqld_skip-grant-tables"><code>--skip-grant-tables</code></a></p>
<h2 id="自动启停（多实例）"><a href="#自动启停（多实例）" class="headerlink" title="自动启停（多实例）"></a>自动启停（多实例）</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/automatic-start.html">https://dev.mysql.com/doc/refman/8.4/en/automatic-start.html</a></p>
<p>Linux 服务管理有两种方式 service 和 systemd 。</p>
<h3 id="systemd"><a href="#systemd" class="headerlink" title="systemd"></a>systemd</h3><p>使用 systemd 配置多个 MySQL 实例： <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/using-systemd.html">https://dev.mysql.com/doc/refman/8.4/en/using-systemd.html</a> </p>
<p>由于 systemd 具备在已安装 systemd 支持的平台上管理多个 MySQL 实例的能力，因此 mysqld_multi 和 mysqld_multi.server 变得不再必要，且不会被安装。</p>
<p><font color="red">@ 是 systemd 支持的唯一分隔符（模板单元标识符）。启动时 <code>mysqld@实例名.service</code>，systemd 会把 <strong>实例名</strong> 作为参数传递给模板单元文件，模板文件中可以通过 <code>%i</code>、<code>%I</code> 等变量引用这个实例名。</font></p>
<p>创建 systemd 服务配置文件 <code>vim /etc/systemd/system/mysqld@.service</code>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description= MySQL server</span><br><span class="line">Documentation= https://zh.wikipedia.org/wiki/Systemd</span><br><span class="line">After=syslog.target network.target network-online.target</span><br><span class="line">Wants=network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysqld      前台运行，需配置 Type=simple</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysqld_safe 后台运行，需配置 Type=forking，同时指定 PIDFile。测试 mysqld_safe 启动失败，可能需要配置选项组！！！</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PIDFile=/data/local/mysql/mysql-%I.pid</span></span><br><span class="line"></span><br><span class="line">User=mysql</span><br><span class="line">Group=mysql</span><br><span class="line"></span><br><span class="line">ExecStart=/data/local/mysql/bin/mysqld --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=%I</span><br><span class="line">ExecStop=/data/local/mysql/bin/mysqladmin --defaults-file=/data/local/mysql/my.cnf --defaults-group-suffix=_%I shutdown</span><br><span class="line">Restart=on-failure</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">文件描述符的数量</span></span><br><span class="line">LimitNOFILE=65535</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>systemd 服务管理工具 systemctl：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重新加载systemd服务配置文件</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"></span><br><span class="line">systemctl status mysqld@3306</span><br><span class="line">systemctl status mysqld@8306</span><br><span class="line">systemctl start mysqld@3306</span><br><span class="line">systemctl start mysqld@8306</span><br><span class="line">systemctl stop mysqld@3306</span><br><span class="line">systemctl stop mysqld@8306</span><br><span class="line">systemctl restart mysqld@3306</span><br><span class="line">systemctl restart mysqld@8306</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">开机自启</span></span><br><span class="line">systemctl enable mysqld@3306</span><br><span class="line">systemctl enable mysqld@8306</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">关闭自启</span></span><br><span class="line">systemctl disable mysqld@3306</span><br><span class="line">systemctl disable mysqld@8306</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看systemd journal日志</span></span><br><span class="line">journalctl -u mysqld@3306</span><br><span class="line">journalctl -u mysqld@8306</span><br></pre></td></tr></table></figure>

<h3 id="service"><a href="#service" class="headerlink" title="service"></a>service</h3><p>新增启动文件 <code>vim /etc/init.d/mysqld_multi</code> ，或从mysql目录中复制并修改 <code>cp /data/local/mysql/support-files/mysqld_multi.server /etc/init.d/mysqld_multi</code>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># A simple startup script for mysqld_multi by Tim Smith and Jani Tolonen.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This script assumes that my.cnf file exists either <span class="keyword">in</span> /etc/my.cnf or</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/root/.my.cnf and has <span class="built_in">groups</span> [mysqld_multi] and [mysqldN]. See the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysqld_multi documentation <span class="keyword">for</span> detailed instructions.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This script can be used as /etc/init.d/mysql.server</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Comments to support chkconfig on RedHat Linux</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">chkconfig: 2345 64 36</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">description: A very fast and reliable SQL database engine.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Version 1.0</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"></span></span><br><span class="line">basedir=/data/local/mysql</span><br><span class="line">bindir=/data/local/mysql/bin</span><br><span class="line">export PATH=$bindir:$PATH</span><br><span class="line"></span><br><span class="line">if test -x $bindir/mysqld_multi</span><br><span class="line">then</span><br><span class="line">  mysqld_multi=&quot;$bindir/mysqld_multi&quot;;</span><br><span class="line">else</span><br><span class="line">  echo &quot;Can&#x27;t execute $bindir/mysqld_multi from dir $basedir&quot;;</span><br><span class="line">  exit;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">    &#x27;start&#x27; )</span><br><span class="line">        &quot;$mysqld_multi&quot; --defaults-file=/data/local/mysql/my.cnf start $2</span><br><span class="line">        ;;</span><br><span class="line">    &#x27;stop&#x27; )</span><br><span class="line">        &quot;$mysqld_multi&quot; --defaults-file=/data/local/mysql/my.cnf stop $2</span><br><span class="line">        ;;</span><br><span class="line">    &#x27;report&#x27; )</span><br><span class="line">        &quot;$mysqld_multi&quot; --defaults-file=/data/local/mysql/my.cnf report $2</span><br><span class="line">        ;;</span><br><span class="line">    &#x27;restart&#x27; )</span><br><span class="line">        &quot;$mysqld_multi&quot; --defaults-file=/data/local/mysql/my.cnf stop $2</span><br><span class="line">        &quot;$mysqld_multi&quot; --defaults-file=/data/local/mysql/my.cnf start $2</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        echo &quot;Usage: $0 &#123;start|stop|report|restart&#125;&quot; &gt;&amp;2</span><br><span class="line">        ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<p>启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">chmod 750 /etc/init.d/mysqld_multi</span><br><span class="line"></span><br><span class="line">service mysqld_multi report</span><br><span class="line">service mysqld_multi start</span><br><span class="line">service mysqld_multi start 3306,3307</span><br><span class="line">service mysqld_multi stop</span><br><span class="line">service mysqld_multi stop 3306,3307</span><br></pre></td></tr></table></figure>

<p>设置开机启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置 mysqld_multi 服务在运行级别为2、3、4、5时启动。--level 指定读系统服务要在哪一个Linux运行级别中开启或关闭。</span></span><br><span class="line">chkconfig --level 2345 mysqld_multi on</span><br><span class="line">chkconfig --level 2345 mysqld_multi off</span><br></pre></td></tr></table></figure>

<h3 id="两种自启动区别"><a href="#两种自启动区别" class="headerlink" title="两种自启动区别"></a>两种自启动区别</h3><p>systemd 使用 mysqld 启动服务器。</p>
<p>service 使用 mysqld_multi 管理服务器，启动程序由 [mysqld_multi] 组的 mysqld 选项指定，默认是 mysqld，本文指定为 mysqld_safe。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="zhaolq 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="zhaolq 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/article/2022/01/MySQL_00%E7%B2%BE%E5%8D%8E/" rel="prev" title="MySQL_00精华">
                  <i class="fa fa-angle-left"></i> MySQL_00精华
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/article/2022/01/MySQL_03%E7%94%A8%E6%88%B7%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" rel="next" title="MySQL_03用户与权限管理">
                  MySQL_03用户与权限管理 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">zhaolq</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
