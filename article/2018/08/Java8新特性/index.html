<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.zhaolq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"androidstudio","dark":"androidstudio"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":true,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="Java 8 新特性 - 菜鸟   Java 8 Tutorials   Java 8 Tutorials  包含一些原计划在 Java 7 中却延迟发布的功能。 简介我们通常所说的接口的作用是用于定义一套标准、约束、规范等，接口中的方法只声明方法的签名，不提供相应的方法体，方法体由对应的实现类去实现。 在JDK1.8中打破了这样的认识，接口中的方法可以有方法体，但需要关键字static或者de">
<meta property="og:type" content="article">
<meta property="og:title" content="Java8新特性">
<meta property="og:url" content="https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/index.html">
<meta property="og:site_name" content="洋蔥">
<meta property="og:description" content="Java 8 新特性 - 菜鸟   Java 8 Tutorials   Java 8 Tutorials  包含一些原计划在 Java 7 中却延迟发布的功能。 简介我们通常所说的接口的作用是用于定义一套标准、约束、规范等，接口中的方法只声明方法的签名，不提供相应的方法体，方法体由对应的实现类去实现。 在JDK1.8中打破了这样的认识，接口中的方法可以有方法体，但需要关键字static或者de">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/1.jpg">
<meta property="og:image" content="https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/20200525225333187.jpg">
<meta property="og:image" content="https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/20200529215128935.jpg">
<meta property="og:image" content="https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/image-20200921161008424.png">
<meta property="article:published_time" content="2018-08-04T00:00:25.000Z">
<meta property="article:modified_time" content="2018-08-04T00:00:25.000Z">
<meta property="article:author" content="zhaolq">
<meta property="article:tag" content="JDK">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/1.jpg">


<link rel="canonical" href="https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/","path":"article/2018/08/Java8新特性/","title":"Java8新特性"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Java8新特性 | 洋蔥</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>



  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">洋蔥</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">耳不闻人是非，目不视人之短，口不言人之过。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E5%92%8C%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95%E7%9A%84%E4%BD%9C%E7%94%A8%EF%BC%9A"><span class="nav-number">1.1.</span> <span class="nav-text">静态方法和默认方法的作用：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95-default"><span class="nav-number">2.</span> <span class="nav-text">默认方法(default)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95-static"><span class="nav-number">3.</span> <span class="nav-text">静态方法(static)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3-FunctionalInterface"><span class="nav-number">4.</span> <span class="nav-text">函数式接口(@FunctionalInterface)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3%E7%94%A8%E9%80%94"><span class="nav-number">4.1.</span> <span class="nav-text">函数式接口用途</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E-FunctionalInterface-%E6%B3%A8%E8%A7%A3"><span class="nav-number">4.2.</span> <span class="nav-text">关于 @FunctionalInterface 注解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%81%E8%AE%B8%E5%AE%9A%E4%B9%89%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95"><span class="nav-number">4.3.</span> <span class="nav-text">允许定义默认方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%81%E8%AE%B8%E5%AE%9A%E4%B9%89%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="nav-number">4.4.</span> <span class="nav-text">允许定义静态方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%81%E8%AE%B8%E9%87%8D%E5%86%99java-lang-Object%E9%87%8C%E7%9A%84public%E6%96%B9%E6%B3%95"><span class="nav-number">4.5.</span> <span class="nav-text">允许重写java.lang.Object里的public方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JDK%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3"><span class="nav-number">4.6.</span> <span class="nav-text">JDK中的函数式接口</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">5.</span> <span class="nav-text">Lambda表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B%EF%BC%9A"><span class="nav-number">5.1.</span> <span class="nav-text">简介：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="nav-number">5.2.</span> <span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%EF%BC%9A"><span class="nav-number">5.3.</span> <span class="nav-text">特征：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8%EF%BC%9A"><span class="nav-number">5.4.</span> <span class="nav-text">作用：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E5%8C%BF%E5%90%8D%E5%AF%B9%E8%B1%A1%E7%9B%B8%E6%AF%94%EF%BC%9A"><span class="nav-number">5.5.</span> <span class="nav-text">Lambda表达式与匿名对象相比：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8"><span class="nav-number">6.</span> <span class="nav-text">方法引用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#IPhone%E7%B1%BB"><span class="nav-number">6.1.</span> <span class="nav-text">IPhone类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Test%E7%B1%BB"><span class="nav-number">6.2.</span> <span class="nav-text">Test类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E5%99%A8%E5%BC%95%E7%94%A8"><span class="nav-number">6.3.</span> <span class="nav-text">构造器引用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8"><span class="nav-number">6.4.</span> <span class="nav-text">静态方法引用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E5%AE%9A%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8"><span class="nav-number">6.5.</span> <span class="nav-text">特定对象的方法引用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%B3%A8%E8%A7%A3%E5%92%8C%E9%87%8D%E5%A4%8D%E6%B3%A8%E8%A7%A3"><span class="nav-number">7.</span> <span class="nav-text">类型注解和重复注解</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4-API"><span class="nav-number">8.</span> <span class="nav-text">日期和时间 API</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="nav-number">8.1.</span> <span class="nav-text">主要方法：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-LocalDate%E3%80%81-LocalTime%E3%80%81-LocalDateTime"><span class="nav-number">8.2.</span> <span class="nav-text">使用 LocalDate、 LocalTime、 LocalDateTime</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Instant-%E6%97%B6%E9%97%B4%E6%88%B3"><span class="nav-number">8.3.</span> <span class="nav-text">Instant 时间戳</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Duration-%E5%92%8C-Period"><span class="nav-number">8.4.</span> <span class="nav-text">Duration 和 Period</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E7%9A%84%E6%93%8D%E7%BA%B5"><span class="nav-number">8.5.</span> <span class="nav-text">日期的操纵</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E4%B8%8E%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-number">8.6.</span> <span class="nav-text">解析与格式化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%B6%E5%8C%BA%E7%9A%84%E5%A4%84%E7%90%86"><span class="nav-number">8.7.</span> <span class="nav-text">时区的处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8E%E4%BC%A0%E7%BB%9F%E6%97%A5%E6%9C%9F%E5%A4%84%E7%90%86%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="nav-number">8.8.</span> <span class="nav-text">与传统日期处理的转换</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Optional-%E7%B1%BB"><span class="nav-number">9.</span> <span class="nav-text">Optional 类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFOptional%E7%B1%BB"><span class="nav-number">9.1.</span> <span class="nav-text">什么是Optional类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Optional%E7%B1%BB%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="nav-number">9.1.1.</span> <span class="nav-text">Optional类常用方法：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%86%99-Object-%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="nav-number">9.1.2.</span> <span class="nav-text">重写 Object 的方法：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Optional%E7%B1%BB%E7%A4%BA%E4%BE%8B"><span class="nav-number">9.2.</span> <span class="nav-text">Optional类示例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAOptional%E7%B1%BB"><span class="nav-number">9.2.1.</span> <span class="nav-text">创建Optional类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#isPresent"><span class="nav-number">9.2.2.</span> <span class="nav-text">isPresent</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#get"><span class="nav-number">9.2.3.</span> <span class="nav-text">get</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orElse%E5%92%8CorElseGet"><span class="nav-number">9.2.4.</span> <span class="nav-text">orElse和orElseGet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orElseThrow"><span class="nav-number">9.2.5.</span> <span class="nav-text">orElseThrow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#map"><span class="nav-number">9.2.6.</span> <span class="nav-text">map</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flatMap"><span class="nav-number">9.2.7.</span> <span class="nav-text">flatMap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filter"><span class="nav-number">9.2.8.</span> <span class="nav-text">filter</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Stream-API"><span class="nav-number">10.</span> <span class="nav-text">Stream API</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">10.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Stream%EF%BC%9F"><span class="nav-number">10.2.</span> <span class="nav-text">什么是 Stream？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Stream%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="nav-number">10.3.</span> <span class="nav-text">Stream操作步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BAStream%E6%B5%81%EF%BC%9F"><span class="nav-number">10.4.</span> <span class="nav-text">如何创建Stream流？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Collection%E6%8E%A5%E5%8F%A3%E7%9A%84%E4%B8%A4%E4%B8%AAdefault%E6%96%B9%E6%B3%95"><span class="nav-number">10.4.1.</span> <span class="nav-text">Collection接口的两个default方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Arrays%E5%B7%A5%E5%85%B7%E7%B1%BB%E7%9A%84%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95stream"><span class="nav-number">10.4.2.</span> <span class="nav-text">Arrays工具类的静态方法stream()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Stream%E7%B1%BB%E7%9A%84%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95of"><span class="nav-number">10.4.3.</span> <span class="nav-text">Stream类的静态方法of()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Random%E7%B1%BB"><span class="nav-number">10.4.4.</span> <span class="nav-text">Random类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%97%A0%E9%99%90%E6%B5%81"><span class="nav-number">10.4.5.</span> <span class="nav-text">创建无限流</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Stream%E7%B1%BB"><span class="nav-number">10.4.5.1.</span> <span class="nav-text">Stream类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Random%E7%B1%BB-1"><span class="nav-number">10.4.5.2.</span> <span class="nav-text">Random类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%A9%BA%E6%B5%81"><span class="nav-number">10.4.6.</span> <span class="nav-text">创建空流</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C%E6%B5%81%E4%B8%8E%E4%B8%B2%E8%A1%8C%E6%B5%81"><span class="nav-number">10.5.</span> <span class="nav-text">并行流与串行流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B9%B6%E8%A1%8C%E6%B5%81%EF%BC%9F"><span class="nav-number">10.5.1.</span> <span class="nav-text">什么是并行流？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fork-Join-%E6%A1%86%E6%9E%B6"><span class="nav-number">10.5.2.</span> <span class="nav-text">Fork&#x2F;Join 框架</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Fork-Join-%E6%A1%86%E6%9E%B6%E4%B8%8E%E4%BC%A0%E7%BB%9F%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%9C%89%E5%95%A5%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="nav-number">10.5.2.1.</span> <span class="nav-text">Fork&#x2F;Join 框架与传统线程池有啥区别？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fork-Join%E6%A1%86%E6%9E%B6%E5%AE%9E%E4%BE%8B"><span class="nav-number">10.5.2.2.</span> <span class="nav-text">Fork&#x2F;Join框架实例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1"><span class="nav-number">10.6.</span> <span class="nav-text">统计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Stream%E7%9A%84%E4%B8%AD%E9%97%B4%E6%93%8D%E4%BD%9C"><span class="nav-number">10.7.</span> <span class="nav-text">Stream的中间操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%9B%E9%80%89%E4%B8%8E%E5%88%87%E7%89%87"><span class="nav-number">10.7.1.</span> <span class="nav-text">筛选与切片</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#filter-1"><span class="nav-number">10.7.1.1.</span> <span class="nav-text">filter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#limit"><span class="nav-number">10.7.1.2.</span> <span class="nav-text">limit</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#skip"><span class="nav-number">10.7.1.3.</span> <span class="nav-text">skip</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#distinct"><span class="nav-number">10.7.1.4.</span> <span class="nav-text">distinct</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%A0%E5%B0%84"><span class="nav-number">10.7.2.</span> <span class="nav-text">映射</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#map-1"><span class="nav-number">10.7.2.1.</span> <span class="nav-text">map</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#flatMap-1"><span class="nav-number">10.7.2.2.</span> <span class="nav-text">flatMap</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-number">10.7.3.</span> <span class="nav-text">排序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sorted"><span class="nav-number">10.7.3.1.</span> <span class="nav-text">sorted</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Stream%E7%9A%84%E7%BB%88%E6%AD%A2%E6%93%8D%E4%BD%9C"><span class="nav-number">10.8.</span> <span class="nav-text">Stream的终止操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#forEach"><span class="nav-number">10.8.1.</span> <span class="nav-text">forEach</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E4%B8%8E%E5%8C%B9%E9%85%8D"><span class="nav-number">10.8.2.</span> <span class="nav-text">查找与匹配</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#allMatch"><span class="nav-number">10.8.2.1.</span> <span class="nav-text">allMatch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#anyMatch"><span class="nav-number">10.8.2.2.</span> <span class="nav-text">anyMatch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#noneMatch"><span class="nav-number">10.8.2.3.</span> <span class="nav-text">noneMatch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#findFirst"><span class="nav-number">10.8.2.4.</span> <span class="nav-text">findFirst</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#findAny"><span class="nav-number">10.8.2.5.</span> <span class="nav-text">findAny</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%84%E7%BA%A6%E5%92%8C%E6%94%B6%E9%9B%86"><span class="nav-number">10.8.3.</span> <span class="nav-text">规约和收集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#count"><span class="nav-number">10.8.3.1.</span> <span class="nav-text">count</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#max%E5%92%8Cmin"><span class="nav-number">10.8.3.2.</span> <span class="nav-text">max和min</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#reduce"><span class="nav-number">10.8.3.3.</span> <span class="nav-text">reduce</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Collector%E5%92%8CCollectors"><span class="nav-number">10.8.3.4.</span> <span class="nav-text">Collector和Collectors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Collectors%E4%BB%8B%E7%BB%8D"><span class="nav-number">10.8.3.5.</span> <span class="nav-text">Collectors介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#collect"><span class="nav-number">10.8.3.6.</span> <span class="nav-text">collect</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E4%B8%BA-Collector-%E5%AF%B9%E8%B1%A1%E5%AE%9E%E7%8E%B0"><span class="nav-number">10.8.3.6.1.</span> <span class="nav-text">参数为 Collector 对象实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E4%B8%BA%E4%B8%89%E4%B8%AA%E5%AF%B9%E8%B1%A1%E5%AE%9E%E7%8E%B0"><span class="nav-number">10.8.3.6.2.</span> <span class="nav-text">参数为三个对象实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#parallelStream%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="nav-number">10.8.3.6.3.</span> <span class="nav-text">parallelStream线程安全问题</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0"><span class="nav-number">10.9.</span> <span class="nav-text">练习</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Base64"><span class="nav-number">11.</span> <span class="nav-text">Base64</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhaolq"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">zhaolq</p>
  <div class="site-description" itemprop="description">有用、有趣、有情义！</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">555</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hellozhaolq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hellozhaolq" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hello.zhaolq@qq.com" title="E-Mail → mailto:hello.zhaolq@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaolq.com/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zhaolq">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="洋蔥">
      <meta itemprop="description" content="有用、有趣、有情义！">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Java8新特性 | 洋蔥">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Java8新特性
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-04 08:00:25" itemprop="dateCreated datePublished" datetime="2018-08-04T08:00:25+08:00">2018-08-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p> <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-new-features.html">Java 8 新特性 - 菜鸟</a> </p>
<p> <a target="_blank" rel="noopener" href="https://mkyong.com/tutorials/java-8-tutorials">Java 8 Tutorials</a> </p>
<p> <a target="_blank" rel="noopener" href="https://howtodoinjava.com/java8/">Java 8 Tutorials</a> </p>
<p>包含一些原计划在 Java 7 中却延迟发布的功能。</p>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>我们通常所说的接口的作用是用于定义一套标准、约束、规范等，接口中的方法只声明方法的签名，不提供相应的方法体，方法体由对应的实现类去实现。</p>
<p>在JDK1.8中打破了这样的认识，接口中的方法可以有方法体，但需要关键字static或者default来修饰，使用static来修饰的称之为静态方法，静态方法通过接口名来调用，使用default来修饰的称之为默认方法，默认方法通过实例对象来调用。</p>
<h2 id="静态方法和默认方法的作用："><a href="#静态方法和默认方法的作用：" class="headerlink" title="静态方法和默认方法的作用："></a>静态方法和默认方法的作用：</h2><p>静态方法和默认方法都有自己的方法体，用于提供一套默认的实现，这样子类对于该方法就不需要强制来实现，可以选择使用默认的实现，也可以重写自己的实现。当为接口扩展方法时，只需要提供该方法的默认实现即可，至于对应的实现类可以重写也可以使用默认的实现，这样所有的实现类不会报语法错误：Xxx不是抽象的, 并且未覆盖Yxx中的抽象方法。</p>
<span id="more"></span>

<h1 id="默认方法-default"><a href="#默认方法-default" class="headerlink" title="默认方法(default)"></a>默认方法(default)</h1><p> <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-default-methods.html">Java 8 默认方法 - 菜鸟</a> </p>
<p>默认方法就是<font color="red">接口可以有实现方法，而且不需要实现类去实现</font>。</p>
<p>用法：</p>
<ul>
<li><p>使用 <code>default</code> 关键字修饰，访问权限默认且一定为 public。</p>
</li>
<li><p>只能在接口中定义，且必须加 body 实现</p>
</li>
<li><p>支持重载</p>
</li>
<li><p>子类可重写：<br>&nbsp;&nbsp;&nbsp;&nbsp;1、接口的 default 方法可以被 <strong>子接口</strong> 重写成 <strong>default 方法</strong>；<br>&nbsp;&nbsp;&nbsp;&nbsp;2、接口的 default 方法可以被 <strong>子接口</strong> 重写成 <strong>抽象方法</strong>；<br>&nbsp;&nbsp;&nbsp;&nbsp;3、接口的 default 方法可以被   <strong>子类</strong>   重写成 <strong>普通方法</strong>；</p>
</li>
<li><p>JDK1.8 可以通过反射判断接口的某个方法是否为 default 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span>Chinese.class.getMethod(<span class="string">&quot;speak&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;It is &quot;</span>+m.isDefault()+<span class="string">&quot; that &quot;</span>+m.getName()+<span class="string">&quot; is default method&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<p><span style="background-color:#D1EEEE;"><strong>为什么要有这个特性？</strong></span> </p>
<p><span style="background-color:#D1EEEE;">首先，之前的接口是个双刃剑，好处是面向抽象而不是面向具体编程，缺陷是，当需要修改接口时候，需要修改全部实现该接口的类，目前的 java 8 之前的集合框架没有 foreach 方法，通常能想到的解决办法是在JDK里给相关的接口添加新的方法及实现。然而，对于已经发布的版本，是没法在给接口添加新方法的同时不影响已有的实现。所以引进的默认方法。他们的目的是为了解决接口的修改与现有的实现不兼容的问题。</span> </p>
<p><font size="5"><strong>多个接口默认方法相同</strong></font> </p>
<p>一个类实现了多个接口，且这些接口有相同的默认方法，那么这个类就不知道继承哪个接口的默认方法，编译器会报错。解决方案如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line">   <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span>&#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;我是一辆车!&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">FourWheeler</span> &#123;</span><br><span class="line">   <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span>&#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;我是一辆四轮车!&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font size="4"><strong>方案一</strong></font> ：重写接口的默认方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在interface中重写interface的方法，继续使用 `default` 修饰。</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Car</span> <span class="keyword">extends</span> <span class="title class_">Vehicle</span>, FourWheeler &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;我是一辆四轮汽车!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在class中重写interface的方法，不能使用 `default` 修饰，必须有 public 访问权限。</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> <span class="keyword">implements</span> <span class="title class_">Vehicle</span>, FourWheeler &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;我是一辆四轮汽车!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font size="4"><strong>方案二</strong></font> ：重写接口的默认方法，使用 <code>super</code> 来调用指定接口的默认方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Car</span> <span class="keyword">extends</span> <span class="title class_">Vehicle</span>, FourWheeler &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        Vehicle.<span class="built_in">super</span>.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> <span class="keyword">implements</span> <span class="title class_">Vehicle</span>, FourWheeler &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        Vehicle.<span class="built_in">super</span>.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="静态方法-static"><a href="#静态方法-static" class="headerlink" title="静态方法(static)"></a>静态方法(static)</h1><p>接口可以定义静态方法。</p>
<p>用法：</p>
<ul>
<li>使用 <code>static</code> 关键字修饰，访问权限默认且一定为 public。</li>
<li>可以在类、接口、枚举中定义 (注解类型除外)，必须加 body 实现</li>
<li>支持重载</li>
<li>子类不可重写。</li>
</ul>
<p>提示：静态方法属于类，无论在哪里定义，都必须有 body 实现。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;我是一辆车!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 静态方法</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">blowHorn</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;按喇叭!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Java8Tester</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span> &#123;</span><br><span class="line">        <span class="type">Vehicle</span> <span class="variable">vehicle</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>();</span><br><span class="line">        vehicle.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;我是一辆车!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">blowHorn</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;按喇叭!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">FourWheeler</span> &#123;</span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;我是一辆四轮车!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> <span class="keyword">implements</span> <span class="title class_">Vehicle</span>, FourWheeler &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        Vehicle.<span class="built_in">super</span>.print();</span><br><span class="line">        FourWheeler.<span class="built_in">super</span>.print();</span><br><span class="line">        Vehicle.blowHorn();</span><br><span class="line">        System.out.println(<span class="string">&quot;我是一辆汽车!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="函数式接口-FunctionalInterface"><a href="#函数式接口-FunctionalInterface" class="headerlink" title="函数式接口(@FunctionalInterface)"></a>函数式接口(@FunctionalInterface)</h1><p> <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-functional-interfaces.html">Java 8 函数式接口 - 菜鸟</a> </p>
<p>函数式接口 (Functional Interface) 就是一个<font color="red">有且仅有一个抽象方法</font>，但是可以<font color="red">有多个非抽象方法</font>的接口。</p>
<p>函数式接口可以被隐式转换为 Lambda 表达式。</p>
<h2 id="函数式接口用途"><a href="#函数式接口用途" class="headerlink" title="函数式接口用途"></a>函数式接口用途</h2><p>主要用在 Lambda 表达式和方法引用（实际上也可认为是 Lambda 表达式）上。Lambda 表达式为函数式接口提供实现。</p>
<p>如下定义了一个函数式接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">GreetingService</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">sayMessage</span><span class="params">(String message)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么就可以使用 Lambda 表达式来表示该接口的一个实现 (注：<font color="red">JAVA 8 之前一般是用匿名对象实现</font>)：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">GreetingService</span> <span class="variable">greetService1</span> <span class="operator">=</span> message -&gt; System.out.println(<span class="string">&quot;Hello &quot;</span> + message);</span><br></pre></td></tr></table></figure>

<h2 id="关于-FunctionalInterface-注解"><a href="#关于-FunctionalInterface-注解" class="headerlink" title="关于 @FunctionalInterface 注解"></a>关于 @FunctionalInterface 注解</h2><p>Java 8 为函数式接口引入了一个新注解 <code>@FunctionalInterface</code>，主要用于<strong>编译级错误检查</strong>，加上该注解，当你写的接口不符合函数式接口定义的时候，编译器会报错。</p>
<p><font color="red">加不加 <code>@FunctionalInterface</code> 对于接口是不是函数式接口没有影响，该注解只是提醒编译器去检查该接口是否仅包含一个抽象方法。</font></p>
<h2 id="允许定义默认方法"><a href="#允许定义默认方法" class="headerlink" title="允许定义默认方法"></a>允许定义默认方法</h2><p>函数式接口里是可以包含默认方法，因为默认方法不是抽象方法，其有一个默认实现，所以是符合函数式接口的定义的；</p>
<h2 id="允许定义静态方法"><a href="#允许定义静态方法" class="headerlink" title="允许定义静态方法"></a>允许定义静态方法</h2><p>函数式接口里是可以包含静态方法，因为静态方法不能是抽象方法，是一个已经实现了的方法，所以是符合函数式接口的定义的；</p>
<h2 id="允许重写java-lang-Object里的public方法"><a href="#允许重写java-lang-Object里的public方法" class="headerlink" title="允许重写java.lang.Object里的public方法"></a>允许重写java.lang.Object里的public方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">InterfaceA</span> <span class="variable">i</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        i.toString();</span><br><span class="line">        i.equals(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        i.hashCode();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">InterfaceA</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    String <span class="title function_">toString</span><span class="params">()</span>; <span class="comment">// 不算抽象方法</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">finalize</span><span class="params">()</span>; <span class="comment">// 算抽象方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <span style="background-color:#1E90FF;">&nbsp;&nbsp;&nbsp;&nbsp;<font color="white" size="4" background><strong>接口是否继承于Object类？</strong></font>&nbsp;&nbsp;&nbsp;&nbsp;</span> </p>
<p>推荐连接： <a target="_blank" rel="noopener" href="https://xingao98.top/2020/04/08/java%E6%8E%A5%E5%8F%A3%E6%98%AF%E5%90%A6%E4%B9%9F%E7%BB%A7%E6%89%BF%E4%BA%8EObject%E7%B1%BB%EF%BC%9F/">接口是否继承于Object类</a> </p>
<p>Interface 并没有继承 Object 类，接口中的方法有三个来源（<strong>这不是 jdk 8 的特性</strong>） ：</p>
<ul>
<li>接口声明的方法</li>
<li>父接口声明的方法</li>
<li>当接口没有直接的 SuperInterface 时，Java 接口的特殊处理会隐式地声明 Object 类里所有 public 方法。也可以手动在接口中显式声明 (即 override )。<font color="red">不算抽象方法</font>。<br>调用这些隐式方法时会调 Object 类里的方法。<br>Object 类里的 protected 方法（例如：<code>finalize()</code>）不会被隐式的声明。也就意味着，如果在接口中定义 <code>finalize()</code> 方法，那它就<font color="red">算抽象方法</font>。</li>
</ul>
<h2 id="JDK中的函数式接口"><a href="#JDK中的函数式接口" class="headerlink" title="JDK中的函数式接口"></a>JDK中的函数式接口</h2><p>函数式接口可以对现有的函数友好地支持 Lambda 。</p>
<p><font color="blue">JDK 1.8 之前已有的函数式接口：</font> </p>
<ul>
<li>java.lang.Runnable</li>
<li>java.util.concurrent.Callable</li>
<li>java.security.PrivilegedAction</li>
<li>java.util.Comparator</li>
<li>java.io.FileFilter</li>
<li>java.nio.file.PathMatcher</li>
<li>java.lang.reflect.InvocationHandler</li>
<li>java.beans.PropertyChangeListener</li>
<li>java.awt.event.ActionListener</li>
<li>javax.swing.event.ChangeListener</li>
</ul>
<p><font color="blue">JDK 1.8 新增的函数式接口：</font> </p>
<ul>
<li>java.util.function</li>
</ul>
<p>函数式接口示例： <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-functional-interfaces.html">Java 8 函数式接口 - 菜鸟</a> </p>
<h1 id="Lambda表达式"><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h1><p> <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-lambda-expressions.html">Java 8 Lambda 表达式 - 菜鸟</a> </p>
<p><font color="blue">推荐链接：</font> <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html">学习Javascript闭包 (Closure) - 阮一峰</a> 、 <a target="_blank" rel="noopener" href="https://blog.csdn.net/zengyonglan/article/details/53435030">匿名函数与闭包的区别</a> </p>
<h2 id="简介："><a href="#简介：" class="headerlink" title="简介："></a><font color="red"><strong>简介：</strong></font></h2><p>Lambda 表达式是一个 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0">匿名函数</a> ，官方称为 lambda 表达式，非官方亦称 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%97%AD%E5%8C%85_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)">闭包</a> ，它是推动 Java 8 发布的最重要新特性。</p>
<p>Lambda 表达式允许把函数作为一个方法的参数（函数作为参数传递进方法中）。</p>
<p>使用 Lambda 表达式可以使代码变的更加简洁紧凑。</p>
<h2 id="语法："><a href="#语法：" class="headerlink" title="语法："></a><font color="red"><strong>语法：</strong></font></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(parameters) -&gt; expression</span><br><span class="line">或</span><br><span class="line">(parameters) -&gt;&#123; statements; &#125;</span><br></pre></td></tr></table></figure>

<h2 id="特征："><a href="#特征：" class="headerlink" title="特征："></a><font color="red"><strong>特征：</strong></font></h2><ul>
<li>**可选类型声明：**不需要声明参数类型，编译器可以统一识别参数值。</li>
<li>**可选的参数圆括号：**一个参数无需定义圆括号，但多个参数需要定义圆括号。</li>
<li>**可选的大括号：**如果主体包含了一个语句，就不需要使用大括号。</li>
<li>**可选的返回关键字：**如果主体只有一个表达式返回值则编译器会自动返回值，大括号需要指定明表达式返回了一个数值。</li>
</ul>
<h2 id="作用："><a href="#作用：" class="headerlink" title="作用："></a><font color="red"><strong>作用：</strong></font></h2><p>Lambda 表达式主要用来定义行内执行的方法类型接口。</p>
<p>Lambda 表达式免去了使用匿名方法的麻烦，并且给予Java简单但强大的 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B">函数式编程</a> 能力。</p>
<h2 id="Lambda表达式与匿名对象相比："><a href="#Lambda表达式与匿名对象相比：" class="headerlink" title="Lambda表达式与匿名对象相比："></a><font color="red"><strong>Lambda表达式与匿名对象相比：</strong></font></h2><p><font color="blue" size="5"><strong>相同：</strong></font> </p>
<p>可以直接访问外层环境的变量，但此变量不允许被后面的代码修改，无论是在内部还是外层，否则会编译错误（即：外层环境的变量，隐性的具有 final 语义）。</p>
<p><font color="blue" size="5"><strong>不同：</strong></font> </p>
<p><font color="red"><strong>1、作用域</strong></font> </p>
<p>Lambda 表达式：基于<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BD%9C%E7%94%A8%E5%9F%9F">词法作用域</a>，也就是说 Lambda 表达式函数体里面的变量和它外层环境的变量具有相同的语义（也包括 Lambda 表达式的形式参数）。简言之，Lambda 表达式中<strong>不允许</strong>声明与外层环境的变量同名的形式参数或者局部变量。<strong>代码块亦是如此。</strong></p>
<p>匿名对象：拥有新的作用域，<strong>允许</strong>声明与外层环境的变量同名的形式参数或者局部变量。</p>
<p><font color="red"><strong>2、this关键字</strong></font> </p>
<p>Lambda 表达式：内部和外部也拥有相同的语义，所以其内部 this 代表外部对象的引用。<strong>代码块亦是如此。</strong></p>
<p>匿名对象：其中的 this 代表该匿名对象的引用。</p>
<p><font color="red"><strong>3、继承</strong></font> </p>
<p>Lambda 表达式：不会从超类（supertype）中继承任何变量。超类不允许有其他抽象方法 (<strong>函数式接口</strong>)。</p>
<p>匿名对象：会继承超类中任何变量和抽象方法，且必须实现全部抽象方法。</p>
<h1 id="方法引用"><a href="#方法引用" class="headerlink" title="方法引用"></a>方法引用</h1><p> <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-method-references.html">Java 8 方法引用 - 菜鸟</a> </p>
<p>Java8 中引入方法引用新特性，用于简化应用对象方法的调用，方法引用是用来直接访问类和实例已经存在的方法或构造方法。 </p>
<p>方法引用提供了一种引用而不执行方法的方式，它需要由兼容的函数式接口构成目标类型上下文。计算时，方法引用会创建函数式接口的一个实例。 </p>
<p>当Lambda表达式只执行一个方法调用时，可替换成其等效的方法引用。</p>
<p><font color="red">方法引用是</font>一种更简洁易懂的 <font color="red">Lambda 表达式</font>。</p>
<p>方法引用使用一对冒号 <strong>::</strong> 。</p>
<h2 id="IPhone类"><a href="#IPhone类" class="headerlink" title="IPhone类"></a>IPhone类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.function.BiFunction;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Supplier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IPhone</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Long price;</span><br><span class="line">    <span class="keyword">private</span> Date createDate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">IPhone</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">IPhone</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">IPhone</span><span class="params">(Long id, String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">IPhone</span><span class="params">(Long id, String name, Long price)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">IPhone</span><span class="params">(Long id, String name, Long price, Date createDate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.price = price;</span><br><span class="line">        <span class="built_in">this</span>.createDate = createDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;IPhone&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, price=&quot;</span> + price +</span><br><span class="line">                <span class="string">&quot;, createDate=&quot;</span> + createDate +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Info &quot;</span> + <span class="string">&quot;这是一部IPhone&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">info</span><span class="params">(Long id, String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Info &quot;</span> + <span class="string">&quot;id=&quot;</span> + id + <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> IPhone <span class="title function_">create</span><span class="params">(Long id, String name)</span> &#123;</span><br><span class="line">        BiFunction&lt;Long, String, IPhone&gt; factory = IPhone::<span class="keyword">new</span>;</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone</span> <span class="operator">=</span> factory.apply(id, name);</span><br><span class="line">        System.out.println(<span class="string">&quot;Creating &quot;</span> + iPhone.toString());</span><br><span class="line">        <span class="keyword">return</span> iPhone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> IPhone <span class="title function_">create</span><span class="params">(<span class="keyword">final</span> Supplier&lt;IPhone&gt; supplier)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> supplier.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">recover</span><span class="params">(<span class="keyword">final</span> IPhone IPhone)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Recovering &quot;</span> + IPhone.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">copy</span><span class="params">(<span class="keyword">final</span> IPhone another)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Copying the &quot;</span> + another.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">repair</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Repaired &quot;</span> + <span class="built_in">this</span>.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Test类"><a href="#Test类" class="headerlink" title="Test类"></a>Test类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1、构造器引用，语法：Class::new 或 Class&lt; T &gt;::new</span></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone1</span> <span class="operator">=</span> IPhone.create(() -&gt; <span class="keyword">new</span> <span class="title class_">IPhone</span>());</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone2</span> <span class="operator">=</span> IPhone.create(IPhone::<span class="keyword">new</span>);</span><br><span class="line">        List&lt;IPhone&gt; iPhones = Arrays.asList(iPhone1, iPhone2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2、静态方法引用，语法：Class::static_method</span></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        iPhones.forEach(item -&gt; IPhone.recover(item));</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        iPhones.forEach(IPhone::recover);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3、特定对象的方法引用，语法：instance::method</span></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        iPhones.forEach((item) -&gt; IPhone.create(() -&gt; <span class="keyword">new</span> <span class="title class_">IPhone</span>()).copy(item));</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        iPhones.forEach(IPhone.create(IPhone::<span class="keyword">new</span>)::copy);</span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        iPhones.forEach(item -&gt; System.out.println(item));</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        iPhones.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4、特定类的任意对象的方法引用，语法：Class::method</span></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        iPhones.forEach(item -&gt; item.repair());</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        iPhones.forEach(IPhone::repair);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="构造器引用"><a href="#构造器引用" class="headerlink" title="构造器引用"></a>构造器引用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 构造器引用，语法：Class::new 或 Class&lt; T &gt;::new</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 无参构造器</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        Supplier&lt;IPhone&gt; factory_01 = () -&gt; <span class="keyword">new</span> <span class="title class_">IPhone</span>();</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_01</span> <span class="operator">=</span> factory_01.get();</span><br><span class="line">        System.out.println(iPhone_01);</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        Supplier&lt;IPhone&gt; factory_02 = IPhone::<span class="keyword">new</span>;</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_02</span> <span class="operator">=</span> factory_02.get();</span><br><span class="line">        System.out.println(iPhone_02);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 当构造器方法存在参数 参数个数为1个时</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        Function&lt;Long, IPhone&gt; factory_03 = (id) -&gt; <span class="keyword">new</span> <span class="title class_">IPhone</span>(id);</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_03</span> <span class="operator">=</span> factory_03.apply(<span class="number">2020L</span>);</span><br><span class="line">        System.out.println(iPhone_03);</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        Function&lt;Long, IPhone&gt; factory_04 = IPhone::<span class="keyword">new</span>;</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_04</span> <span class="operator">=</span> factory_04.apply(<span class="number">2020L</span>);</span><br><span class="line">        System.out.println(iPhone_04);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 当构造器方法存在参数 参数个数为2个时</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        BiFunction&lt;Long, String, IPhone&gt; factory_05 = (id, name) -&gt; <span class="keyword">new</span> <span class="title class_">IPhone</span>(id, name);</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_05</span> <span class="operator">=</span> factory_05.apply(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>);</span><br><span class="line">        System.out.println(iPhone_05);</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        BiFunction&lt;Long, String, IPhone&gt; factory_06 = IPhone::<span class="keyword">new</span>;</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_06</span> <span class="operator">=</span> factory_06.apply(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>);</span><br><span class="line">        System.out.println(iPhone_06);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 当构造器参数参过2个时怎么解决呢？？？</span></span><br><span class="line"><span class="comment">         * 自定义函数式接口。</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        MyFunction&lt;Long, String, Long, IPhone&gt; factory_07 = (id, name, price) -&gt; <span class="keyword">new</span> <span class="title class_">IPhone</span>(id, name, price);</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_07</span> <span class="operator">=</span> factory_07.apply(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>, <span class="number">9999L</span>);</span><br><span class="line">        System.out.println(iPhone_07);</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        MyFunction&lt;Long, String, Long, IPhone&gt; factory_08 = IPhone::<span class="keyword">new</span>;</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_08</span> <span class="operator">=</span> factory_08.apply(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>, <span class="number">9999L</span>);</span><br><span class="line">        System.out.println(iPhone_08);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Java8的Function接口(compose和andThen)</span></span><br><span class="line">        Function&lt;Long, Long&gt; a = i -&gt; i * <span class="number">2</span>;</span><br><span class="line">        Function&lt;Long, Long&gt; b = i -&gt; i * i;</span><br><span class="line">        System.out.println(a.compose(b).apply(<span class="number">5L</span>));</span><br><span class="line">        System.out.println(a.andThen(b).apply(<span class="number">5L</span>));</span><br><span class="line">        System.out.println(Function.identity().compose(a).apply(<span class="number">5L</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MyFunction</span>&lt;T, U, V, R&gt; &#123;</span><br><span class="line">    R <span class="title function_">apply</span><span class="params">(T t, U u, V v)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="静态方法引用"><a href="#静态方法引用" class="headerlink" title="静态方法引用"></a>静态方法引用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 静态方法引用，语法：Class::static_method</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        <span class="type">PrintFunction</span> <span class="variable">pf_01</span> <span class="operator">=</span> () -&gt; IPhone.info();</span><br><span class="line">        pf_01.print();</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        <span class="type">PrintFunction</span> <span class="variable">pf_02</span> <span class="operator">=</span> IPhone::info;</span><br><span class="line">        pf_02.print();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        PrintFunction2&lt;Long, String&gt; pf_03 = (id, name) -&gt; IPhone.info(id, name);</span><br><span class="line">        pf_03.print(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>);</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        PrintFunction2&lt;Long, String&gt; pf_04 = IPhone::info;</span><br><span class="line">        pf_04.print(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        PrintFunction3&lt;Long, String, IPhone&gt; pf_05 = (id, name) -&gt; IPhone.create(id, name);</span><br><span class="line">        pf_05.print(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>);</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        PrintFunction3&lt;Long, String, IPhone&gt; pf_06 = IPhone::create;</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone</span> <span class="operator">=</span> pf_06.print(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定义函数式接口，不带参数不带返回值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PrintFunction</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定义函数式接口，带参数不带返回值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PrintFunction2</span>&lt;T, U&gt; &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">print</span><span class="params">(T t, U u)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定义函数式接口，带参数带返回值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PrintFunction3</span>&lt;T, U, R&gt; &#123;</span><br><span class="line">    R <span class="title function_">print</span><span class="params">(T t, U u)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="特定对象的方法引用"><a href="#特定对象的方法引用" class="headerlink" title="特定对象的方法引用"></a>特定对象的方法引用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 特定对象的方法引用，语法：instance::method</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test3</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// Lambda表达式</span></span><br><span class="line">        BiFunction&lt;Long, String, IPhone&gt; factory_01 = (id, name) -&gt; <span class="keyword">new</span> <span class="title class_">IPhone</span>(id, name);</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_01</span> <span class="operator">=</span> factory_01.apply(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>);</span><br><span class="line">        <span class="type">PrintFunction</span> <span class="variable">pf_01</span> <span class="operator">=</span> () -&gt; iPhone_01.repair();</span><br><span class="line">        pf_01.print();</span><br><span class="line">        <span class="comment">// 等效方法引用</span></span><br><span class="line">        BiFunction&lt;Long, String, IPhone&gt; factory_02 = IPhone::<span class="keyword">new</span>;</span><br><span class="line">        <span class="type">IPhone</span> <span class="variable">iPhone_02</span> <span class="operator">=</span> factory_02.apply(<span class="number">2020L</span>, <span class="string">&quot;IPhone 12&quot;</span>);</span><br><span class="line">        <span class="type">PrintFunction</span> <span class="variable">pf_02</span> <span class="operator">=</span> iPhone_02::repair;</span><br><span class="line">        pf_02.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="类型注解和重复注解"><a href="#类型注解和重复注解" class="headerlink" title="类型注解和重复注解"></a>类型注解和重复注解</h1><p> <a target="_blank" rel="noopener" href="https://openjdk.java.net/jeps/104">类型注解</a> </p>
<p> <a target="_blank" rel="noopener" href="https://openjdk.java.net/jeps/120">重复注解</a> </p>
<p> <a href="/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7-%E9%87%8D%E5%A4%8D%E6%B3%A8%E8%A7%A3%E4%B8%8E%E7%B1%BB%E5%9E%8B%E6%B3%A8%E8%A7%A3/">Java8新特性-重复注解与类型注解</a> </p>
<h1 id="日期和时间-API"><a href="#日期和时间-API" class="headerlink" title="日期和时间 API"></a>日期和时间 API</h1><p> <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-datetime-api.html">Java 8 日期时间 API - 菜鸟</a> </p>
<p> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/binghe001/p/13028868.html">【Java8新特性】关于Java8中的日期时间API，你需要掌握这些！！</a> </p>
<p>在旧版的 Java 中，日期时间 API 存在诸多问题，其中有：</p>
<ul>
<li><strong>非线程安全</strong> − java.util.Date 是非线程安全的，所有的日期类都是可变的，这是Java日期类最大的问题之一。</li>
<li><strong>设计很差</strong> − Java的日期&#x2F;时间类的定义并不一致，在java.util和java.sql的包中都有日期类，此外用于格式化和解析的类在java.text包中定义。java.util.Date同时包含日期和时间，而java.sql.Date仅包含日期，将其纳入java.sql包并不合理。另外这两个类都有相同的名字，这本身就是一个非常糟糕的设计。</li>
<li><strong>时区处理麻烦</strong> − 日期类并不提供国际化，没有时区支持，因此Java引入了java.util.Calendar和java.util.TimeZone类，但他们同样存在上述所有的问题。</li>
</ul>
<p>Java 8 在 <strong>java.time</strong> 包下提供了很多新的 API。以下为两个比较重要的 API：</p>
<ul>
<li><strong>Local(本地)</strong> − 简化了日期时间的处理，不存在时区问题。</li>
<li><strong>Zoned(时区)</strong> − 通过制定的时区处理日期时间。</li>
</ul>
<p>新的 java.time 包涵盖了所有处理日期，时间，日期&#x2F;时间，时区，时刻（instants），过程（during）与时钟（clock）的操作。</p>
<h2 id="主要方法："><a href="#主要方法：" class="headerlink" title="主要方法："></a>主要方法：</h2><ul>
<li>now：静态方法，根据当前时间创建对象</li>
<li>of：静态方法，根据指定日期&#x2F;时间创建对象</li>
<li>plusDays,plusWeeks,plusMonths,plusYears：向当前LocalDate 对象添加几天、几周、几个月、几年</li>
<li>minusDays,minusWeeks,minusMonths,minusYears：从当前LocalDate 对象减去几天、几周、几个月、几年</li>
<li>plus,minus：添加或减少一个Duration 或Period</li>
<li>withDayOfMonth,withDayOfYear,withMonth,withYear：将月份天数、年份天数、月份、年份修改为指定的值并返回新的LocalDate 对象</li>
<li>getDayOfYear：获得年份天数(1~366)</li>
<li>getDayOfWeek：获得星期几(返回一个DayOfWeek枚举值)</li>
<li>getMonth：获得月份, 返回一个Month 枚举值</li>
<li>getMonthValue：获得月份(1~12)</li>
<li>getYear：获得年份</li>
<li>until：获得两个日期之间的Period 对象，或者指定ChronoUnits 的数字</li>
<li>isBefore,isAfter：比较两个LocalDate</li>
<li>isLeapYear：判断是否是闰年</li>
</ul>
<h2 id="使用-LocalDate、-LocalTime、-LocalDateTime"><a href="#使用-LocalDate、-LocalTime、-LocalDateTime" class="headerlink" title="使用 LocalDate、 LocalTime、 LocalDateTime"></a>使用 LocalDate、 LocalTime、 LocalDateTime</h2><p>LocalDate、 LocalTime、 LocalDateTime 类的实例是不可变的对象，分别表示使用 ISO-8601日历系统的日期、时间、日期和时间。它们提供了简单的日期或时间，并不包含当前的时间信息。也不包含与时区相关的信息。</p>
<blockquote>
<p>注： ISO-8601日历系统是国际标准化组织制定的现代公民的日期和时间的表示法</p>
</blockquote>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>now()</td>
<td>静态方法，根据当前时间创建对象</td>
<td>LocalDate d &#x3D; LocalDate.now(); <br>LocalTime t &#x3D; LocalTime.now();<br>LocalDateTime dt &#x3D; LocalDateTime.now();<br>LocalDateTime dt &#x3D; LocalDateTime.now(Clock.systemDefaultZone());<br>LocalDateTime dt &#x3D; LocalDateTime.now(ZoneId.systemDefault());</td>
</tr>
<tr>
<td>of()</td>
<td>静态方法，根据指定日期&#x2F;时间创建 对象</td>
<td>LocalDate d &#x3D; LocalDate.of(2020, Month.DECEMBER, 12);<br>LocalDate d &#x3D; LocalDate.of(2020, 12, 12);<br>LocalTime t &#x3D; LocalTime.of(23, 59, 59, 999999999);<br>LocalDateTime dt &#x3D; LocalDateTime.of(2020, Month.DECEMBER, 12, 23, 59, 59, 999999999);<br>LocalDateTime dt &#x3D; LocalDateTime.of(2020, 12, 12, 23, 59, 59, 999999999);</td>
</tr>
<tr>
<td>plusDays, plusWeeks, plusMonths, plusYears</td>
<td>向当前 LocalDate 对象添加几天、 几周、 几个月、 几年</td>
<td></td>
</tr>
<tr>
<td>minusDays, minusWeeks, minusMonths, minusYears</td>
<td>从当前 LocalDate 对象减去几天、 几周、 几个月、 几年</td>
<td></td>
</tr>
<tr>
<td>plus, minus</td>
<td>添加或减少一个 Duration 或 Period</td>
<td>LocalDateTime LocalDateTime &#x3D; LocalDateTime.now().plus(Duration.ofDays(-1));<br>LocalDateTime LocalDateTime &#x3D; LocalDateTime.now().plus(Period.ofDays(-1));<br>Duration.ofDays(-1).addTo(LocalDateTime.now());</td>
</tr>
<tr>
<td>withDayOfMonth, withDayOfYear, withMonth, withYear</td>
<td>将月份天数、 年份天数、 月份、 年 份 修 改 为 指 定 的 值 并 返 回 新 的 LocalDate 对象</td>
<td>LocalDateTime.now().withYear(2010).withMonth(9).withDayOfMonth(1);</td>
</tr>
<tr>
<td>getDayOfMonth</td>
<td>获得月份天数(1-31)</td>
<td>LocalDateTime.now().getDayOfMonth();</td>
</tr>
<tr>
<td>getDayOfYear</td>
<td>获得年份天数(1-366)</td>
<td></td>
</tr>
<tr>
<td>getDayOfWeek</td>
<td>获得星期几(返回一个 DayOfWeek 枚举值)</td>
<td></td>
</tr>
<tr>
<td>getMonth</td>
<td>获得月份, 返回一个 Month 枚举值</td>
<td>LocalDateTime.now().getMonth().get(ChronoField.MONTH_OF_YEAR);</td>
</tr>
<tr>
<td>getMonthValue</td>
<td>获得月份(1-12)</td>
<td>LocalDateTime.now().getMonthValue();</td>
</tr>
<tr>
<td>getYear</td>
<td>获得年份</td>
<td>LocalDateTime.now().getYear();</td>
</tr>
<tr>
<td>until</td>
<td>获得两个日期之间的 Period 对象， 或者指定 ChronoUnits 的数字</td>
<td></td>
</tr>
<tr>
<td>isBefore, isAfter</td>
<td>比较两个 LocalDate</td>
<td></td>
</tr>
<tr>
<td>isLeapYear</td>
<td>判断是否是闰年</td>
<td>LocalDateTime.now().toLocalDate().isLeapYear();</td>
</tr>
</tbody></table>
<p>示例代码如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前系统时间</span></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime1</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">System.out.println(localDateTime1);</span><br><span class="line"><span class="comment">// 运行结果：2019-10-27T13:49:09.483</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定日期时间</span></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime2</span> <span class="operator">=</span> LocalDateTime.of(<span class="number">2019</span>, <span class="number">10</span>, <span class="number">27</span>, <span class="number">13</span>, <span class="number">45</span>,<span class="number">10</span>);</span><br><span class="line">System.out.println(localDateTime2);</span><br><span class="line"><span class="comment">// 运行结果：2019-10-27T13:45:10</span></span><br><span class="line"></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime3</span> <span class="operator">=</span> localDateTime1</span><br><span class="line">        <span class="comment">// 加三年</span></span><br><span class="line">        .plusYears(<span class="number">3</span>)</span><br><span class="line">        <span class="comment">// 减三个月</span></span><br><span class="line">        .minusMonths(<span class="number">3</span>);</span><br><span class="line">System.out.println(localDateTime3);</span><br><span class="line"><span class="comment">// 运行结果：2022-07-27T13:49:09.483</span></span><br><span class="line"></span><br><span class="line">System.out.println(localDateTime1.getYear());       <span class="comment">// 运行结果：2019</span></span><br><span class="line">System.out.println(localDateTime1.getMonthValue()); <span class="comment">// 运行结果：10</span></span><br><span class="line">System.out.println(localDateTime1.getDayOfMonth()); <span class="comment">// 运行结果：27</span></span><br><span class="line">System.out.println(localDateTime1.getHour());       <span class="comment">// 运行结果：13</span></span><br><span class="line">System.out.println(localDateTime1.getMinute());     <span class="comment">// 运行结果：52</span></span><br><span class="line">System.out.println(localDateTime1.getSecond());     <span class="comment">// 运行结果：6</span></span><br><span class="line"></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime4</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">System.out.println(localDateTime4);     <span class="comment">// 2019-10-27T14:19:56.884</span></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime5</span> <span class="operator">=</span> localDateTime4.withDayOfMonth(<span class="number">10</span>);</span><br><span class="line">System.out.println(localDateTime5);     <span class="comment">// 2019-10-10T14:19:56.884</span></span><br></pre></td></tr></table></figure>

<h2 id="Instant-时间戳"><a href="#Instant-时间戳" class="headerlink" title="Instant 时间戳"></a>Instant 时间戳</h2><p>用于“时间戳”的运算。它是以Unix元年(传统的设定为UTC时区1970年1月1日午夜时分)开始所经历的描述进行运算 。</p>
<p>示例代码如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Instant</span> <span class="variable">instant1</span> <span class="operator">=</span> Instant.now();    <span class="comment">// 默认获取UTC时区</span></span><br><span class="line">System.out.println(instant1);</span><br><span class="line"><span class="comment">// 运行结果：2019-10-27T05:59:58.221Z</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 偏移量运算</span></span><br><span class="line"><span class="type">OffsetDateTime</span> <span class="variable">offsetDateTime</span> <span class="operator">=</span> instant1.atOffset(ZoneOffset.ofHours(<span class="number">8</span>));</span><br><span class="line">System.out.println(offsetDateTime);</span><br><span class="line"><span class="comment">// 运行结果：2019-10-27T13:59:58.221+08:00</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取时间戳</span></span><br><span class="line">System.out.println(instant1.toEpochMilli());</span><br><span class="line"><span class="comment">// 运行结果：1572156145000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 以Unix元年为起点，进行偏移量运算</span></span><br><span class="line"><span class="type">Instant</span> <span class="variable">instant2</span> <span class="operator">=</span> Instant.ofEpochSecond(<span class="number">60</span>);</span><br><span class="line">System.out.println(instant2);</span><br><span class="line"><span class="comment">// 运行结果：1970-01-01T00:01:00Z</span></span><br></pre></td></tr></table></figure>

<h2 id="Duration-和-Period"><a href="#Duration-和-Period" class="headerlink" title="Duration 和 Period"></a>Duration 和 Period</h2><p>详细介绍请看 Java 注释。</p>
<p>下面是 between 方法示例：</p>
<p>Duration.between：用于计算两个“时间”间隔。请看 Java 注释</p>
<p>Period.between：用于计算两个“日期”间隔 。请看 Java 注释</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Instant</span> <span class="variable">instant_1</span> <span class="operator">=</span> Instant.now();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">Instant</span> <span class="variable">instant_2</span> <span class="operator">=</span> Instant.now();</span><br><span class="line"></span><br><span class="line"><span class="type">Duration</span> <span class="variable">duration</span> <span class="operator">=</span> Duration.between(instant_1, instant_2);</span><br><span class="line">System.out.println(duration.toMillis());</span><br><span class="line"><span class="comment">// 运行结果：1000</span></span><br><span class="line"></span><br><span class="line"><span class="type">LocalTime</span> <span class="variable">localTime_1</span> <span class="operator">=</span> LocalTime.now();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">LocalTime</span> <span class="variable">localTime_2</span> <span class="operator">=</span> LocalTime.now();</span><br><span class="line"></span><br><span class="line">System.out.println(Duration.between(localTime_1, localTime_2).toMillis());</span><br><span class="line"><span class="comment">// 运行结果：1000</span></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">localDate_1</span> <span class="operator">=</span> LocalDate.of(<span class="number">2018</span>,<span class="number">9</span>, <span class="number">9</span>);</span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">localDate_2</span> <span class="operator">=</span> LocalDate.now();</span><br><span class="line"></span><br><span class="line"><span class="type">Period</span> <span class="variable">period</span> <span class="operator">=</span> Period.between(localDate_1, localDate_2);</span><br><span class="line">System.out.println(period.getYears());      <span class="comment">// 运行结果：1</span></span><br><span class="line">System.out.println(period.getMonths());     <span class="comment">// 运行结果：1</span></span><br><span class="line">System.out.println(period.getDays());       <span class="comment">// 运行结果：18</span></span><br></pre></td></tr></table></figure>

<h2 id="日期的操纵"><a href="#日期的操纵" class="headerlink" title="日期的操纵"></a>日期的操纵</h2><p>TemporalAdjuster : 时间校正器。有时我们可能需要获取例如：将日期调整到“下个周日”等操作。</p>
<p>TemporalAdjusters : 该类通过静态方法提供了大量的常用 TemporalAdjuster 的实现。</p>
<p>例如获取下个周日，如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalDate</span> <span class="variable">nextSunday</span> <span class="operator">=</span> LocalDate.now().with(TemporalAdjusters.next(DayOfWeek.SUNDAY));</span><br></pre></td></tr></table></figure>

<p>完整的示例代码如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalDateTime</span> <span class="variable">ldt</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line"></span><br><span class="line">System.out.println(ldt.withYear(<span class="number">2010</span>).withMonth(<span class="number">9</span>).withDayOfMonth(<span class="number">1</span>));</span><br><span class="line"><span class="comment">// 2010-09-01T16:40:13.207</span></span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + ldt.with(ChronoField.DAY_OF_YEAR, <span class="number">2</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + localDateTime.with(ChronoField.valueOf(<span class="string">&quot;DAY_OF_YEAR&quot;</span>), <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + ldt.with(ChronoField.MONTH_OF_YEAR, <span class="number">1</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + localDateTime.with(ChronoField.valueOf(<span class="string">&quot;MONTH_OF_YEAR&quot;</span>), <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + ldt.with(DayOfWeek.MONDAY));</span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + ldt.with(DayOfWeek.of(<span class="number">1</span>)));</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + ldt.with(Month.JANUARY));</span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + ldt.with(Month.of(<span class="number">1</span>)));</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + ldt.with(Year.parse(<span class="string">&quot;2012&quot;</span>)));</span><br><span class="line">System.out.println(<span class="string">&quot;LocalDateTime: &quot;</span> + ldt.with(Year.of(<span class="number">2012</span>)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime1</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">System.out.println(localDateTime1);     <span class="comment">// 2019-10-27T14:19:56.884</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取这个月第一天的日期</span></span><br><span class="line">System.out.println(localDateTime1.with(TemporalAdjusters.firstDayOfMonth()));            <span class="comment">// 2019-10-01T14:22:58.574</span></span><br><span class="line"><span class="comment">// 获取下个星期日的日期</span></span><br><span class="line">System.out.println(localDateTime1.with(TemporalAdjusters.next(DayOfWeek.SUNDAY)));       <span class="comment">// 2019-11-03T14:22:58.574</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义：下一个工作日</span></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime2</span> <span class="operator">=</span> localDateTime1.with(l -&gt; &#123;</span><br><span class="line">    <span class="type">LocalDateTime</span> <span class="variable">localDateTime</span> <span class="operator">=</span> (LocalDateTime) l;</span><br><span class="line">    <span class="type">DayOfWeek</span> <span class="variable">dayOfWeek</span> <span class="operator">=</span>  localDateTime.getDayOfWeek();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (dayOfWeek.equals(DayOfWeek.FRIDAY)) &#123;</span><br><span class="line">       <span class="keyword">return</span> localDateTime.plusDays(<span class="number">3</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dayOfWeek.equals(DayOfWeek.SATURDAY)) &#123;</span><br><span class="line">       <span class="keyword">return</span> localDateTime.plusDays(<span class="number">2</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> localDateTime.plusDays(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">System.out.println(localDateTime2);</span><br><span class="line"><span class="comment">// 运行结果：2019-10-28T14:30:17.400</span></span><br></pre></td></tr></table></figure>

<h2 id="解析与格式化"><a href="#解析与格式化" class="headerlink" title="解析与格式化"></a>解析与格式化</h2><p>java.time.format.DateTimeFormatter 类：该类提供了三种格式化方法：</p>
<ul>
<li>预定义的标准格式</li>
<li>语言环境相关的格式</li>
<li>自定义的格式</li>
</ul>
<p>示例代码如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line"><span class="type">DateTimeFormatter</span> <span class="variable">dateTimeFormatter</span> <span class="operator">=</span> DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, Locale.getDefault());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Date -&gt; String</span></span><br><span class="line"><span class="type">String</span> <span class="variable">dateTimeToStr_1</span> <span class="operator">=</span> localDateTime.format(DateTimeFormatter.ISO_DATE); <span class="comment">// 2020-09-08</span></span><br><span class="line"><span class="type">String</span> <span class="variable">dateTimeToStr_2</span> <span class="operator">=</span> localDateTime.format(dateTimeFormatter); <span class="comment">// 2020-09-08 17:15:27</span></span><br><span class="line"><span class="type">String</span> <span class="variable">dateTimeToStr_3</span> <span class="operator">=</span> dateTimeFormatter.format(localDateTime); <span class="comment">// 2020-09-08 17:15:27</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// String -&gt; Date</span></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">strToDateTime_0</span> <span class="operator">=</span> LocalDateTime.parse(<span class="string">&quot;2008-08-08T08:00:00.999999999&quot;</span>);</span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">strToDateTime_1</span> <span class="operator">=</span> LocalDateTime.parse(dateTimeToStr_1, dateTimeFormatter); <span class="comment">// 2020-09-08T17:16:32</span></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">strToDateTime_2</span> <span class="operator">=</span> LocalDateTime.parse(<span class="string">&quot;2008-08-08 08:00:00&quot;</span>, dateTimeFormatter); <span class="comment">// 2008-08-08T08:00</span></span><br><span class="line"></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">date_0</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;2012-09-08&quot;</span>); <span class="comment">// 2012-09-08</span></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">date_1</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;2012-09-08T13:00:20.776&quot;</span>, DateTimeFormatter.ISO_LOCAL_DATE_TIME); <span class="comment">// 2012-09-08</span></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">date_2</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;2012-09-08&quot;</span>, DateTimeFormatter.ISO_LOCAL_DATE); <span class="comment">// 2012-09-08</span></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">date_3</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;2012-09-08&quot;</span>, DateTimeFormatter.ISO_DATE); <span class="comment">// 2012-09-08</span></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">date_4</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;2012-252&quot;</span>, DateTimeFormatter.ISO_ORDINAL_DATE); <span class="comment">// 2012-09-08</span></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">date_5</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;2012-W36-6&quot;</span>, DateTimeFormatter.ISO_WEEK_DATE); <span class="comment">// 2012-09-08</span></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">date_6</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;20120908&quot;</span>, DateTimeFormatter.BASIC_ISO_DATE); <span class="comment">// 2012-09-08</span></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">date_7</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;2012-09-08+08:00&quot;</span>, DateTimeFormatter.ISO_OFFSET_DATE); <span class="comment">// 2012-09-08</span></span><br><span class="line"></span><br><span class="line"><span class="type">LocalTime</span> <span class="variable">time_0</span> <span class="operator">=</span> LocalTime.parse(<span class="string">&quot;08:00:00.999999999&quot;</span>); <span class="comment">// 08:00:00.999999999</span></span><br><span class="line"><span class="type">LocalTime</span> <span class="variable">time_1</span> <span class="operator">=</span> LocalTime.parse(<span class="string">&quot;2008-08-08 08:00:00&quot;</span>, dateTimeFormatter); <span class="comment">// 08:00</span></span><br></pre></td></tr></table></figure>

<h2 id="时区的处理"><a href="#时区的处理" class="headerlink" title="时区的处理"></a>时区的处理</h2><p>Java8 中加入了对时区的支持，带时区的时间为：ZonedDateTime。</p>
<p>其中每个时区都对应着 ID，地区ID都为 “{区域}&#x2F;{城市}”的格式，例如 ： Asia&#x2F;Shanghai 等。</p>
<ul>
<li>ZoneId：该类中包含了所有的时区信息</li>
<li>getAvailableZoneIds() : 可以获取所有时区时区信息</li>
<li>of(id) : 用指定的时区信息获取 ZoneId 对象</li>
</ul>
<p>示例代码如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取所有的时区</span></span><br><span class="line">Set&lt;String&gt; set = ZoneId.getAvailableZoneIds();</span><br><span class="line">System.out.println(set);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过时区构建LocalDateTime</span></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">ldt1</span> <span class="operator">=</span> LocalDateTime.now(Clock.systemDefaultZone());</span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">ldt2</span> <span class="operator">=</span> LocalDateTime.now(ZoneId.systemDefault());</span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">ldt3</span> <span class="operator">=</span> LocalDateTime.now(ZoneId.of(<span class="string">&quot;Australia/Sydney&quot;</span>));</span><br><span class="line">System.out.println(ldt3); <span class="comment">// 2020-09-08T19:38:16.068</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 以时区格式显示时间</span></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">ldt5</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line"><span class="type">ZonedDateTime</span> <span class="variable">zdt1</span> <span class="operator">=</span> ldt5.atZone(ZoneId.of(<span class="string">&quot;Africa/Nairobi&quot;</span>));</span><br><span class="line">System.out.println(zdt1); <span class="comment">// 2020-09-08T17:39:09.538+03:00[Africa/Nairobi]</span></span><br></pre></td></tr></table></figure>

<h2 id="与传统日期处理的转换"><a href="#与传统日期处理的转换" class="headerlink" title="与传统日期处理的转换"></a>与传统日期处理的转换</h2><p><img src="/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/1.jpg" alt="img"></p>
<h1 id="Optional-类"><a href="#Optional-类" class="headerlink" title="Optional 类"></a>Optional 类</h1><h2 id="什么是Optional类"><a href="#什么是Optional类" class="headerlink" title="什么是Optional类"></a>什么是Optional类</h2><p>Optional 类是一个可以为null的容器对象。如果值存在则isPresent()方法会返回true，调用get()方法会返回该对象。</p>
<p>Optional 是个容器：它可以保存类型T的值，或者仅仅保存null。Optional提供很多有用的方法，这样我们就不用显式进行空值检测。</p>
<p>Optional 类的引入很好的解决空指针异常。</p>
<h3 id="Optional类常用方法："><a href="#Optional类常用方法：" class="headerlink" title="Optional类常用方法："></a><strong>Optional类常用方法：</strong></h3><ul>
<li><p>public static &lt;T&gt; Optional &lt;T&gt; <strong>empty</strong>() : 返回空的 Optional 实例。</p>
</li>
<li><p>public boolean <strong>isPresent</strong>() : 如果存在值，则返回 true，否则返回 false。</p>
</li>
<li><p>public void <strong>ifPresent</strong>(Consumer&lt;? super T&gt; consumer) : 如果值存在则使用该值调用 consumer , 否则不做任何事情。</p>
</li>
<li><p>public T <strong>get</strong>() : 如果此 Optional 中存在值，则返回该值，否则抛出 NoSuchElementException。</p>
</li>
<li><p>public T <strong>orElse</strong>(T other) : 返回值 (如果存在)，否则返回 other。</p>
</li>
<li><p>public T <strong>orElseGet</strong>(Supplier&lt;? extends T&gt; other) : 返回值 (如果存在)，否则调用 other 并返回该调用的结果。</p>
</li>
<li><p>public &lt;X extends Throwable&gt; T <strong>orElseThrow</strong>(Supplier&lt;? extends X&gt; exceptionSupplier) throws X : 返回值 (如果存在)，否则 supplier 抛出异常。</p>
</li>
<li><p>public static &lt;T&gt; Optional &lt;T&gt; <strong>of</strong>(T value) : 返回一个指定非null值的 Optional。</p>
</li>
<li><p>public static &lt;T&gt; Optional &lt;T&gt; <strong>ofNullable</strong>(T value) : 如果为非空，返回 Optional 描述的指定值，否则返回空的 Optional。</p>
</li>
<li><p>public &lt;U&gt; Optional&lt;U&gt; <strong>map</strong>(Function&lt;? super T, ? extends U&gt; mapper) : 如果此 Optional 有值，则对其执行调用映射函数得到返回值，如果映射器 (mapper) 返回值不为 null，则创建包含映射器 (mapper) 返回值的<font color="red">新Optional</font>作为map方法返回值，否则返回空Optional。如果此 Optional 无值，返回空Optional。</p>
</li>
<li><p>public &lt;U&gt; Optional&lt;U&gt; <strong>flatMap</strong>(Function&lt;? super T, Optional&lt;U&gt;&gt; mapper) : 与 map 类似，但要求 mapper 返回值必须是 Optional。如果值存在，返回基于映射器 (mapper) 的返回值，否则返回一个空的Optional。</p>
</li>
<li><p>public Optional&lt;T&gt; <strong>filter</strong>(Predicate&lt;? super T&gt; predicate) : 如果值存在，并且该值与给定 predicate 匹配，则返回描述该值的 Optional (当前 Optional 对象，即 this)，否则返回空的 Optional。</p>
</li>
</ul>
<h3 id="重写-Object-的方法："><a href="#重写-Object-的方法：" class="headerlink" title="重写 Object 的方法："></a><strong>重写 Object 的方法：</strong></h3><ul>
<li>public boolean <strong>equals</strong>(Object obj) : </li>
<li>public int <strong>hashCode</strong>() : </li>
<li>public String <strong>toString</strong>() :</li>
</ul>
<h2 id="Optional类示例"><a href="#Optional类示例" class="headerlink" title="Optional类示例"></a>Optional类示例</h2><h3 id="创建Optional类"><a href="#创建Optional类" class="headerlink" title="创建Optional类"></a>创建Optional类</h3><p>（1）使用empty()方法创建一个空的Optional对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; empty = Optional.empty();</span><br></pre></td></tr></table></figure>

<p>（2）使用of()方法创建Optional对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;binghe&quot;</span>;</span><br><span class="line">Optional&lt;String&gt; opt = Optional.of(name);</span><br><span class="line">assertEquals(<span class="string">&quot;Optional[binghe]&quot;</span>, opt.toString());</span><br></pre></td></tr></table></figure>

<p>传递给of()的值不可以为空，否则会抛出空指针异常。例如，下面的程序会抛出空指针异常。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">Optional&lt;String&gt; opt = Optional.of(name);</span><br></pre></td></tr></table></figure>

<p>如果我们需要传递一些空值，那我们可以使用下面的示例所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">Optional&lt;String&gt; opt = Optional.ofNullable(name);</span><br></pre></td></tr></table></figure>

<p>使用ofNullable()方法，则当传递进去一个空值时，不会抛出异常，而只是返回一个空的Optional对象，如同我们用Optional.empty()方法一样。</p>
<h3 id="isPresent"><a href="#isPresent" class="headerlink" title="isPresent"></a>isPresent</h3><p>我们可以使用这个isPresent()方法检查一个Optional对象中是否有值，只有值非空才返回true。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; opt = Optional.of(<span class="string">&quot;binghe&quot;</span>);</span><br><span class="line">assertTrue(opt.isPresent());</span><br><span class="line"></span><br><span class="line">opt = Optional.ofNullable(<span class="literal">null</span>);</span><br><span class="line">assertFalse(opt.isPresent());</span><br></pre></td></tr></table></figure>

<p>在Java8之前，我们一般使用如下方式来检查空值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(name != <span class="literal">null</span>)&#123;</span><br><span class="line">    System.out.println(name.length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在Java8中，我们就可以使用如下方式来检查空值了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; opt = Optional.of(<span class="string">&quot;binghe&quot;</span>);</span><br><span class="line">opt.ifPresent(name -&gt; System.out.println(name.length()));</span><br></pre></td></tr></table></figure>

<h3 id="get"><a href="#get" class="headerlink" title="get"></a>get</h3><p>get()方法表示从Optional对象中获取值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; opt = Optional.of(<span class="string">&quot;binghe&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> opt.get();</span><br><span class="line">assertEquals(<span class="string">&quot;binghe&quot;</span>, name);</span><br></pre></td></tr></table></figure>

<p>使用get()方法也可以返回被包裹着的值。但是值必须存在。当值不存在时，会抛出一个NoSuchElementException异常。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; opt = Optional.ofNullable(<span class="literal">null</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> opt.get();</span><br></pre></td></tr></table></figure>

<h3 id="orElse和orElseGet"><a href="#orElse和orElseGet" class="headerlink" title="orElse和orElseGet"></a>orElse和orElseGet</h3><p>（1）orElse</p>
<p>orElse()方法用来返回Optional对象中的默认值，它被传入一个“默认参数‘。如果Optional对象中有值，则返回它，否则返回传入的“默认参数”。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">nullName</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> Optional.ofNullable(nullName).orElse(<span class="string">&quot;binghe&quot;</span>);</span><br><span class="line">assertEquals(<span class="string">&quot;binghe&quot;</span>, name);</span><br></pre></td></tr></table></figure>

<p>（2）orElseGet：<font color="red">推荐使用</font> </p>
<p>与orElse()方法类似，但是这个函数不接收一个“默认参数”，而是一个函数接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">nullName</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> Optional.ofNullable(nullName).orElseGet(() -&gt; <span class="string">&quot;binghe&quot;</span>);</span><br><span class="line">assertEquals(<span class="string">&quot;binghe&quot;</span>, name);</span><br></pre></td></tr></table></figure>

<p>（3）二者有什么区别？</p>
<p>要想理解二者的区别，首先让我们创建一个无参且返回定值的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">getDefaultName</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Getting Default Name&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;binghe&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，进行两个测试看看两个方法到底有什么区别。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String text;</span><br><span class="line">System.out.println(<span class="string">&quot;Using orElseGet:&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">defaultText</span> <span class="operator">=</span> Optional.ofNullable(text).orElseGet(<span class="built_in">this</span>::getDefaultName);</span><br><span class="line">assertEquals(<span class="string">&quot;binghe&quot;</span>, defaultText);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Using orElse:&quot;</span>);</span><br><span class="line">defaultText = Optional.ofNullable(text).orElse(getDefaultName());</span><br><span class="line">assertEquals(<span class="string">&quot;binghe&quot;</span>, defaultText);</span><br></pre></td></tr></table></figure>

<p>在这里示例中，我们的Optional对象中包含的都是一个空值，让我们看看程序执行结果:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Using orElseGet:</span><br><span class="line">Getting <span class="keyword">default</span> name...</span><br><span class="line">Using orElse:</span><br><span class="line">Getting <span class="keyword">default</span> name...</span><br></pre></td></tr></table></figure>

<p>两个Optional对象中都不存在value，因此执行结果相同。</p>
<p>那么，当Optional对象中存在数据会发生什么呢？我们一起来验证下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;binghe001&quot;</span>;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Using orElseGet:&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">defaultName</span> <span class="operator">=</span> Optional.ofNullable(name).orElseGet(<span class="built_in">this</span>::getDefaultName);</span><br><span class="line">assertEquals(<span class="string">&quot;binghe001&quot;</span>, defaultName);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Using orElse:&quot;</span>);</span><br><span class="line">defaultName = Optional.ofNullable(name).orElse(getDefaultName());</span><br><span class="line">assertEquals(<span class="string">&quot;binghe001&quot;</span>, defaultName);</span><br></pre></td></tr></table></figure>

<p>运行结果如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Using orElseGet:</span><br><span class="line">Using orElse:</span><br><span class="line">Getting <span class="keyword">default</span> name...</span><br></pre></td></tr></table></figure>

<p>可以看到，当使用orElseGet()方法时，getDefaultName()方法并不执行，因为Optional中含有值，而使用orElse时则照常执行。所以可以看到，当值存在时，orElse相比于orElseGet，多创建了一个对象。如果创建对象时，存在网络交互，那系统资源的开销就比较大了，这是需要我们注意的一个地方。</p>
<h3 id="orElseThrow"><a href="#orElseThrow" class="headerlink" title="orElseThrow"></a>orElseThrow</h3><p>orElseThrow()方法当遇到一个不存在的值的时候，并不返回一个默认值，而是抛出异常。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">nullName</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> Optional.ofNullable(nullName).orElseThrow(IllegalArgumentException::<span class="keyword">new</span>);</span><br></pre></td></tr></table></figure>

<h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3><p>如果有值对其处理，并返回处理后的Optional，否则返回 Optional.empty()。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; names = Arrays.asList(<span class="string">&quot;binghe001&quot;</span>, <span class="string">&quot;binghe002&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;binghe003&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;binghe004&quot;</span>);</span><br><span class="line">Optional&lt;List&lt;String&gt;&gt; listOptional = Optional.of(names);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> listOptional</span><br><span class="line">    .map(List::size)</span><br><span class="line">    .orElse(<span class="number">0</span>);</span><br><span class="line">assertEquals(<span class="number">6</span>, size);</span><br></pre></td></tr></table></figure>

<p>在这个例子中，我们使用一个List集合封装了一些字符串，然后再把这个List使用Optional封装起来，对其map()，获取List集合的长度。map()返回的结果也被封装在一个Optional对象中，这里当值不存在的时候，我们会默认返回0。如下我们获取一个字符串的长度。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;binghe&quot;</span>;</span><br><span class="line">Optional&lt;String&gt; nameOptional = Optional.of(name);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> nameOptional</span><br><span class="line">    .map(String::length)</span><br><span class="line">    .orElse(<span class="number">0</span>);</span><br><span class="line">assertEquals(<span class="number">6</span>, len);</span><br></pre></td></tr></table></figure>

<p>我们也可以将map()方法与filter()方法结合使用，如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot; password &quot;</span>;</span><br><span class="line">Optional&lt;String&gt; passOpt = Optional.of(password);</span><br><span class="line"><span class="type">boolean</span> <span class="variable">correctPassword</span> <span class="operator">=</span> passOpt.filter(</span><br><span class="line">    pass -&gt; <span class="string">&quot;password&quot;</span>.equals(pass)).isPresent();</span><br><span class="line">assertFalse(correctPassword);</span><br><span class="line"></span><br><span class="line">correctPassword = passOpt</span><br><span class="line">    .map(String::trim)</span><br><span class="line">    .filter(pass -&gt; <span class="string">&quot;password&quot;</span>.equals(pass)</span><br><span class="line">    .isPresent();</span><br><span class="line">assertTrue(correctPassword);</span><br></pre></td></tr></table></figure>

<p>上述代码的含义就是对密码进行验证，查看密码是否为指定的值。</p>
<h3 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h3><p>与 map 类似，要求返回值必须是Optional。</p>
<p>假设我们现在有一个Person类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Optional&lt;String&gt; <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Optional.ofNullable(name);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> Optional&lt;Integer&gt; <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Optional.ofNullable(age);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> Optional&lt;String&gt; <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Optional.ofNullable(password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，我们可以将Person封装到Optional中，并进行测试，如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;binghe&quot;</span>, <span class="number">18</span>);</span><br><span class="line">Optional&lt;Person&gt; personOptional = Optional.of(person);</span><br><span class="line"></span><br><span class="line">Optional&lt;Optional&lt;String&gt;&gt; nameOptionalWrapper = personOptional.map(Person::getName);</span><br><span class="line">Optional&lt;String&gt; nameOptional = nameOptionalWrapper.orElseThrow(IllegalArgumentException::<span class="keyword">new</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">name1</span> <span class="operator">=</span> nameOptional.orElse(<span class="string">&quot;&quot;</span>);</span><br><span class="line">assertEquals(<span class="string">&quot;binghe&quot;</span>, name1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 前提：getName返回的是一个Optional对象</span></span><br><span class="line"><span class="comment">//   1、public&lt;U&gt; Optional&lt;U&gt; map(Function&lt;? super T, ? extends U&gt; mapper)</span></span><br><span class="line"><span class="comment">//          由源码知，map返回一个包含Function返回值的Optional</span></span><br><span class="line"><span class="comment">//   2、public&lt;U&gt; Optional&lt;U&gt; flatMap(Function&lt;? super T, Optional&lt;U&gt;&gt; mapper)</span></span><br><span class="line"><span class="comment">//          由源码知，flatMap返回Function返回的Optional</span></span><br><span class="line"><span class="type">String</span> <span class="variable">name2</span> <span class="operator">=</span> personOptional.flatMap(Person::getName).orElse(<span class="string">&quot;&quot;</span>);</span><br><span class="line">assertEquals(<span class="string">&quot;binghe&quot;</span>, name2);</span><br></pre></td></tr></table></figure>

<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p>接收一个函数式接口，当匹配接口时，则返回当前Optional对象，否则返回一个空的Optional对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;binghe&quot;</span>;</span><br><span class="line">Optional&lt;String&gt; nameOptional = Optional.of(name);</span><br><span class="line"><span class="type">boolean</span> <span class="variable">isBinghe</span> <span class="operator">=</span> nameOptional.filter(n -&gt; <span class="string">&quot;binghe&quot;</span>.equals(name)).isPresent();</span><br><span class="line">assertTrue(isBinghe);</span><br><span class="line"><span class="type">boolean</span> <span class="variable">isBinghe001</span> <span class="operator">=</span> nameOptional.filter(n -&gt; <span class="string">&quot;binghe001&quot;</span>.equals(name)).isPresent();</span><br><span class="line">assertFalse(isBinghe001);</span><br></pre></td></tr></table></figure>

<p>使用filter()方法会过滤掉我们不需要的元素。</p>
<p>接下来，我们再来看一例示例，例如目前有一个Person类，如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(<span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//省略get set方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例如，我们需要过滤出年龄在25岁到35岁之前的人群，那在Java8之前我们需要创建一个如下的方法来检测每个人的年龄范围是否在25岁到35岁之前。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">filterPerson</span><span class="params">(Peron person)</span>&#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isInRange</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(person != <span class="literal">null</span> &amp;&amp; person.getAge() &gt;= <span class="number">25</span> &amp;&amp; person.getAge() &lt;= <span class="number">35</span>)&#123;</span><br><span class="line">        isInRange =  <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> isInRange;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看上去就挺麻烦的，我们可以使用如下的方式进行测试。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">assertTrue(filterPerson(<span class="keyword">new</span> <span class="title class_">Peron</span>(<span class="number">18</span>)));</span><br><span class="line">assertFalse(filterPerson(<span class="keyword">new</span> <span class="title class_">Peron</span>(<span class="number">29</span>)));</span><br><span class="line">assertFalse(filterPerson(<span class="keyword">new</span> <span class="title class_">Peron</span>(<span class="number">16</span>)));</span><br><span class="line">assertFalse(filterPerson(<span class="keyword">new</span> <span class="title class_">Peron</span>(<span class="number">34</span>)));</span><br><span class="line">assertFalse(filterPerson(<span class="literal">null</span>));</span><br></pre></td></tr></table></figure>

<p>如果使用Optional，效果如何呢？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">filterPersonByOptional</span><span class="params">(Peron person)</span>&#123;</span><br><span class="line">     <span class="keyword">return</span> Optional.ofNullable(person)</span><br><span class="line">       .map(Peron::getAge)</span><br><span class="line">       .filter(p -&gt; p &gt;= <span class="number">25</span>)</span><br><span class="line">       .filter(p -&gt; p &lt;= <span class="number">35</span>)</span><br><span class="line">       .isPresent();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用Optional看上去就清爽多了，这里，map()仅仅是将一个值转换为另一个值，并且这个操作并不会改变原来的值。</p>
<h1 id="Stream-API"><a href="#Stream-API" class="headerlink" title="Stream API"></a>Stream API</h1><p> <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-streams.html">Java 8 Stream - 菜鸟</a> </p>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>Java 8 API添加了一个新的抽象称为流Stream，可以让你<strong>以一种声明的方式处理数据</strong>。</p>
<p>Stream 使用一种类似用 SQL 语句从数据库查询数据的直观方式来提供<strong>一种对<font color="red"> Java 集合</font>运算和表达的高阶抽象</strong>。</p>
<p>Stream API可以极大提高Java程序员的生产力，让程序员写出高效率、干净、简洁的代码。</p>
<h2 id="什么是-Stream？"><a href="#什么是-Stream？" class="headerlink" title="什么是 Stream？"></a>什么是 Stream？</h2><p>Stream（流）是一个来自数据源的元素队列并支持聚合操作</p>
<ul>
<li>元素是特定类型的对象，形成一个队列。 Java中的Stream并不会存储元素，而是按需计算。</li>
<li><strong>数据源</strong> 流的来源。 可以是集合，数组，I&#x2F;O channel， 产生器 generator 等。</li>
<li><strong>聚合操作</strong> 类似 SQL 语句一样的操作， 比如 filter, map, reduce, find, match, sorted 等。</li>
</ul>
<p>和以前的 Collection 操作不同， Stream 操作还有两个基础的<font color="red"><strong>特征</strong></font>：</p>
<ul>
<li><strong>流水线 (Pipeline)</strong>：中间操作都会返回流对象本身。 这样多个操作可以串联成一个管道， 如同流式风格（fluent style）。 这样做可以对操作进行优化， 比如延迟执行(laziness)和短路( short-circuiting)。</li>
<li><strong>内部迭代</strong>：以前对集合遍历都是通过Iterator或者For-Each的方式, 显式的在集合外部进行迭代， 这叫做外部迭代。 Stream提供了内部迭代的方式， 通过访问者模式(Visitor)实现。</li>
</ul>
<p><font color="red"><strong>注意：</strong></font> </p>
<p>①Stream 自己不会存储元素。</p>
<p>②Stream 不会改变源对象。相反，他们会返回一个持有结果的新Stream。</p>
<p>③Stream 操作是延迟执行的。这意味着他们会等到需要结果的时候才执行。</p>
<h2 id="Stream操作步骤"><a href="#Stream操作步骤" class="headerlink" title="Stream操作步骤"></a>Stream操作步骤</h2><p>将要处理的元素集合看作一种流， 流在管道中传输， 并且可以在管道的节点上进行处理， 比如筛选， 排序，聚合等。</p>
<p>元素流在管道中经过中间操作（intermediate operation）的处理，最后由终端操作(terminal operation)得到前面处理的结果。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+--------------------+       +------+   +------+   +---+   +-------+</span><br><span class="line">| stream of elements +-----&gt; |filter+-&gt; |sorted+-&gt; |map+-&gt; |collect|</span><br><span class="line">+--------------------+       +------+   +------+   +---+   +-------+</span><br></pre></td></tr></table></figure>

<p><strong>步骤一、创建 Stream</strong></p>
<p>一个数据源（如： 集合、数组）， 获取一个流。</p>
<p><strong>步骤二、中间操作</strong></p>
<p>一个中间操作链，对数据源的数据进行处理。</p>
<p><strong>步骤三、终止操作(终端操作)</strong></p>
<p>一个终止操作，执行中间操作链，并产生结果 。</p>
<p><img src="/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/20200525225333187.jpg" alt="在这里插入图片描述"></p>
<p>以上步骤转换为 Java 代码为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; transactionsIds = </span><br><span class="line">widgets.stream()</span><br><span class="line">             .filter(b -&gt; b.getColor() == RED)</span><br><span class="line">             .sorted((x,y) -&gt; x.getWeight() - y.getWeight())</span><br><span class="line">             .mapToInt(Widget::getWeight)</span><br><span class="line">             .sum();</span><br></pre></td></tr></table></figure>

<h2 id="如何创建Stream流？"><a href="#如何创建Stream流？" class="headerlink" title="如何创建Stream流？"></a>如何创建Stream流？</h2><h3 id="Collection接口的两个default方法"><a href="#Collection接口的两个default方法" class="headerlink" title="Collection接口的两个default方法"></a>Collection接口的两个default方法</h3><p>在 Java 8 中, 单列集合Collection接口有两个方法来生成<font color="red">集合流</font>。示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// 为集合创建串行流。</span></span><br><span class="line">list.stream();</span><br><span class="line"><span class="comment">// 为集合创建并行流。</span></span><br><span class="line">list.parallelStream();</span><br></pre></td></tr></table></figure>

<h3 id="Arrays工具类的静态方法stream"><a href="#Arrays工具类的静态方法stream" class="headerlink" title="Arrays工具类的静态方法stream()"></a>Arrays工具类的静态方法stream()</h3><p>Java8 中的 Arrays类的静态方法 stream() 可以获取<font color="red">数组流</font>，还提供了多种形式的重载。示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arrayInt = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;;</span><br><span class="line">        <span class="type">IntStream</span> <span class="variable">intStream</span> <span class="operator">=</span> Arrays.stream(arrayInt);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span>[] arrayLong = <span class="keyword">new</span> <span class="title class_">long</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;;</span><br><span class="line">        <span class="type">LongStream</span> <span class="variable">longStream</span> <span class="operator">=</span> Arrays.stream(arrayLong);</span><br><span class="line"></span><br><span class="line">        <span class="type">double</span>[] arrayDouble = <span class="keyword">new</span> <span class="title class_">double</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;;</span><br><span class="line">        <span class="type">DoubleStream</span> <span class="variable">doubleStream</span> <span class="operator">=</span> Arrays.stream(arrayDouble);</span><br><span class="line"></span><br><span class="line">        Object[] arrayObject = <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;6&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;9&quot;</span>&#125;;</span><br><span class="line">        Stream&lt;Object&gt; stream = Arrays.stream(arrayObject);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1、stream流转数组</span></span><br><span class="line">        arrayObject = Arrays.stream(arrayObject).toArray();</span><br><span class="line">        arrayObject = Arrays.stream(arrayObject).toArray(Object[]::<span class="keyword">new</span>);</span><br><span class="line">        <span class="comment">// 这里使用普通for循环遍历.因为增强的For-Each循环丢掉索引信息。</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arrayObject.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (i == arrayObject.length - <span class="number">1</span>) &#123;</span><br><span class="line">                System.out.print(arrayObject[i]);</span><br><span class="line">                System.out.println(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">                <span class="comment">// 在这里，continue与break结果一致，因为进入这里意味着最后一次循环</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.print(arrayObject[i] + <span class="string">&quot;, &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2、stream流转list集合</span></span><br><span class="line">        <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> Arrays.stream(arrayObject).collect(Collectors.toList());</span><br><span class="line">        System.out.println(list);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3、stream流转set集合</span></span><br><span class="line">        <span class="type">Set</span> <span class="variable">set</span> <span class="operator">=</span> Arrays.stream(arrayObject).collect(Collectors.toSet());</span><br><span class="line">        System.out.println(set);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Stream类的静态方法of"><a href="#Stream类的静态方法of" class="headerlink" title="Stream类的静态方法of()"></a>Stream类的静态方法of()</h3><p>在Stream类中，提供了两个<code>of()</code>方法用以获取流，一个参数是泛型，另一个参数是可变泛型。</p>
<p><font color="red">同理：IntStream.of、LongStream.of、DoubleStream.of</font> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; strList = Arrays.asList(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);</span><br><span class="line">        <span class="comment">// arrayStream1只有一个元素，该元素是strList集合</span></span><br><span class="line">        Stream&lt;List&lt;String&gt;&gt; arrayStream1 = Stream.of(strList);</span><br><span class="line">        arrayStream1.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// arrayStream2有三个元素，分别是 &quot;a&quot;, &quot;b&quot;, &quot;c&quot;。</span></span><br><span class="line">        Stream&lt;String&gt; arrayStream2 = Stream.of(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);</span><br><span class="line">        arrayStream2.forEach(System.out::println);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// intStream有五个元素</span></span><br><span class="line">        <span class="type">IntStream</span> <span class="variable">intStream</span> <span class="operator">=</span> IntStream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="comment">// intStream.forEach(System.out::println);</span></span><br><span class="line">        <span class="comment">// intStream.mapToObj(Integer::valueOf).forEach(System.out::println);</span></span><br><span class="line">        intStream.boxed().forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Random类"><a href="#Random类" class="headerlink" title="Random类"></a>Random类</h3><p>更多重载方法见源码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">IntStream</span> <span class="variable">intStream</span> <span class="operator">=</span> random.ints(<span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">intStream.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="type">LongStream</span> <span class="variable">longStream</span> <span class="operator">=</span> random.longs(<span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">longStream.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="type">DoubleStream</span> <span class="variable">doubleStream</span> <span class="operator">=</span> random.doubles(<span class="number">5</span>, <span class="number">1.0</span>, <span class="number">5.0</span>);</span><br><span class="line">doubleStream.forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="创建无限流"><a href="#创建无限流" class="headerlink" title="创建无限流"></a>创建无限流</h3><h4 id="Stream类"><a href="#Stream类" class="headerlink" title="Stream类"></a>Stream类</h4><p>可以使用静态方法 Stream.iterate() 和Stream.generate(), 创建无限流。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// iterate()方法是使用“迭代”的方式生成无限流，需要指定初始值</span></span><br><span class="line">Stream&lt;Integer&gt; stream1 = Stream.iterate(<span class="number">2</span>, x -&gt; x + <span class="number">2</span>);</span><br><span class="line">stream1.limit(<span class="number">5</span>).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">// generate()方法是使用“生成”的方式生成无限流</span></span><br><span class="line">Stream&lt;Double&gt; stream2 = Stream.generate(() -&gt; Math.random());</span><br><span class="line">stream2.limit(<span class="number">5</span>).forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h4 id="Random类-1"><a href="#Random类-1" class="headerlink" title="Random类"></a>Random类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">random.ints().forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="创建空流"><a href="#创建空流" class="headerlink" title="创建空流"></a>创建空流</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; empty1 = Stream.empty();</span><br><span class="line">Stream&lt;Integer&gt; empty2 = Stream.empty();</span><br><span class="line">Stream&lt;Long&gt; empty3 = Stream.empty();</span><br><span class="line">Stream&lt;Double&gt; empty4 = Stream.empty();</span><br></pre></td></tr></table></figure>

<h2 id="并行流与串行流"><a href="#并行流与串行流" class="headerlink" title="并行流与串行流"></a>并行流与串行流</h2><h3 id="什么是并行流？"><a href="#什么是并行流？" class="headerlink" title="什么是并行流？"></a>什么是并行流？</h3><p>简单来说，并行流就是把一个内容分成多个数据块，并用不同的线程分别处理每个数据块的流。</p>
<p>Java 8 中将并行进行了优化，我们可以很容易的对数据进行并行操作。</p>
<p><font color="red">Stream API 可以通过 BaseStream 类的 <code>parallel()</code> 和 <code>sequential()</code> 方法在并行流与串行流之间进行切换 。</font> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;bbb&quot;</span>, <span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;ddd&quot;</span>);</span><br><span class="line">list.stream();</span><br><span class="line">list.parallelStream();</span><br><span class="line">list.stream().parallel().sequential().isParallel();</span><br></pre></td></tr></table></figure>

<h3 id="Fork-Join-框架"><a href="#Fork-Join-框架" class="headerlink" title="Fork&#x2F;Join 框架"></a>Fork&#x2F;Join 框架</h3><p><font color="red">推荐链接：</font> <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzU4Njg0MzYwNw==&mid=2247484765&idx=1&sn=83b8260d693d09f7c3761df7f480add7&chksm=fdf451e5ca83d8f3c1c4aaaac83a2dbfed1045b507b4f0e3e55b10a333fffb8ce232ca53e40c&scene=178&cur_album_id=1342230680016683009#rd">Java并发编程(07)：Fork&#x2F;Join框架机制详解</a> </p>
<p>Fork&#x2F;Join 框架： 就是在必要的情况下，将一个大任务，进行拆分(fork)成若干个小任务（拆到不可再拆时），再将一个个的小任务运算的结果进行 join 汇总 。</p>
<p><img src="/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/20200529215128935.jpg" alt="在这里插入图片描述"></p>
<h4 id="Fork-Join-框架与传统线程池有啥区别？"><a href="#Fork-Join-框架与传统线程池有啥区别？" class="headerlink" title="Fork&#x2F;Join 框架与传统线程池有啥区别？"></a>Fork&#x2F;Join 框架与传统线程池有啥区别？</h4><p>采用 “工作窃取”模式（work-stealing）：</p>
<p>当执行新的任务时它可以将其拆分成更小的任务执行，并将小任务加到线程队列中，然后再从一个随机线程的队列中偷一个并把它放在自己的队列中。</p>
<p>相对于一般的线程池实现，fork&#x2F;join框架的优势体现在对其中包含的任务的处理方式上。在一般的线程池中，如果一个线程正在执行的任务由于某些原因无法继续运行，那么该线程会处于等待状态。而在fork&#x2F;join框架的实现中，如果某个子任务由于等待另外一个子任务的完成而无法继续运行。那么处理该子问题的线程会主动寻找其他尚未运行的子任务来执行。这种方式减少了线程的等待时间，提高了程序的性能。</p>
<h4 id="Fork-Join框架实例"><a href="#Fork-Join框架实例" class="headerlink" title="Fork&#x2F;Join框架实例"></a>Fork&#x2F;Join框架实例</h4><p>了解了Fork&#x2F;Join框架的原理之后，我们就来手动写一个使用Fork&#x2F;Join框架实现累加和的示例程序，以帮助理解Fork&#x2F;Join框架。好好体会下Fork&#x2F;Join框架的强大。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ForkJoinTaskExample</span> <span class="keyword">extends</span> <span class="title class_">RecursiveTask</span>&lt;Long&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">startValue</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">endValue</span> <span class="operator">=</span> <span class="number">600000000L</span>; <span class="comment">// 分别设置值为 60000L、600000000L、</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">long</span> threshold;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> start;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> end;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ForkJoinTaskExample</span><span class="params">(<span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.start = start;</span><br><span class="line">        <span class="built_in">this</span>.end = end;</span><br><span class="line">        <span class="comment">// 阈值始终设置为endValue的六分之一，我的cpu是6核。</span></span><br><span class="line">        threshold = endValue / <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Long <span class="title function_">compute</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//如果任务足够小就计算任务</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">canCompute</span> <span class="operator">=</span> (end - start) &lt;= threshold;</span><br><span class="line">        <span class="keyword">if</span> (canCompute) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> start; i &lt;= end; i++) &#123;</span><br><span class="line">                sum += i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果任务大于阈值，就分裂成两个子任务计算</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">middle</span> <span class="operator">=</span> (start + end) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">            <span class="type">ForkJoinTaskExample</span> <span class="variable">leftTask</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ForkJoinTaskExample</span>(start, middle);</span><br><span class="line">            <span class="type">ForkJoinTaskExample</span> <span class="variable">rightTask</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ForkJoinTaskExample</span>(middle + <span class="number">1</span>, end);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 执行子任务</span></span><br><span class="line">            leftTask.fork();</span><br><span class="line">            rightTask.fork();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 等待任务执行结束合并其结果</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">leftResult</span> <span class="operator">=</span> leftTask.join();</span><br><span class="line">            <span class="type">long</span> <span class="variable">rightResult</span> <span class="operator">=</span> rightTask.join();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 合并子任务</span></span><br><span class="line">            sum = leftResult + rightResult;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        <span class="type">ForkJoinPool</span> <span class="variable">forkjoinPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ForkJoinPool</span>();</span><br><span class="line">        <span class="comment">//生成一个计算任务</span></span><br><span class="line">        <span class="type">ForkJoinTaskExample</span> <span class="variable">task</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ForkJoinTaskExample</span>(startValue, endValue);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行一个任务</span></span><br><span class="line">        Future&lt;Long&gt; result = forkjoinPool.submit(task);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;result:&#123;&#125;&quot;</span>, result.get());</span><br><span class="line">            log.info(<span class="string">&quot;---- Fork/Join 框架耗时：\t&quot;</span> + (System.nanoTime() - startTime));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;exception&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime2</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        <span class="type">long</span> <span class="variable">sum2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> startValue; i &lt;= endValue; i++) &#123;</span><br><span class="line">            sum2 += i;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">&quot;result:&#123;&#125;&quot;</span>, sum2);</span><br><span class="line">        log.info(<span class="string">&quot;---- 普通 for 循环耗时：\t&quot;</span> + (System.nanoTime() - startTime2));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime3</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        <span class="type">long</span> <span class="variable">sum3</span> <span class="operator">=</span> LongStream.rangeClosed(startValue, endValue).parallel().reduce(<span class="number">0</span>, Long::sum);</span><br><span class="line">        log.info(<span class="string">&quot;result:&#123;&#125;&quot;</span>, sum3);</span><br><span class="line">        log.info(<span class="string">&quot;---- stream 流耗时：\t\t&quot;</span> + (System.nanoTime() - startTime3));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h2><p>以下是已有的三个于收集统计信息（例如计数，最小值，最大值，总和和平均值）的摘要：</p>
<ul>
<li>IntSummaryStatistics</li>
<li>LongSummaryStatistics</li>
<li>DoubleSummaryStatistics</li>
</ul>
<p>可以由 IntStream、LongStream、DoubleStream 的 summaryStatistics() 方法获得。</p>
<p>也可以在使用 Stream.collect(Collector&lt;? super T, A, R&gt; collector) 方法时，传入 Collectors 的 summarizingInt 、summarizingLong、summingDouble 方法，以获取统计摘要。示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DoubleSummaryStatistics</span> <span class="variable">dss</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.summarizingDouble(Employee::getSalary));</span><br></pre></td></tr></table></figure>

<p>完整示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;-----------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println((ArrayList) numbers.stream().mapToInt(x -&gt; x).collect(ArrayList::<span class="keyword">new</span>, (list1, e) -&gt; list1.add(e), (list1, list2) -&gt; list1.addAll(list2)));</span><br><span class="line">System.out.println(numbers.stream().mapToInt(x -&gt; x).boxed().collect(Collectors.toList()));</span><br><span class="line">System.out.println(numbers.stream().flatMapToDouble(x -&gt; DoubleStream.of(x)).boxed().collect(Collectors.toList()));</span><br><span class="line">System.out.println(<span class="string">&quot;-----------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">IntSummaryStatistics</span> <span class="variable">stats_1</span> <span class="operator">=</span> numbers.stream().mapToInt((x) -&gt; x).summaryStatistics();</span><br><span class="line">System.out.println(<span class="string">&quot;列表中最大的数 : &quot;</span> + stats_1.getMax());</span><br><span class="line">System.out.println(<span class="string">&quot;列表中最小的数 : &quot;</span> + stats_1.getMin());</span><br><span class="line">System.out.println(<span class="string">&quot;所有数之和 : &quot;</span> + stats_1.getSum());</span><br><span class="line">System.out.println(<span class="string">&quot;平均数 : &quot;</span> + stats_1.getAverage());</span><br><span class="line">System.out.println(<span class="string">&quot;计数 : &quot;</span> + stats_1.getCount());</span><br><span class="line">System.out.println(<span class="string">&quot;-----------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">IntSummaryStatistics</span> <span class="variable">stats_2</span> <span class="operator">=</span> numbers.stream().flatMapToInt(x -&gt; IntStream.of(x)).summaryStatistics();</span><br><span class="line">System.out.println(<span class="string">&quot;列表中最大的数 : &quot;</span> + stats_2.getMax());</span><br><span class="line">System.out.println(<span class="string">&quot;列表中最小的数 : &quot;</span> + stats_2.getMin());</span><br><span class="line">System.out.println(<span class="string">&quot;所有数之和 : &quot;</span> + stats_2.getSum());</span><br><span class="line">System.out.println(<span class="string">&quot;平均数 : &quot;</span> + stats_2.getAverage());</span><br><span class="line">System.out.println(<span class="string">&quot;计数 : &quot;</span> + stats_2.getCount());</span><br><span class="line">System.out.println(<span class="string">&quot;-----------------------------------------------&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Stream的中间操作"><a href="#Stream的中间操作" class="headerlink" title="Stream的中间操作"></a>Stream的中间操作</h2><p>多个中间操作可以连接起来形成一个流水线，除非流水线上触发终止操作，否则中间操作不会执行任何的处理！而在终止操作时一次性全部处理，称为“惰性求值” 。 Stream的中间操作是不会有任何结果数据输出的。</p>
<p>Stream的中间操作在整体上可以分为：筛选与切片、映射、排序。</p>
<h3 id="筛选与切片"><a href="#筛选与切片" class="headerlink" title="筛选与切片"></a>筛选与切片</h3><p>筛选和切片相关操作：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>filter(Predicate p)</td>
<td>接收Lambda表达式，从流中排除某些元素</td>
</tr>
<tr>
<td>distinct()</td>
<td>筛选，通过流所生成元素的 hashCode() 和 equals() 去 除重复元素</td>
</tr>
<tr>
<td>limit(long maxSize)</td>
<td>截断流，使其元素不超过给定数量</td>
</tr>
<tr>
<td>skip(long n)</td>
<td>跳过元素，返回一个扔掉了前 n 个元素的流。若流中元素 不足 n 个，则返回一个空流。与 limit(n) 互补</td>
</tr>
</tbody></table>
<p>接下来，我们列举几个简单的示例，以便加深理解。</p>
<p>为了更好的测试程序，先构造一个对象数组，如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">static</span> List&lt;Employee&gt; listEmployee = Arrays.asList(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">18</span>, <span class="number">9999.99</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">38</span>, <span class="number">5555.55</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">60</span>, <span class="number">6666.66</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">8</span>, <span class="number">7777.77</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;田七&quot;</span>, <span class="number">58</span>, <span class="number">3333.33</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>Employee类的定义如下。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@Data</span></span><br><span class="line"><span class="variable">@Builder</span></span><br><span class="line"><span class="variable">@ToString</span></span><br><span class="line"><span class="variable">@NoArgsConstructor</span></span><br><span class="line"><span class="variable">@AllArgsConstructor</span></span><br><span class="line">class Employee implements Serializable &#123;</span><br><span class="line">    private <span class="keyword">static</span> <span class="keyword">final</span> long serialVersionUID <span class="operator">=</span> <span class="number">-9079722457749166858</span>L;</span><br><span class="line">    private String name;</span><br><span class="line">    private <span class="type">Integer</span> age;</span><br><span class="line">    private <span class="keyword">Double</span> salary;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="filter-1"><a href="#filter-1" class="headerlink" title="filter"></a>filter</h4><p>filter 方法用于通过设置的条件过滤出元素。以下代码片段使用 filter 方法过滤出空字符串：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt;strings = Arrays.asList(<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;bc&quot;</span>, <span class="string">&quot;efg&quot;</span>, <span class="string">&quot;abcd&quot;</span>,<span class="string">&quot;&quot;</span>, <span class="string">&quot;jkl&quot;</span>);</span><br><span class="line"><span class="comment">// 获取包含字符a的字符串</span></span><br><span class="line">List&lt;String&gt; strings2 = strings.stream().filter(t -&gt; t.contains(<span class="string">&quot;a&quot;</span>)).collect(Collectors.toList());</span><br><span class="line"><span class="comment">// 获取空字符串的数量</span></span><br><span class="line"><span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> strings.stream().filter(string -&gt; string.isEmpty()).count();</span><br></pre></td></tr></table></figure>

<h4 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h4><p>limit 方法返回由该流的元素组成的流，其长度被截断。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"><span class="comment">// 打印 10 条数据</span></span><br><span class="line">random.ints().limit(<span class="number">10</span>).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;bc&quot;</span>, <span class="string">&quot;efg&quot;</span>, <span class="string">&quot;abcd&quot;</span>,<span class="string">&quot;&quot;</span>, <span class="string">&quot;jkl&quot;</span>);</span><br><span class="line">List&lt;String&gt; strings2 = strings.stream().limit(<span class="number">3</span>).collect(Collectors.toList());</span><br></pre></td></tr></table></figure>

<h4 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h4><p>skip 方法丢弃流的前 n 个元素，返回由其余元素组成的流。如果此流包含少于 n 个元素，则将返回空流。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//跳过前3个值</span></span><br><span class="line">listEmployee.stream().skip(<span class="number">3</span>).forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h4 id="distinct"><a href="#distinct" class="headerlink" title="distinct"></a>distinct</h4><p>distinct 方法通过流所生成元素的 <strong>hashCode()</strong> 和 <strong>equals()</strong> 去除重复元素。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(listEmployee.stream().distinct().collect(Collectors.toList()));</span><br></pre></td></tr></table></figure>

<p><strong>注意：distinct 需要实体中重写 hashCode() 和 equals() 方法才可以使用。</strong></p>
<h3 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h3><p>映射相关操作：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>返回类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>map(Function f)</td>
<td>Stream</td>
<td>接收一个函数作为参数，该函数会被应用到每个元素上，产生一个新的 Stream。</td>
</tr>
<tr>
<td>mapToDouble(ToDoubleFunction f)</td>
<td>DoubleStream</td>
<td>接收一个函数作为参数，该函数会被应用到每个元素上，产生一个新的 DoubleStream。</td>
</tr>
<tr>
<td>mapToInt(ToIntFunction f)</td>
<td>IntStream</td>
<td>接收一个函数作为参数，该函数会被应用到每个元素上，产生一个新的 IntStream。</td>
</tr>
<tr>
<td>mapToLong(ToLongFunction f)</td>
<td>LongStream</td>
<td>接收一个函数作为参数，该函数会被应用到每个元素上，产生一个新的 LongStream。</td>
</tr>
<tr>
<td>flatMap(Function f)</td>
<td>Stream</td>
<td>接收一个函数作为参数，将流中的每个值都换成另一个流，然后把所有流连接成一个 Stream。</td>
</tr>
<tr>
<td>flatMapToDouble(Function f)</td>
<td>DoubleStream</td>
<td>接收一个函数作为参数，将流中的每个值都换成另一个流，然后把所有流连接成一个 DoubleStream。</td>
</tr>
<tr>
<td>flatMapToInt(Function f)</td>
<td>IntStream</td>
<td>接收一个函数作为参数，将流中的每个值都换成另一个流，然后把所有流连接成一个 IntStream。</td>
</tr>
<tr>
<td>flatMapToLong(Function f)</td>
<td>LongStream</td>
<td>接收一个函数作为参数，将流中的每个值都换成另一个流，然后把所有流连接成一个 LongStream。</td>
</tr>
</tbody></table>
<h4 id="map-1"><a href="#map-1" class="headerlink" title="map"></a>map</h4><p>map 方法返回一个流，该流包括将给定函数应用于此流的元素的结果。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line"><span class="comment">// 获取对应的平方数</span></span><br><span class="line">List&lt;Integer&gt; squaresList = numbers.stream().map(i -&gt; i * i).distinct().collect(Collectors.toList());</span><br><span class="line">System.out.println(squaresList);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将流中每一个元素都映射到map的函数中，每个元素执行这个函数，再返回</span></span><br><span class="line">List&lt;String&gt; listStr = Arrays.asList(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;bbb&quot;</span>, <span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;ddd&quot;</span>);</span><br><span class="line">listStr.stream().map((e) -&gt; e.toUpperCase()).forEach(System.out::printf);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取Employee中的每一个人得名字name，再返回一个集合</span></span><br><span class="line">List&lt;String&gt; names = listEmployee.stream().map(Employee::getName).collect(Collectors.toList());</span><br><span class="line">System.out.println(names);</span><br></pre></td></tr></table></figure>

<h4 id="flatMap-1"><a href="#flatMap-1" class="headerlink" title="flatMap"></a>flatMap</h4><p>返回一个流，将流中的 n 个元素，通过映射函数处理得到 n 个映射流，然后将每个映射流的<font color="red"><strong>内容</strong></font>放入该流，形成一个流并返回。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;R&gt; Stream&lt;R&gt;     map(Function&lt;? super T, ? extends R&gt; mapper);</span></span><br><span class="line"><span class="comment">// &lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;bbb&quot;</span>, <span class="string">&quot;ccc&quot;</span>, <span class="string">&quot;ddd&quot;</span>);</span><br><span class="line">        list.stream().flatMap(Test::filterCharacter).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果使用map则需要这样写，</span></span><br><span class="line">        <span class="comment">// 因为map返回的流是由多个映射流组成；而flatMap返回的流是由多个映射流的内容组成。</span></span><br><span class="line">        list.stream().map(Test::filterCharacter).forEach((e) -&gt; &#123;</span><br><span class="line">            e.forEach(System.out::println);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将一个字符串转换为流</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Stream&lt;String&gt; <span class="title function_">filterCharacter</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(str);</span><br><span class="line">        <span class="keyword">return</span> list.stream();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实 map 方法就相当于 <code>Collection</code> 的 add 方法，如果 add 的是个集合得话就会变成二维数组，而 flatMap 的话就相当于 <code>Collections.addAll()</code> 方法，参数如果是集合得话，只是将2个集合合并，而不是变成二维数组。</p>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>排序相关操作：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td>sorted()</td>
<td align="center">产生一个新流，其中按自然顺序排序</td>
</tr>
<tr>
<td>sorted(Comparator comp)</td>
<td align="center">产生一个新流，其中按比较器顺序排序</td>
</tr>
</tbody></table>
<p>从上述表格可以看出：sorted有两种方法，一种是不传任何参数，叫<strong>自然排序</strong>，还有一种需要传Comparator 接口参数，叫做<strong>定制排序</strong>。</p>
<h4 id="sorted"><a href="#sorted" class="headerlink" title="sorted"></a>sorted</h4><p>sorted 方法用于对流进行排序。以下代码片段使用 sorted 方法对输出的 10 个随机数进行排序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"><span class="comment">// 自然排序</span></span><br><span class="line">List&lt;Integer&gt; list = random.ints().limit(<span class="number">10</span>).sorted().boxed().collect(Collectors.toList());</span><br><span class="line">list.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;bc&quot;</span>, <span class="string">&quot;efg&quot;</span>, <span class="string">&quot;abcd&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;ba&quot;</span>, <span class="string">&quot;jkl&quot;</span>);</span><br><span class="line"><span class="comment">// 定制排序</span></span><br><span class="line">strings = strings.stream().sorted(String::compareTo).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"><span class="comment">//定制排序</span></span><br><span class="line">listEmployee.stream().sorted((e1, e2) -&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (e1.getAge().equals(e2.getAge())) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e1.getAge() &gt; e2.getAge()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).forEach((e) -&gt; System.out.println(e.getAge()));</span><br></pre></td></tr></table></figure>

<h2 id="Stream的终止操作"><a href="#Stream的终止操作" class="headerlink" title="Stream的终止操作"></a>Stream的终止操作</h2><p>终端操作会从流的流水线生成结果。其结果可以是任何不是流的值，例如： List、 Integer、Double、String等等，甚至是 void 。</p>
<p>为了更好的测试程序，先构造一个对象数组，如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">static</span> List&lt;Employee&gt; listEmployees = Arrays.asList(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">18</span>, <span class="number">9999.99</span>, Employee.Stauts.SLEEPING),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">38</span>, <span class="number">5555.55</span>, Employee.Stauts.WORKING),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">60</span>, <span class="number">6666.66</span>, Employee.Stauts.WORKING),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">8</span>, <span class="number">7777.77</span>, Employee.Stauts.SLEEPING),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;田七&quot;</span>, <span class="number">58</span>, <span class="number">8888.88</span>, Employee.Stauts.VOCATION)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>Employee类的定义如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">9079722457749166858L</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Double salary;</span><br><span class="line">    <span class="keyword">private</span> Stauts stauts;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Stauts</span> &#123;</span><br><span class="line">        WORKING,</span><br><span class="line">        SLEEPING,</span><br><span class="line">        VOCATION</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h3><table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>forEach(Consumer c)</td>
<td>内部迭代(使用 Collection 接口需要用户去做迭代，称为外部迭代。相反， Stream API 使用内部迭代)</td>
</tr>
</tbody></table>
<p>为此流的每个元素执行一个动作 (内部迭代流中的每个数据)。</p>
<p>此操作的行为是明确不确定的。对于并行流管道，此操作不能保证遵守流遇到的顺序，保证顺序会牺牲并行的好处。如果操作访问共享状态(比如:线程安全、共享变量)，请做好所需的同步， <a href>parallelStream线程安全问题</a> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 无返回值</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">forEach</span><span class="params">(Consumer&lt;? <span class="built_in">super</span> T&gt; action)</span>;</span><br><span class="line"></span><br><span class="line">listEmployees.stream().forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;bc&quot;</span>, <span class="string">&quot;efg&quot;</span>, <span class="string">&quot;abcd&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;jkl&quot;</span>);</span><br><span class="line">strings.stream().forEach(t -&gt; System.out.println(t));</span><br><span class="line">strings.stream().forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">random.ints().limit(<span class="number">10</span>).forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="查找与匹配"><a href="#查找与匹配" class="headerlink" title="查找与匹配"></a>查找与匹配</h3><p>查找与匹配相关操作：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>allMatch(Predicate p)</td>
<td>检查是否匹配所有元素</td>
</tr>
<tr>
<td>anyMatch(Predicate p)</td>
<td>检查是否至少匹配一个元素</td>
</tr>
<tr>
<td>noneMatch(Predicate p)</td>
<td>检查是否没有匹配所有元素</td>
</tr>
<tr>
<td>findFirst()</td>
<td>返回第一个元素</td>
</tr>
<tr>
<td>findAny()</td>
<td>返回当前流中的任意元素</td>
</tr>
<tr>
<td>count()</td>
<td>返回流中元素总数</td>
</tr>
<tr>
<td>max(Comparator c)</td>
<td>返回流中最大值</td>
</tr>
<tr>
<td>min(Comparator c)</td>
<td>返回流中最小值</td>
</tr>
</tbody></table>
<h4 id="allMatch"><a href="#allMatch" class="headerlink" title="allMatch"></a>allMatch</h4><p>返回此流的所有元素是否与提供的 Predicate 匹配。如果流中的所有元素都与提供的 Predicate 匹配，或者流为空，返回 true。函数式接口 Predicate 中可选择要处理的元素。</p>
<p><strong>注意：使用allMatch()方法时，只有所有的元素都匹配条件时 (即 Predicate 都返回true)，allMatch()方法才会返回true。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="variable">match</span> <span class="operator">=</span> listEmployees.stream().allMatch((e) -&gt; &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">boo</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (e.getName().equals(<span class="string">&quot;李四&quot;</span>)) &#123;</span><br><span class="line">        boo = Employee.Stauts.SLEEPING.equals(e.getStauts()); <span class="comment">// false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> boo;</span><br><span class="line">&#125;);</span><br><span class="line">System.out.println(match); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<h4 id="anyMatch"><a href="#anyMatch" class="headerlink" title="anyMatch"></a>anyMatch</h4><p>返回此流的任何元素是否与提供的 Predicate 匹配。如果流中无任何元素与提供的 Predicate 匹配，或者流为空，返回 false。函数式接口 Predicate 中可选择要处理的元素。</p>
<p><strong>注意：使用anyMatch()方法时，只要有一个元素匹配条件 (即 Predicate 返回true)，anyMatch()方法就会返回true。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="variable">match</span> <span class="operator">=</span> listEmployees.stream().anyMatch((e) -&gt; &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">boo</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (e.getName().equals(<span class="string">&quot;李四&quot;</span>)) &#123;</span><br><span class="line">        boo = Employee.Stauts.WORKING.equals(e.getStauts()); <span class="comment">// true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> boo;</span><br><span class="line">&#125;);</span><br><span class="line">System.out.println(match); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h4 id="noneMatch"><a href="#noneMatch" class="headerlink" title="noneMatch"></a>noneMatch</h4><p>返回此流中是否没有元素与提供的 Predicate 匹配。如果流中没有元素与提供的 Predicate 匹配，或者流为空，返回 true。函数式接口 Predicate 中可选择要处理的元素。</p>
<p><strong>注意：使用noneMatch()方法时，只有所有的元素都不匹配条件时 (即 Predicate 都返回false)，noneMatch()方法才会返回true。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="variable">match</span> <span class="operator">=</span> listEmployees.stream().noneMatch((e) -&gt; &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">boo</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (e.getName().equals(<span class="string">&quot;李四&quot;</span>)) &#123;</span><br><span class="line">        boo = Employee.Stauts.SLEEPING.equals(e.getStauts()); <span class="comment">// false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> boo;</span><br><span class="line">&#125;);</span><br><span class="line">System.out.println(match); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h4 id="findFirst"><a href="#findFirst" class="headerlink" title="findFirst"></a>findFirst</h4><p>返回描述此流的第一个元素的 Optional，如果流为空，则返回空的 Optional。如果流没有遇到顺序，则可以返回任何元素。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;Employee&gt; opt = listEmployees.stream().findFirst();</span><br><span class="line">System.out.println(opt.isPresent());</span><br><span class="line">System.out.println(opt.get());</span><br></pre></td></tr></table></figure>

<h4 id="findAny"><a href="#findAny" class="headerlink" title="findAny"></a>findAny</h4><p>返回描述流中任意一个元素的 Optional，如果流为空，则返回空的{@code Optional}。</p>
<p>串行操作：与 findFirst() 返回值相同。</p>
<p>并行操作：此操作的行为是不确定的，可以自由选择流中的任何元素。这是为了在并行操作中获得最佳性能。代价是对同一源的多次调用可能不会返回相同的结果。（如果需要稳定的结果，请改用{@link #findFirst（）}。）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Employee&gt; stream = listEmployees.stream();</span><br><span class="line">System.out.println(<span class="string">&quot;串行流findFirst: &quot;</span> + stream.findFirst().get());</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// java.lang.IllegalStateException: 流已被操作或关闭</span></span><br><span class="line">    System.out.println(stream.findAny().get());</span><br><span class="line">&#125; <span class="keyword">catch</span> (IllegalStateException e) &#123;</span><br><span class="line">    e.printStackTrace(System.out);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;串行流findAny: &quot;</span> + listEmployees.stream().findAny().get());</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;并行流findFirst: &quot;</span> + listEmployees.parallelStream().findFirst());</span><br><span class="line">System.out.println(<span class="string">&quot;并行流findAny: &quot;</span> + listEmployees.parallelStream().findAny());</span><br><span class="line">System.out.println(<span class="string">&quot;并行流findAny: &quot;</span> + listEmployees.parallelStream().findAny());</span><br></pre></td></tr></table></figure>

<p>执行结果：</p>
<p><img src="/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7/image-20200921161008424.png" alt="image-20200921161008424"></p>
<h3 id="规约和收集"><a href="#规约和收集" class="headerlink" title="规约和收集"></a>规约和收集</h3><p>规约操作（<em>reduction operation</em>）又被称作折叠操作（<em>fold</em>），是通过某个连接动作将所有元素汇总成一个结果的过程。例如：</p>
<p>1、对流做聚合操作：对流中元素求和、求平均值、求最大值、最小值、求元素总个数。<font color="red"><strong>如果对数字操作，也可由统计摘要获取。</strong></font></p>
<p>2、将流转换成集合：将所有元素转换成一个列表或集合。</p>
<p><em>Stream</em> 类库有两个通用的规约操作 <code>reduce()</code> 和 <code>collect()</code> ，也有一些为简化书写而设计的专用规约操作，比如 <code>sum()</code>、<code>max()</code>、<code>min()</code>、<code>count()</code> 等。</p>
<p>最大最小值这类规约操作很好理解（至少方法语义上是这样），重点是有魔法的 <code>reduce()</code> 和 <code>collect()</code> 。</p>
<h4 id="count"><a href="#count" class="headerlink" title="count"></a>count</h4><p>返回流中元素总数。<strong><font color="red">不可</font>由统计摘要获取。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Long&gt; list1 = listEmployees.stream().mapToLong(e -&gt; <span class="number">1L</span>).collect(<span class="keyword">new</span> <span class="title class_">Supplier</span>&lt;List&lt;Long&gt;&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Long&gt; <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="keyword">new</span> <span class="title class_">ObjLongConsumer</span>&lt;List&lt;Long&gt;&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(List&lt;Long&gt; dataList, <span class="type">long</span> value)</span> &#123;</span><br><span class="line">        dataList.add(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, (dataList1, dataList2) -&gt; dataList1.addAll(dataList2));</span><br><span class="line">System.out.println(list1);</span><br><span class="line">List&lt;Long&gt; list2 = listEmployees.stream().mapToLong(e -&gt; <span class="number">1L</span>).collect(ArrayList::<span class="keyword">new</span>, (dataList, i) -&gt; dataList.add(i), (dataList1, dataList2) -&gt; dataList1.addAll(dataList2));</span><br><span class="line">System.out.println(list2);</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">count1</span> <span class="operator">=</span> listEmployees.stream().count();</span><br><span class="line">System.out.println(count1);</span><br><span class="line"><span class="type">long</span> <span class="variable">count2</span> <span class="operator">=</span> listEmployees.stream().mapToLong(e -&gt; <span class="number">1L</span>).sum();</span><br><span class="line">System.out.println(count2);</span><br></pre></td></tr></table></figure>

<h4 id="max和min"><a href="#max和min" class="headerlink" title="max和min"></a>max和min</h4><p>根据提供的 Comparator 返回此流最大或最小元素的 Optional。<strong><font color="red">可</font>由统计摘要获取。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Integer</span> <span class="variable">maxAge</span> <span class="operator">=</span> listEmployees.stream().map(e -&gt; e.getAge()).max(Integer::compare).get();</span><br><span class="line"><span class="type">Integer</span> <span class="variable">minAge</span> <span class="operator">=</span> listEmployees.stream().map(e -&gt; e.getAge()).min(Integer::compare).get();</span><br><span class="line">System.out.println(maxAge);</span><br><span class="line">System.out.println(minAge);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 由统计摘要获取</span></span><br><span class="line"><span class="type">Double</span> <span class="variable">maxAge2</span> <span class="operator">=</span> listEmployees.stream().mapToDouble(e -&gt; e.getAge()).summaryStatistics().getMax();</span><br></pre></td></tr></table></figure>

<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>reduce(T iden, BinaryOperator b)</td>
<td>可以将流中元素<font color="red">反复结合</font>起来，得到一个值。 返回 T</td>
</tr>
<tr>
<td>reduce(BinaryOperator b)</td>
<td>可以将流中元素<font color="red">反复结合</font>起来，得到一个值。 返回 Optional</td>
</tr>
</tbody></table>
<p>在Stream接口中的定义如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">T <span class="title function_">reduce</span><span class="params">(T identity, BinaryOperator&lt;T&gt; accumulator)</span>;</span><br><span class="line">Optional&lt;T&gt; <span class="title function_">reduce</span><span class="params">(BinaryOperator&lt;T&gt; accumulator)</span>;</span><br><span class="line">&lt;U&gt; U <span class="title function_">reduce</span><span class="params">(U identity, BiFunction&lt;U, ? <span class="built_in">super</span> T, U&gt; accumulator, BinaryOperator&lt;U&gt; combiner)</span>;</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>);</span><br><span class="line"><span class="type">Integer</span> <span class="variable">result</span> <span class="operator">=</span> list.stream().reduce(<span class="number">0</span>, (x, y) -&gt; x - y);</span><br><span class="line">System.out.println(result);</span><br><span class="line">System.out.println(<span class="string">&quot;----------------------------------------&quot;</span>);</span><br><span class="line">Optional&lt;Double&gt; op = listEmployees.stream().map(Employee::getSalary).reduce(Double::sum);</span><br><span class="line">System.out.println(op.get());</span><br></pre></td></tr></table></figure>

<p>我们也可以搜索 listEmployees 列表中“张”出现的次数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    Optional&lt;Integer&gt; sum = listEmployees.stream()</span><br><span class="line">        .map(Employee::getName)</span><br><span class="line">        .flatMap(Test::filterCharacter)</span><br><span class="line">        .map((ch) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (ch.equals(<span class="string">&#x27;六&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).reduce(Integer::sum);</span><br><span class="line">    System.out.println(sum.get());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将一个字符串转换为流</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Stream&lt;String&gt; <span class="title function_">filterCharacter</span><span class="params">(String str)</span> &#123;</span><br><span class="line">    List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    list.add(str);</span><br><span class="line">    <span class="keyword">return</span> list.stream();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：上述例子使用了硬编码的方式来累加某个具体值，应用时需根据实际优化代码。</strong></p>
<h4 id="Collector和Collectors"><a href="#Collector和Collectors" class="headerlink" title="Collector和Collectors"></a>Collector和Collectors</h4><p>java.util.stream.Collector：接口中方法的实现，决定了如何对流执行收集操作(如收集到 List、 Set、 Map)。</p>
<p>java.util.stream.Collectors：该工具类内部实现了 Collector(收集器) ；提供了很多静态方法 (各种有用的归约操作，例如将元素累积到集合中，根据各种标准对元素进行汇总等)，可以方便地创建常见收集器实例。</p>
<h4 id="Collectors介绍"><a href="#Collectors介绍" class="headerlink" title="Collectors介绍"></a>Collectors介绍</h4><p>部分方法与示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> List&lt;Employee&gt; listEmployees = Arrays.asList(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">18</span>, <span class="number">9999.99</span>, Employee.Stauts.SLEEPING),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;李四&quot;</span>, <span class="number">38</span>, <span class="number">5555.55</span>, Employee.Stauts.WORKING),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">60</span>, <span class="number">6666.66</span>, Employee.Stauts.WORKING),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;赵六&quot;</span>, <span class="number">8</span>, <span class="number">7777.77</span>, Employee.Stauts.SLEEPING),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="string">&quot;田七&quot;</span>, <span class="number">58</span>, <span class="number">8888.88</span>, Employee.Stauts.VOCATION)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">pattern</span> <span class="operator">=</span> <span class="string">&quot;%-25s %s %s&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// toList：把流中元素收集到List</span></span><br><span class="line">        <span class="type">List</span> <span class="variable">employees1</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.toList());</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;toList: &quot;</span>, employees1, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// toSet：把流中元素收集到Set</span></span><br><span class="line">        <span class="type">Set</span> <span class="variable">employees2</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.toSet());</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;toSet: &quot;</span>, employees2, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// toCollection：把流中元素收集到创建的集合</span></span><br><span class="line">        <span class="type">Collection</span> <span class="variable">employees3</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.toCollection(ArrayList::<span class="keyword">new</span>));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;toCollection: &quot;</span>, employees3, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// counting：计算流中元素的个数</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.counting());</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;counting: &quot;</span>, count, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// summingDouble：对流中元素的Double属性求和</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">total1</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.summingDouble(Employee::getSalary));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;summingDouble: &quot;</span>, total1, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// reducing：从一个作为累加器的初始值开始，利用BinaryOperator与流中元素逐个结合，从而归约成单个值</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">total2</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.reducing(<span class="number">0.0</span>, Employee::getSalary, Double::sum));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;reducing: &quot;</span>, total2, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// averagingDouble：计算流中元素Double属性的平均值</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">avg</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.averagingDouble(Employee::getSalary));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;averagingDouble: &quot;</span>, avg, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// summarizingDouble：收集流中Double属性值, 返回用于收集统计信息的摘要 DoubleSummaryStatistics. 可用来计数, 最小值, 最大值, 总和, 平均值</span></span><br><span class="line">        <span class="type">DoubleSummaryStatistics</span> <span class="variable">dss</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.summarizingDouble(Employee::getSalary));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;summarizingDouble: &quot;</span>, dss.getMax(), <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;summarizingDouble: &quot;</span>, dss.getSum(), <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// joining：连接流中每个字符串</span></span><br><span class="line">        List&lt;String&gt; strings = Arrays.asList(<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;bc&quot;</span>, <span class="string">&quot;efg&quot;</span>, <span class="string">&quot;abcd&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;jkl&quot;</span>);</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;joining: &quot;</span>, strings.stream().collect(Collectors.joining()), <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;joining: &quot;</span>, strings.stream().collect(Collectors.joining(<span class="string">&quot;,&quot;</span>)), <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;joining: &quot;</span>, strings.stream().filter(string -&gt; !string.isEmpty()).collect(Collectors.joining(<span class="string">&quot;,&quot;</span>, <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>)), <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// maxBy：根据比较器选择最大值</span></span><br><span class="line">        <span class="type">Optional</span> <span class="variable">max</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.maxBy(Comparator.comparingDouble(Employee::getSalary)));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;maxBy: &quot;</span>, max.get(), <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// minBy：根据比较器选择最小值</span></span><br><span class="line">        <span class="type">Optional</span> <span class="variable">min</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.minBy(Comparator.comparingDouble(Employee::getSalary)));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;minBy: &quot;</span>, min.get(), <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// collectingAndThen：包裹另一个收集器, 对其结果转换函数</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">how</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.collectingAndThen(Collectors.toList(), List::size));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;collectingAndThen: &quot;</span>, how, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// groupingBy：返回Collector，根据某属性对流分组，Key是属性，Value是收集器收集的结果(类型由收集结果决定)</span></span><br><span class="line">        Map&lt;Employee.Stauts, List&lt;Employee&gt;&gt; map1 = listEmployees.stream().collect(Collectors.groupingBy(Employee::getStauts));</span><br><span class="line">        Map&lt;Employee.Stauts, Set&lt;Employee&gt;&gt; map2 = listEmployees.stream().collect(Collectors.groupingBy(Employee::getStauts, Collectors.toSet()));</span><br><span class="line">        TreeMap&lt;Employee.Stauts, String&gt; map3 = listEmployees.stream().collect(Collectors.groupingBy(Employee::getStauts, TreeMap::<span class="keyword">new</span>, Collectors.mapping(Employee::getName, Collectors.joining(<span class="string">&quot;,&quot;</span>))));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;groupingBy: &quot;</span>, map1, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;groupingBy: &quot;</span>, map2, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;groupingBy: &quot;</span>, map3, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// groupingByConcurrent：返回并发的Collector，根据某属性对流分组，Key是属性，Value是收集器收集的结果(类型由收集结果决定)</span></span><br><span class="line">        ConcurrentMap&lt;Employee.Stauts, String&gt; concurrentMap = listEmployees.parallelStream().collect(Collectors.groupingByConcurrent(Employee::getStauts, ConcurrentHashMap::<span class="keyword">new</span>, Collectors.mapping(Employee::getName, Collectors.joining(<span class="string">&quot;,&quot;</span>))));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;groupingByConcurrent: &quot;</span>, concurrentMap, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// partitioningBy：根据true或false进行分区</span></span><br><span class="line">        Map&lt;Boolean, List&lt;Employee&gt;&gt; vd = listEmployees.stream().collect(Collectors.partitioningBy(t -&gt; t.getAge() &gt; <span class="number">50</span>));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;partitioningBy: &quot;</span>, vd, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// mapping：返回收集器，收集之前先对每个输入元素应用映射功能，以下两种写法等价</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">nameStr1</span> <span class="operator">=</span> listEmployees.stream().collect(Collectors.mapping(Employee::getName, Collectors.joining(<span class="string">&quot;,&quot;</span>, <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>)));</span><br><span class="line">        <span class="type">String</span> <span class="variable">nameStr2</span> <span class="operator">=</span> listEmployees.stream().map(Employee::getName).collect(Collectors.joining(<span class="string">&quot;,&quot;</span>, <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;mapping和map: &quot;</span>, nameStr1, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;mapping和map: &quot;</span>, nameStr2, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// toMap：返回收集器，将元素收集到Map中，其key和value是两个映射函数作用于输入元素的结果。如果key已存在会抛异常，具体异常请查看源码。存放元素的Map默认是HashMap</span></span><br><span class="line">        Map&lt;String, Integer&gt; nameAgeMap = listEmployees.stream().collect(Collectors.toMap(e -&gt; e.getName(), e -&gt; e.getAge()));</span><br><span class="line"><span class="comment">//        Map&lt;String, Employee&gt; m = listEmployees.stream().collect(Collectors.toMap(e -&gt; e.getAge() &lt; 40 ? &quot;young&quot; : &quot;old&quot;, e -&gt; e)); // 重复key异常</span></span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;toMap: &quot;</span>, nameAgeMap, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">// toMap：返回收集器，将元素收集到Map中，其key和value是两个映射函数作用于输入元素的结果。如果key已存在，则更新value。存放元素的Map默认是HashMap</span></span><br><span class="line">        Map&lt;String, Employee&gt; strObjMap1 = listEmployees.stream().collect(Collectors.toMap(e -&gt; e.getAge() &lt; <span class="number">40</span> ? <span class="string">&quot;young&quot;</span> : <span class="string">&quot;old&quot;</span>, e -&gt; e, (e1, e2) -&gt; e2));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;toMap: &quot;</span>, strObjMap1, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">// toMap：返回收集器，将元素收集到Map中，其key和value是两个映射函数作用于输入元素的结果。如果key已存在，则更新value。指定存放元素的Map为TreeMap</span></span><br><span class="line">        TreeMap&lt;String, Employee&gt; strObjMap2 = listEmployees.stream().collect(Collectors.toMap(e -&gt; e.getAge() &lt; <span class="number">40</span> ? <span class="string">&quot;young&quot;</span> : <span class="string">&quot;old&quot;</span>, e -&gt; e, (e1, e2) -&gt; e2, TreeMap::<span class="keyword">new</span>));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;toMap: &quot;</span>, strObjMap2, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// toConcurrentMap：返回并发的Collector，将元素收集到ConcurrentMap中，其key和value是两个映射函数作用于输入元素的结果。如果key已存在，则更新value。指定存放元素的ConcurrentMap为ConcurrentHashMap</span></span><br><span class="line">        System.out.println(<span class="string">&quot;--------------- toConcurrentMap ---------------&quot;</span>);</span><br><span class="line">        ConcurrentMap&lt;String, Integer&gt; nameAgeConcurrentMap = listEmployees.parallelStream().collect(Collectors.toConcurrentMap(e -&gt; &#123;</span><br><span class="line">            <span class="comment">// 由于没有找到保存元素加入顺序的ConcurrentMap，这里将顺序打印，大家可以手动实现一个ConcurrentMap来保存顺序</span></span><br><span class="line">            System.out.println(e.getName());</span><br><span class="line">            <span class="keyword">return</span> e.getName();</span><br><span class="line">        &#125;, e -&gt; e.getAge(), (e1, e2) -&gt; e2, ConcurrentHashMap::<span class="keyword">new</span>));</span><br><span class="line">        System.out.printf(pattern, <span class="string">&quot;toConcurrentMap: &quot;</span>, nameAgeConcurrentMap, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;--------------- toConcurrentMap ---------------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">9079722457749166858L</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Double salary;</span><br><span class="line">    <span class="keyword">private</span> Stauts stauts;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Stauts</span> &#123;</span><br><span class="line">        WORKING,</span><br><span class="line">        SLEEPING,</span><br><span class="line">        VOCATION</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="collect"><a href="#collect" class="headerlink" title="collect"></a>collect</h4><p>在Stream接口中的定义如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将流转换为其他形式。接收一个收集器(Collector接口)的实现，用于给Stream中元素做规约操作</span></span><br><span class="line">&lt;R, A&gt; R <span class="title function_">collect</span><span class="params">(Collector&lt;? <span class="built_in">super</span> T, A, R&gt; collector)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以查看源码注释，并结合 Collectors.toList() 或 Collectors.toSet() 理解这三个对象</span></span><br><span class="line">&lt;R&gt; R <span class="title function_">collect</span><span class="params">(Supplier&lt;R&gt; supplier,</span></span><br><span class="line"><span class="params">              BiConsumer&lt;R, ? <span class="built_in">super</span> T&gt; accumulator,</span></span><br><span class="line"><span class="params">              BiConsumer&lt;R, R&gt; combiner)</span>;</span><br></pre></td></tr></table></figure>

<h5 id="参数为-Collector-对象实现"><a href="#参数为-Collector-对象实现" class="headerlink" title="参数为 Collector 对象实现"></a><font color="blue" size="3">参数为 Collector 对象实现</font></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; dataList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        dataList.add(<span class="string">&quot;john&quot;</span>);</span><br><span class="line">        dataList.add(<span class="string">&quot;kain&quot;</span>);</span><br><span class="line">        dataList.add(<span class="string">&quot;mike&quot;</span>);</span><br><span class="line">        dataList.add(<span class="string">&quot;milk&quot;</span>);</span><br><span class="line">        dataList.add(<span class="string">&quot;kav&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. 接口参数为 Collector 对象实现</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1.1 Supplier 对象负责创建容器对象，以便容纳 stream 中分隔后的数据，这里使用 List&lt;Integer&gt; 作为数据的容器对象</span></span><br><span class="line">        <span class="comment">// 1.2 accumulator 对象负责将 stream 中分隔后的数据放入 Supplier 创建的容器中</span></span><br><span class="line">        <span class="comment">// 1.3 combiner 对象负责将分隔的容器中的数据合并起来</span></span><br><span class="line">        <span class="comment">// 1.4 finisher 对象负责将最终返回的结果进行最终的处理</span></span><br><span class="line">        <span class="comment">// 1.5 characteristics 负责 Collector 执行效率的优化，具体要根据是否使用了 parallelStream 以及数据是否有顺序，不会影响最终的执行结果：</span></span><br><span class="line">        List&lt;String&gt; resultList = dataList.parallelStream().collect(<span class="keyword">new</span> <span class="title class_">Collector</span>&lt;String, List&lt;String&gt;, List&lt;String&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Supplier&lt;List&lt;String&gt;&gt; <span class="title function_">supplier</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> () -&gt; <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> BiConsumer&lt;List&lt;String&gt;, String&gt; <span class="title function_">accumulator</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> (list, data) -&gt; list.add(data.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase().concat(data.substring(<span class="number">1</span>)));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> BinaryOperator&lt;List&lt;String&gt;&gt; <span class="title function_">combiner</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> (list1, list2) -&gt; &#123;</span><br><span class="line">                    list1.addAll(list2);</span><br><span class="line">                    <span class="keyword">return</span> list1;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Function&lt;List&lt;String&gt;, List&lt;String&gt;&gt; <span class="title function_">finisher</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;--执行--finisher&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> list -&gt; list;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Characteristics枚举类：用于指示 Collector 属性的特性，可用于优化归约实现。</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Set&lt;Characteristics&gt; <span class="title function_">characteristics</span><span class="params">()</span> &#123;</span><br><span class="line">                Set&lt;Characteristics&gt; characteristicsSet = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 并行：如果使用 parallelStream，加上这个枚举。意味着Collector进行规约操作时，</span></span><br><span class="line">                <span class="comment">//              支持从多个线程收集结果，而无需等到所有线程全部空闲后按输入元素(上文dataList)的顺序收集。</span></span><br><span class="line">                <span class="comment">// 由 collect(Collector&lt;? super T, A, R&gt; collector) 方法的实现类可知：</span></span><br><span class="line">                <span class="comment">//              Characteristics.CONCURRENT &amp;&amp; Characteristics.UNORDERED，即二者同时设置才有效果。</span></span><br><span class="line">                characteristicsSet.add(Characteristics.CONCURRENT);</span><br><span class="line">                <span class="comment">// 无序：如果收集流中的数据不需要保留输入元素(上文dataList)的顺序，加上这个枚举.</span></span><br><span class="line">                characteristicsSet.add(Characteristics.UNORDERED);</span><br><span class="line">                <span class="comment">// 身份完成：此枚举可以省略。如果设置，则不会执行finisher()方法，但必须保证该方法返回值类型Function&lt;A, R&gt;进行从A到R的强制转换是成功的。</span></span><br><span class="line">                characteristicsSet.add(Characteristics.IDENTITY_FINISH);</span><br><span class="line">                <span class="keyword">return</span> characteristicsSet;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        resultList.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="参数为三个对象实现"><a href="#参数为三个对象实现" class="headerlink" title="参数为三个对象实现"></a><font color="blue" size="3">参数为三个对象实现</font></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; dataList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        dataList.add(<span class="string">&quot;john&quot;</span>);</span><br><span class="line">        dataList.add(<span class="string">&quot;kain&quot;</span>);</span><br><span class="line">        dataList.add(<span class="string">&quot;mike&quot;</span>);</span><br><span class="line">        dataList.add(<span class="string">&quot;milk&quot;</span>);</span><br><span class="line">        dataList.add(<span class="string">&quot;kav&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 接口参数为 Supplier， BiConsumer， BiConsumer 三个对象</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.1 Supplier 对象负责创建容器对象，以便容纳 stream 中分隔后的数据，这里使用 List&lt;Integer&gt; 作为数据的容器对象</span></span><br><span class="line">        <span class="comment">// 2.2 BiConsumer 对象负责将 stream 中分隔后的数据放入上一步创建的容器中</span></span><br><span class="line">        <span class="comment">// 2.3 BiConsumer 对象负责将分隔的容器中的数据合并起来</span></span><br><span class="line">        List&lt;String&gt; resultList2 = dataList.parallelStream().collect(</span><br><span class="line">                ArrayList::<span class="keyword">new</span>,</span><br><span class="line">                (list, data) -&gt; list.add(data.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase().concat(data.substring(<span class="number">1</span>))),</span><br><span class="line">                (list1, list2) -&gt; list1.addAll(list2));</span><br><span class="line"></span><br><span class="line">        resultList2.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="parallelStream线程安全问题"><a href="#parallelStream线程安全问题" class="headerlink" title="parallelStream线程安全问题"></a>parallelStream线程安全问题</h5><ul>
<li>其中上面的两个例子中都使用了 parallelStream，并且使用了 collect 方法</li>
<li>parallelStream 可以提高数据处理效率，具体是通过将流中的数据分隔成若干端后再并行处理最后将结果合并</li>
<li>如果不使用 collect 方法会发生什么情况，会不会出现线程安全问题？</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; list1 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        List&lt;Integer&gt; list2 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        List&lt;Integer&gt; list3 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 串行</span></span><br><span class="line">        IntStream.range(<span class="number">0</span>, <span class="number">10000</span>).forEach(list1::add);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 并行</span></span><br><span class="line">        IntStream.range(<span class="number">0</span>, <span class="number">10000</span>).parallel().forEach(list2::add);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 并行加锁</span></span><br><span class="line">        IntStream.range(<span class="number">0</span>, <span class="number">10000</span>).parallel().forEach(i -&gt; &#123;</span><br><span class="line">            lock.lock();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                list3.add(i);</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                lock.unlock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;串行执行的大小：%s&quot;</span>, list1.size()));</span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;有线程安全的并行问题大小：%s&quot;</span>, list2.size()));</span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;并行加锁：%s&quot;</span>, list1.size()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果如下，可见在 parallelStream 中会出现线程安全问题，虽然通过锁可以避免线程安全问题，但是会降低程序处理效率，从而影响系统的吞吐率。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">串行执行的大小：10000</span><br><span class="line">有线程安全的并行问题大小：8370</span><br><span class="line">并行加锁：10000</span><br></pre></td></tr></table></figure>

<p>正确的解决的方法就是通过 collect 方法和 Collector 接口，具体如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; list1 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// 串行</span></span><br><span class="line">        IntStream.range(<span class="number">0</span>, <span class="number">10000</span>).forEach(list1::add);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过 collect 接口解决并发问题</span></span><br><span class="line">        <span class="comment">// 1. Supplier 对象负责创建容器对象，以便容纳 stream 中分隔后的数据，这里使用 List&lt;Integer&gt; 作为数据的容器对象</span></span><br><span class="line">        <span class="comment">// 2. ObjIntConsumer 对象负责将 stream 中分隔后的数据放入上一步创建的容器中</span></span><br><span class="line">        <span class="comment">// 3. BiConsumer 对象负责将分隔的容器中的数据合并起来</span></span><br><span class="line">        List&lt;Integer&gt; dataList = IntStream.range(<span class="number">0</span>, <span class="number">10000</span>).parallel().collect(<span class="keyword">new</span> <span class="title class_">Supplier</span>&lt;List&lt;Integer&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;new Supplier&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="keyword">new</span> <span class="title class_">ObjIntConsumer</span>&lt;List&lt;Integer&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(List&lt;Integer&gt; dataList, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">                dataList.add(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="keyword">new</span> <span class="title class_">BiConsumer</span>&lt;List&lt;Integer&gt;, List&lt;Integer&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(List&lt;Integer&gt; dataList1, List&lt;Integer&gt; dataList2)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;merge result&quot;</span>);</span><br><span class="line">                dataList1.addAll(dataList2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        List&lt;Integer&gt; dataList1 = IntStream.range(<span class="number">0</span>, <span class="number">10000</span>).collect(ArrayList::<span class="keyword">new</span>, (list, i) -&gt; list.add(i), (lista, listb) -&gt; lista.addAll(listb));</span><br><span class="line">        List&lt;Integer&gt; dataList2 = IntStream.range(<span class="number">0</span>, <span class="number">10000</span>).parallel().collect(ArrayList::<span class="keyword">new</span>, (list, i) -&gt; list.add(i), (lista, listb) -&gt; lista.addAll(listb));</span><br><span class="line"></span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;串行执行的大小：%s&quot;</span>, list1.size()));</span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;线程安全的并行大小：%s&quot;</span>, dataList.size()));</span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;线程安全的并行大小：%s&quot;</span>, dataList1.size()));</span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;线程安全的并行大小：%s&quot;</span>, dataList2.size()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Java8Tester</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;使用 Java 7: &quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; strings = Arrays.asList(<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;bc&quot;</span>, <span class="string">&quot;efg&quot;</span>, <span class="string">&quot;abcd&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;jkl&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;列表: &quot;</span> + strings);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 空字符串数量</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> getCountEmptyStringUsingJava7(strings);</span><br><span class="line">        System.out.println(<span class="string">&quot;空字符串数量为: &quot;</span> + count);</span><br><span class="line">        count = strings.stream().filter(string -&gt; string.isEmpty()).count();</span><br><span class="line">        System.out.println(<span class="string">&quot;空字符串数量为: &quot;</span> + count);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 字符串长度为 3 的数量</span></span><br><span class="line">        count = getCountLength3UsingJava7(strings);</span><br><span class="line">        System.out.println(<span class="string">&quot;字符串长度为 3 的数量为: &quot;</span> + count);</span><br><span class="line">        count = strings.stream().filter(string -&gt; string.length() == <span class="number">3</span>).count();</span><br><span class="line">        System.out.println(<span class="string">&quot;字符串长度为 3 的数量为: &quot;</span> + count);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 删除空字符串</span></span><br><span class="line">        List&lt;String&gt; filtered = deleteEmptyStringsUsingJava7(strings);</span><br><span class="line">        System.out.println(<span class="string">&quot;筛选后的列表: &quot;</span> + filtered);</span><br><span class="line">        filtered = strings.stream().filter(string -&gt; !string.isEmpty()).collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;筛选后的列表: &quot;</span> + filtered);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 删除空字符串，并用逗号合并</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">mergedString</span> <span class="operator">=</span> getMergedStringUsingJava7(strings, <span class="string">&quot;, &quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;合并字符串: &quot;</span> + mergedString);</span><br><span class="line">        mergedString = strings.stream().filter(string -&gt; !string.isEmpty()).collect(Collectors.joining(<span class="string">&quot;, &quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;合并字符串: &quot;</span> + mergedString);</span><br><span class="line"></span><br><span class="line">        List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;列表: &quot;</span> + numbers);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取列表元素平方数</span></span><br><span class="line">        List&lt;Integer&gt; squaresList = getSquaresUsingJava7(numbers);</span><br><span class="line">        System.out.println(<span class="string">&quot;Squares List: &quot;</span> + squaresList);</span><br><span class="line">        squaresList = numbers.stream().map(i -&gt; i * i).distinct().collect(Collectors.toList());</span><br><span class="line">        System.out.println(<span class="string">&quot;Squares List: &quot;</span> + squaresList);</span><br><span class="line"></span><br><span class="line">        List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">17</span>, <span class="number">8</span>, <span class="number">19</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;列表: &quot;</span> + integers);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;列表中最大的数 : &quot;</span> + getMaxUsingJava7(integers));</span><br><span class="line">        System.out.println(<span class="string">&quot;列表中最小的数 : &quot;</span> + getMinUsingJava7(integers));</span><br><span class="line">        System.out.println(<span class="string">&quot;所有数之和 : &quot;</span> + getSumUsingJava7(integers));</span><br><span class="line">        System.out.println(<span class="string">&quot;平均数 : &quot;</span> + getAverageUsingJava7(integers));</span><br><span class="line"></span><br><span class="line">        <span class="type">IntSummaryStatistics</span> <span class="variable">stats</span> <span class="operator">=</span> integers.stream().mapToInt((x) -&gt; x).summaryStatistics();</span><br><span class="line">        System.out.println(<span class="string">&quot;列表中最大的数 : &quot;</span> + stats.getMax());</span><br><span class="line">        System.out.println(<span class="string">&quot;列表中最小的数 : &quot;</span> + stats.getMin());</span><br><span class="line">        System.out.println(<span class="string">&quot;所有数之和 : &quot;</span> + stats.getSum());</span><br><span class="line">        System.out.println(<span class="string">&quot;平均数 : &quot;</span> + stats.getAverage());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;随机数: &quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 输出10个随机数</span></span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            System.out.println(random.nextInt());</span><br><span class="line">        &#125;</span><br><span class="line">        random.ints().limit(<span class="number">10</span>).sorted().forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 并行处理</span></span><br><span class="line">        count = strings.parallelStream().filter(string -&gt; string.isEmpty()).count();</span><br><span class="line">        System.out.println(<span class="string">&quot;空字符串的数量为: &quot;</span> + count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getCountEmptyStringUsingJava7</span><span class="params">(List&lt;String&gt; strings)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (string.isEmpty()) &#123;</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getCountLength3UsingJava7</span><span class="params">(List&lt;String&gt; strings)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (string.length() == <span class="number">3</span>) &#123;</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">deleteEmptyStringsUsingJava7</span><span class="params">(List&lt;String&gt; strings)</span> &#123;</span><br><span class="line">        List&lt;String&gt; filteredList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!string.isEmpty()) &#123;</span><br><span class="line">                filteredList.add(string);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> filteredList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getMergedStringUsingJava7</span><span class="params">(List&lt;String&gt; strings, String separator)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!string.isEmpty()) &#123;</span><br><span class="line">                stringBuilder.append(string);</span><br><span class="line">                stringBuilder.append(separator);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">mergedString</span> <span class="operator">=</span> stringBuilder.toString();</span><br><span class="line">        <span class="keyword">return</span> mergedString.substring(<span class="number">0</span>, mergedString.length() - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">getSquaresUsingJava7</span><span class="params">(List&lt;Integer&gt; numbers)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; squaresList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Integer number : numbers) &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">square</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(number.intValue() * number.intValue());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!squaresList.contains(square)) &#123;</span><br><span class="line">                squaresList.add(square);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> squaresList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getMaxUsingJava7</span><span class="params">(List&lt;Integer&gt; numbers)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> numbers.get(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; numbers.size(); i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">Integer</span> <span class="variable">number</span> <span class="operator">=</span> numbers.get(i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (number.intValue() &gt; max) &#123;</span><br><span class="line">                max = number.intValue();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getMinUsingJava7</span><span class="params">(List&lt;Integer&gt; numbers)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> numbers.get(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; numbers.size(); i++) &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">number</span> <span class="operator">=</span> numbers.get(i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (number.intValue() &lt; min) &#123;</span><br><span class="line">                min = number.intValue();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getSumUsingJava7</span><span class="params">(List numbers)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> (<span class="type">int</span>) (numbers.get(<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; numbers.size(); i++) &#123;</span><br><span class="line">            sum += (<span class="type">int</span>) numbers.get(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getAverageUsingJava7</span><span class="params">(List&lt;Integer&gt; numbers)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getSumUsingJava7(numbers) / numbers.size();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h1><p> <a target="_blank" rel="noopener" href="https://www.runoob.com/java/java8-base64.html">Java8 Base64 - 菜鸟</a> </p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="zhaolq 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="zhaolq 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/JDK/" rel="tag"># JDK</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/article/2018/08/Java7%E6%96%B0%E7%89%B9%E6%80%A7/" rel="prev" title="Java7新特性">
                  <i class="fa fa-angle-left"></i> Java7新特性
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/article/2018/08/Java8%E6%96%B0%E7%89%B9%E6%80%A7-%E9%87%8D%E5%A4%8D%E6%B3%A8%E8%A7%A3%E4%B8%8E%E7%B1%BB%E5%9E%8B%E6%B3%A8%E8%A7%A3/" rel="next" title="Java8新特性-重复注解与类型注解">
                  Java8新特性-重复注解与类型注解 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">zhaolq</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
